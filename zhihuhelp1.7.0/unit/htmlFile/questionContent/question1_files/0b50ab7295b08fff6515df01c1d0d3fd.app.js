(function(a){with(a){
a.Qr=function(b,c){this.aa=b;this.offset=c},a.Rr=function(b){return b.length||b.childNodes.length},a.Sr=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Rr(b):(b=e,c=0)):(b=b.lastChild,c=Rr(b))}return new Qr(b,c)},a.Tr=function(b,c){b!=l&&this.append.apply(this,arguments)};t=Tr.prototype;t.Ah="";t.set=function(b){this.Ah=""+b};t.append=function(b,c,d){this.Ah+=b;if(c!=l)for(var e=1;e<arguments.length;e++)this.Ah+=arguments[e];return this};
t.clear=function(){this.Ah=""};t.vr=u(49);t.toString=p("Ah");a.Ur=function(b){this.type="anon_change";this.jb=b};A(Ur,gd);a.Vr=function(b){if("outerHTML"in b)return b.outerHTML;var c=Rb(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML},a.Z=function(b,c){return ea[b]=c};Pf.prototype.expand=Z(63,function(b,c,d,e){qa(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});
Kj.prototype.expand=Z(62,function(){this.Na(j)});Sh.prototype.rm=Z(61,function(b){Th(this);this.Ok=b});Ai.prototype.rm=Z(60,function(b){this.Ok=b;this.ya&&Bi(this)});rj.prototype.sm=Z(56,function(b){this.Aa(b)});Yd.prototype.oi=Z(55,da("PF"));Sh.prototype.Kx=Z(54,function(){return this.Dj||150>Aa()-this.Sx});Bn.prototype.Cb=Z(53,function(){var b=this.rc();return 1==b.nodeType?b:b.parentNode});yh.prototype.Kf=Z(52,da("xi"));Uj.prototype.Kf=Z(51,da("xi"));jp.prototype.He=Z(50,function(b){this.Y.Ct(b)});
Tr.prototype.vr=Z(49,function(){return this.Ah.length});Nn.prototype.Ec=Z(34,function(){return this.O.toString()});Sn.prototype.Ec=Z(33,function(){return this.O.text});bo.prototype.Ec=Z(32,function(){return go(this).Ec()});jo.prototype.Ec=Z(31,s(""));po.prototype.Ec=Z(30,function(){return B.map(Dn(this),function(b){return b.Ec()}).join("")});zq.prototype.Ec=Z(29,function(){return Fc(this.h())});
Qb.prototype.xv=Z(24,function(b,c,d){for(var e=this.Ha,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});Xh.prototype.fp=Z(21,da("Zj"));rj.prototype.fp=Z(20,da("Zj"));yh.prototype.zz=Z(19,function(b){this.ix=Math.pow(b,2)});
hf.prototype.bq=Z(16,function(b,c,d){var e=Aa(),g=d?d:e,h=this.nl.Eg.length?this.nl.Eg.pop():this.nl.Zk();h.jr=2;h.ir=g;h.type=c;h.fC=b;b=(b=this.jX)&&b.isTracing()?b.totalVarAlloc:-1;h.XH=b;this.rv++;if(d){d=this.Mf.length;for(b=0;b<d;b++)if(this.Mf[b].ir>g){B.$n(this.Mf,h,b);break}b==d&&this.Mf.push(h)}else this.Mf.push(h);if(g=h.type)h=this.mk.get(g),h||(h=this.sp.Eg.length?this.sp.Eg.pop():this.sp.Zk(),h.type=g,this.mk.set(g,h)),h.count++;this.au+=Aa()-e});
$d.prototype.config=Z(15,function(b,c){this.log(fe,b,c)});Sh.prototype.Et=Z(14,function(b,c){this.Bm=b;this.Hl=c});Uh.prototype.Et=Z(13,function(b,c,d,e){this.Xj=b;this.Wj=c;this.Qk=d;this.Pk=e});Vm.prototype.zw=Z(12,function(){return Ym});tp.prototype.tr=Z(0,p("Ja"));
a.Wr=function(b,c){b.ey=c==l||c instanceof Pf?c:new Pf(c,i,i,i);b.P()&&b.X()},a.Xr=function(b){return b.Od?b.Ja:b.Ja.h()},a.Yr=function(b){b.Hx=j;b.vC=vg(b.h()).height;Zo+=b.vC;B.forEach(Xo,function(b){b&&(!b.Hx&&b.sl)&&b.So()})},a.Zr=function(b,c){var d=b.parentNode,e=B.indexOf(d.childNodes,b)+(c?0:1),d=Sr(d,e,c);C&&(G("9")&&1==d.aa.nodeType&&"HR"==d.aa.tagName)&&(e=d.aa,d.aa=e.parentNode,d.offset=B.indexOf(d.aa.childNodes,e)+(c?0:1));wo(d.aa,d.offset).select()},a.$r=function(b,c){return b.Bd.get(c)},
a.as=function(b,c){if(Al(b))b.selectionStart=c,b.selectionEnd=c;else if(C){var c=Dl(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},a.bs=function(b){var c={};B.forEach(b.data.Db(),function(b){c[b]=this.data.get(b)},b);return c},a.cs=function(b){b.Fb()&&b.fire()},a.ds=function(b,c,d){var e=Ni,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",
content:"你对该问题的回答、赞同和关注行为将以实名显示。"};Ei(b?g:h,function(g){if(g){var h=new W(j),q="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||gh.ia);h.on("success",function(){var c=Je(h);c&&!c.r&&e.dispatchEvent(new Ur(b))});h.ajax(q,r)}c&&c(g)})},a.es=function(b,c){return b.Tb&&c?B.indexOf(b.Tb,c):-1},a.fs=function(b){return b!=l},a.gs=function(b){return!/[^\t\n\r ]/.test(b)},a.hs=function(b,c,d){this.VF=b;this.WR=!!d;b&&!c&&this.next()};A(hs,Nd);
hs.prototype.next=function(){var b=this.VF;b||f(Q.$a);this.VF=this.WR?b.previousSibling:b.nextSibling;return b};a.is=function(b){return 1==b.nodeType||3==b.nodeType&&!gs(b.nodeValue)},a.js=function(b){try{return b.next()}catch(c){return l}},a.ks=function(b,c,d){ka(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);hs.call(this,b.childNodes[d],j,c)};A(ks,hs);
a.ls=function(b){return 1==b.length?"0"+b:b},a.ms=/^#(?:[0-9a-f]{3}){1,2}$/i,a.ns=function(b,c,d,e,g,h,k,n,q){gd.call(this,b);this.XW=c;this.event=d;this.TW=e;this.YW=g;this.cr=h;this.ZW=k;this.tX=n;this.uX=q};A(ns,gd);
a.os=function(b,c){return b>c},a.ps=function(b,c){return b<c},a.qs=function(b){return b.left||0},a.rs=function(b){return b.left+b.width-1},a.ss=function(b){return b.top+b.height-1},a.ts=function(b,c){var d=b.gl;return Math.abs(c.y-(d.top+(d.height-1)/2))},a.us=function(b,c){var d=$.extend({all:m},us.defaults,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?m:j};us.defaults={paddingTop:0};
a.vs=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.ws=/#(.)(.)(.)/,a.xs=function(b,c,d){var e=eg(b);c instanceof Lb&&(d=c.y,c=c.x);ag(b,b.offsetLeft+(c-e.x),b.offsetTop+(d-e.y))},a.ys=function(b){var c=b.body,b=b.documentElement;return new Lb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.zs=function(b,c){this.Gh=b instanceof Lb?b:new Lb(b,c)};A(zs,uq);
zs.prototype.X=function(b,c,d,e){var g=ys(Rb(b)),h=this.Gh.x+g.x,g=this.Gh.y+g.y,k=fm(b),h=h-k.x,g=g-k.y;gm(new Lb(h,g),b,c,d,l,l,e)};a.As=function(b){for(var c;c=!b||1!=b.nodeType?l:js(Q.filter(new ks(b,m),is));)b=c;return b},a.Bs=function(b,c,d){sn.call(this,b,0,d?"添加父话题":"添加子话题");this.Lx=d;this.vf=c;this.as="";this.$G="/topic/parent/remove";this.rW=j};A(Bs,sn);t=Bs.prototype;t.o=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))Bs.n.o.call(this,b),this.De(j),S(this.mD,m)};
t.Lg=function(b){var c;this.Lx&&(c="/topic/autocomplete?no_create=true");Bs.n.Lg.call(this,b,c);this.T.Ee.jD=m};t.lm=function(){return y(function(b,c){return B.filter(b,function(b){return 3>=b.length?m:B.every(this.data,function(e){return e[1]===b[2]?c===b[1]?(b[0]="plain_text",b[1]='"'+c+'"已在现有列表中',j):m:j})},this)},this)};
t.Pe=function(b,c){this.Rg||(this.Rg=j,this.xhr=new W(j),oe(this.m(),this.xhr,"complete",this.Iu),b||(b=-1),this.Lx?this.xhr.ajax("/topic/add","tid="+this.vf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.vf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.vD=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.Lo=function(b){if(!this.ka||!this.ka.Fb()){var c=new W(j);this.m().e(c,"success",function(){var d=Je(c);d.r?V(d.msg):(un(this),this.Ie(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.Lx?c.ajax(this.$G,"cid="+this.vf+"&pid="+b):c.ajax(this.$G,"pid="+this.vf+"&cid="+b);this.ka=c}};a.Cs=function(){O.call(this);this.Sc=[];this.hl=[];this.Qv={};this.M=new me(this);this.xO=this.WE=m;this.wA=j};A(Cs,Gd);t=Cs.prototype;t.vE=0;t.zz=da("vE");a.Ds=function(b,c,d){c.TC=d;c.Wi=i;b.Sc.push(c)};
t.init=function(){if(!this.WE){for(var b=0,c=this.Sc.length;b<c;b++)for(var d=oc(this.Sc[b]),e=0,g=d.length;e<g;++e){var h=d[e],k=h,n=ua(k);this.Qv[n]=h;this.WC&&(this.M.e(h,"mouseover",this.KM),this.M.e(h,"mouseout",this.JM));this.VC&&(this.M.e(k,"mouseover",this.IM),this.M.e(k,"mouseout",this.HM));this.hl.push(h);this.M.e(k,["mousedown","touchstart"],this.nN)}this.WE=j}};
t.w=function(){this.M.F();for(var b=0,c=this.Sc.length;b<c;b++){var d=this.Sc[b];d.TC=i;d.Wi=i}this.Sc.length=0;this.hl.length=0;this.Qv=l;Es(this);Cs.n.w.call(this)};a.Fs=function(b,c){for(var d=0,e=b.Sc.length;d<e;d++){var g=b.Sc[d];g.gl=pg(g)}d=0;for(e=b.hl.length;d<e;d++)g=b.hl[d],g!=c&&(g.gl=pg(g))};
t.nN=function(b){var c=ua(b.currentTarget);this.va=this.Qv[c];a:{var c=this.va,d=c.cloneNode(j);switch(c.tagName.toLowerCase()){case "tr":c=M("table",l,M("tbody",l,d));break a;case "td":case "th":c=M("table",l,M("tbody",l,M("tr",l,d)));break a;default:c=d}}this.zb=c;this.dr&&H.add(this.zb,this.dr);this.zb.style.margin="0";this.zb.style.position="absolute";this.zb.style.visibility="hidden";Rb(this.va).body.appendChild(this.zb);c=eg(this.va);xs(this.zb,c);this.Ab=new yh(this.zb);this.Ab.zz(this.vE);
P(this.Ab,"start",this.Tw,m,this);P(this.Ab,"end",this.FM,m,this);P(this.Ab,"earlycancel",this.lv,m,this);this.Ab.Em(b)};
t.Tw=function(b){if(this.dispatchEvent(new ns("beforedragstart",this,b.PB,this.va,l,l))){this.Us=this.va.parentNode;this.tC=this.Ly=this.va.nextElementSibling!=i?this.va.nextElementSibling:pc(this.va.nextSibling,j);this.Cv=this.Us;this.Bv?H.add.apply(l,B.concat(this.va,this.Bv)):this.va.style.visibility="hidden";var c=og(this.zb);this.zb.pM=c.width/2;this.zb.oM=c.height/2;this.zb.style.visibility="";this.wA&&(this.va.style.display="none");Fs(this,this.va);this.va.style.display="";P(this.Ab,"drag",
this.LM,m,this);this.dispatchEvent(new ns("dragstart",this,b.PB,this.va,this.zb,this.Ab))}else b.preventDefault(),this.lv()};
t.LM=function(b){var c=eg(this.zb),c=new Lb(c.x+this.zb.pM,c.y+this.zb.oM),d;a:{d=l;if("none"!=this.va.style.display){d=this.va.parentNode;var e=pg(d);if(Gs(c,e))break a}for(var e=0,g=this.Sc.length;e<g;e++){var h=this.Sc[e];if(h!=d&&Gs(c,h.gl)){d=h;break a}}d=l}var k;if(d){d==l&&f(Error("getHoverNextItem_ called with null hoverList."));var n,q,e=m,g=i;switch(d.TC){case 0:k=c.y;n=ss;q=ps;break;case 4:e=j;case 2:k=c.x;n=rs;q=ps;break;case 5:e=j;case 3:k=c.x,n=qs,q=os}for(var h=l,r,v=oc(d),x=0,F=v.length;x<
F;x++){var I=v[x];if(I!=this.va){var R=n(I.gl);if(e){var aa=ts(I,c);ka(g)||(g=aa);if(q(k,R)&&(r==i||aa<g||aa==g&&(q(R,r)||R==r)))h=I,r=R;aa<g&&(g=aa)}else if(q(k,R)&&(r==i||q(R,r)))h=I,r=R}}k=h!==l&&ts(h,c)>g?l:h}else k=l;if(!this.dispatchEvent(new ns("beforedragmove",this,b,this.va,this.zb,this.Ab,c,d,k)))return m;if(d)this.wA?(this.va.parentNode!=d||(this.va.nextElementSibling!=i?this.va.nextElementSibling:pc(this.va.nextSibling,j))!=k)&&d.insertBefore(this.va,k):k&&(this.tC=k),this.va.style.display=
"",d.Wi&&H.add(d,d.Wi);else{this.xO||(this.va.style.display="none");n=0;for(q=this.Sc.length;n<q;n++)r=this.Sc[n],r.Wi&&H.remove(r,r.Wi)}d!=this.Cv&&(this.Cv=d,Fs(this,this.va));this.dispatchEvent(new ns("dragmove",this,b,this.va,this.zb,this.Ab,c,d,k));return m};t.lv=function(){Es(this);this.Ab=this.zb=this.Ly=this.Us=this.Cv=this.va=l;for(var b=0,c=this.Sc.length;b<c;b++)this.Sc[b].gl=l;b=0;for(c=this.hl.length;b<c;b++)this.hl[b].gl=l};
t.FM=function(b){if(!this.dispatchEvent(new ns("beforedragend",this,b,this.va,this.zb,this.Ab)))return m;this.wA||this.Us.insertBefore(this.va,this.tC);Es(this);this.dispatchEvent(new ns("dragend",this,b,this.va,this.zb,this.Ab));this.lv();return j};
a.Es=function(b){Tc(b.Ab);b.zb&&N(b.zb);b.va&&"none"==b.va.style.display&&(b.Us.insertBefore(b.va,b.Ly),b.va.style.display="");b.Bv&&b.va?H.remove.apply(l,B.concat(b.va,b.Bv)):b.va&&(b.va.style.visibility="visible");for(var c=0,d=b.Sc.length;c<d;c++){var e=b.Sc[c];e.Wi&&H.remove(e,e.Wi)}};t.KM=function(b){H.add.apply(l,B.concat(b.currentTarget,this.WC))};t.JM=function(b){H.remove.apply(l,B.concat(b.currentTarget,this.WC))};t.IM=function(b){H.add.apply(l,B.concat(b.currentTarget,this.VC))};
t.HM=function(b){H.remove.apply(l,B.concat(b.currentTarget,this.VC))};
a.Gs=function(b,c){return b.x>c.left&&b.x<c.left+c.width&&b.y>c.top&&b.y<c.top+c.height},a.Hs=function(b,c){if(b){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({tI:us},gl,c||{});if(!d.tI(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.xB?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}}},a.Is=function(b,c){c.all=j;return us(b,c)},a.Js=function(b,c,d,e){var g=l;e&&(d&&(d=$.proxy(d,e)),g&&(g=$.proxy(g,e)));$.get("/node/"+b,{params:c},
function(b){b&&b.r?g&&g(b):d&&d(b)})},a.Ks=function(b){var c=b.match(vs);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.Ls=function(b){ms.test(b)||f(Error("'"+b+"' is not a valid hex color"));4==b.length&&(b=b.replace(ws,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.Ms={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",
blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",
darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",
ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",
magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",
palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},a.Ns=/[^\d]+$/,a.Os=function(b,c){zs.call(this,b,c)};A(Os,zs);Os.prototype.oo=0;Os.prototype.um=da("oo");
Os.prototype.X=function(b,c,d,e){var g=bg(b),g=gg(g),h;h=Sb(b);h=Zb(h.Ha);h=new Lb(this.Gh.x+h.scrollLeft,this.Gh.y+h.scrollTop);var k=c,n=gm(h,b,k,d,g,10,e);if(0!=(n&496)){if(n&16||n&32)k^=2;if(n&64||n&128)k^=1;n=gm(h,b,k,d,g,10,e);0!=(n&496)&&gm(h,b,c,d,g,this.oo,e)}};a.Ps=function(b,c,d,e){vq.call(this,b,c);this.oo=d?5:0;this.Oy=e||i};A(Ps,vq);Ps.prototype.In=p("oo");Ps.prototype.um=da("oo");
Ps.prototype.X=function(b,c,d,e){var g=hm(this.element,this.Ff,b,c,l,d,10,e,this.Oy);if(g&496){var h=Qs(g,this.Ff),c=Qs(g,c),g=hm(this.element,h,b,c,l,d,10,e,this.Oy);g&496&&(h=Qs(g,h),c=Qs(g,c),hm(this.element,h,b,c,l,d,this.In(),e,this.Oy))}};
a.Qs=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.Rs=function(b){wo(As(b),0).select()},a.Ss=function(b,c){var d=Gc(b);if(b.getElementsByTagName)for(var e in Vo)if(b.tagName==e||0<b.getElementsByTagName(e).length)return m;return!c&&" "==d||gs(d)},a.Ts=j,a.Us=function(b){if(b=Cn(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Vs=function(b){sn.call(this);this.wC=l;this.ze="例如：互联网、医学、法律、数学...";this.data=b||[]};A(Vs,sn);t=Vs.prototype;
t.o=function(b){this.g=b;this.ig=L("zm-tag-editor-labels",this.g);this.De(j);this.me();this.pb();this.Nf=K("zh-expert-topics");this.Pm=K("zh-active-topics");if(this.Nf)$(this.Nf).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(lc(this.Pm,d[0],0),Qk(d[0])):N(d[0]);B.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Ws(this);this.dispatchEvent("remove")},this));if(this.Pm)$(this.Pm).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");lc(this.Nf,b[0],0);Qk(b[0]);Ws(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.jm()};t.An=function(){this.Tc||(this.Tc=M("div","zm-tag-editor-editor",[this.Ye=M("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=K("profile-expert-edit-input")])]),this.ze&&(this.Qx=new gn(this.ze),this.Qx.o(this.fb),this.fb.title=this.ze),kc(this.Tc,this.ig),this.Lg(this.Ye))};
t.Lg=function(b){this.T=new qn("/topic/autocomplete",this.fb,l,l,b,j);this.T.jh(j);this.T.Rl=this.Vd;this.T.gp(this.lm());this.T.bw=[this.ze];this.m().e(this.T,"select",this.Co);this.m().e(this.T,ul.wh.Fi,this.Hu);this.m().e(this.T,ul.wh.Fi,this.Eu);this.m().e(this.T,ul.wh.TI,function(){$(this.T.K.g).hide()})};t.Eu=function(){if(0===this.T.Ya.length){var b=M("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.fb).val()+" 的话题");$(this.T.K.g).html(b).show()}};
t.Co=function(){var b=this.T.gj().slice(1);b&&3<b.length&&(this.AC=b,this.Pe(b))};t.Pe=function(b){this.data.push(b[1]);var c=$(this.Nf).find("[data-url-token='"+b[1]+"']")[0];c?Qk(c):(Js("TopicMediumV2",{member_url_token:T[1],topic_url_token:b[1]},this.Oq,this),$(this.Pm).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.Oq=function(b){b=$(b)[0];lc(this.Nf,b,0);Qk(b);Ws(this)};t.Ie=ca();
t.jm=function(){if(!eh.tc){var b=this;this.Jf&&this.Jf.F();var c=new Cs;c.dr="expert-item-moving";Ds(c,this.Nf,4);c.init();this.Jf=c;this.m().e(this.Jf,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.Nf).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})});this.m().e(this.Jf,"beforedragstart",function(){return L("editing",this.Nf)?m:j})}};
a.Ws=function(b){var c=$(b.Nf).children().length;6<c&&N($(b.Nf).children()[6]);S(K("zh-profile-expert-empty"),0>=c);0<c&&S(K("zh-profile-expert-warning"),m);S(K("active-topics-wrap"),$(b.Pm).children().length);b.jm()};t.lm=function(){return y(function(b){return B.filter(b,function(b){return B.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Xs=function(b){sn.call(this,b,0);this.as="";this.MB="/topic/ignore"};A(Xs,Bs);
Xs.prototype.Pe=function(b){this.Rg||(this.Rg=j,this.xhr=new W(j),oe(this.m(),this.xhr,"complete",this.Iu),this.xhr.ajax(this.MB,"tid="+b+"&method=add"))};Xs.prototype.Lo=function(b){this.Rg||(this.Rg=j,this.xhr=new W(j),this.m().e(this.xhr,"complete",function(){un(this);this.Ie();this.Rg=m}),this.xhr.ajax(this.MB,"tid="+b+"&method=del"))};a.Ys=function(){sn.call(this,l,l,"搜索话题");this.wC=l;this.ze="";this.data=[jh[0]]};A(Ys,sn);t=Ys.prototype;
t.o=function(b){this.g=b;this.ig=L("zm-tag-editor-labels",this.g);this.De(j);this.me();this.pb()};t.An=function(){this.Tc||(this.Tc=M("div","zm-tag-editor-editor",[this.xn=M("div","zg-section zg-clear"),this.Ye=M("div","zg-section zm-tag-editor-command-buttons-wrap",[this.fb=K("zh-topic-merge-input"),M("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.mD=K("zh-topic-merge-btn")])]),kc(this.Tc,this.ig),this.Lg(this.Ye))};
t.Lg=function(b){this.T=new qn("/topic/autocomplete",this.fb,l,l,b,j);this.T.jh(j);this.T.Rl=this.Vd;this.T.gp(this.lm());this.T.bw=[this.ze];this.m().e(this.T,"select",this.Co);this.m().e(this.T,ul.wh.Fi,this.Hu)};t.lm=function(){return y(function(b){return B.filter(b,function(b){return B.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.Co=function(){var b=this.T.gj().slice(1);b&&3<b.length&&(this.AC=b,this.Pe(b[3],b[0]))};
t.Pe=function(b,c){var d=this;setTimeout(function(){d.fb.value=c});this.wC=b};t.Ie=ca();a.Zs=function(b,c,d){U.call(this,d);this.K=c||Vm.N();this.xb=b||this.K.zw()};A(Zs,U);t=Zs.prototype;t.Ox=l;t.nb=l;t.K=l;t.xb=l;t.kb=j;t.fc=j;t.pw=j;t.Eb=-1;t.jc=l;t.Xf=m;t.LJ=m;t.OQ=j;t.wg=l;t.hc=function(){return this.Ox||this.K.hc(this)};t.ur=function(){return this.nb||(this.nb=new ij(this.hc()))};t.v=function(){this.g=this.K.v(this)};t.R=function(){return this.K.R(this.h())};t.dc=function(b){return this.K.dc(b)};
t.Z=function(b){this.g=this.K.o(this,b);"none"==b.style.display&&(this.kb=m)};t.z=function(){Zs.n.z.call(this);Ph(this,function(b){b.ya&&$s(this,b)},this);var b=this.h();this.K.ye(this);this.C(this.kb,j);this.m().e(this,"enter",this.Uw).e(this,"highlight",this.Yw).e(this,"unhighlight",this.gx).e(this,"open",this.kN).e(this,"close",this.yM).e(b,"mousedown",this.ve).e(Rb(b),"mouseup",this.EM).e(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.wM);this.Zh()&&at(this,j)};
a.at=function(b,c){var d=b.m(),e=b.hc();c?d.e(e,"focus",b.ue).e(e,"blur",b.Vc).e(b.ur(),"key",b.Wb):d.Fa(e,"focus",b.ue).Fa(e,"blur",b.Vc).Fa(b.ur(),"key",b.Wb)};t.ib=function(){this.Ob(-1);this.jc&&this.jc.tb(m);this.Xf=m;Zs.n.ib.call(this)};t.w=function(){Zs.n.w.call(this);this.nb&&(this.nb.F(),this.nb=l);this.K=this.jc=this.wg=this.Ox=l};t.Uw=s(j);
t.Yw=function(b){var c=es(this,b.target);if(-1<c&&c!=this.Eb){var d=bt(this);d&&d.pd(m);this.Eb=c;d=bt(this);this.Xf&&d.setActive(j);this.OQ&&(this.jc&&d!=this.jc)&&(d.Pb&64?d.tb(j):this.jc.tb(m))}Nc(this.h(),Uc.Lm,b.target.h().id)};t.gx=function(b){b.target==bt(this)&&(this.Eb=-1);Nc(this.h(),Uc.Lm,"")};t.kN=function(b){if((b=b.target)&&b!=this.jc&&b.getParent()==this)this.jc&&this.jc.tb(m),this.jc=b};t.yM=function(b){b.target==this.jc&&(this.jc=l)};
t.ve=function(b){this.fc&&(this.Xf=j);var c=this.hc();c&&Cc(c)?c.focus():b.preventDefault()};t.EM=function(){this.Xf=m};t.wM=function(b){var c;a:{c=b.target;if(this.wg)for(var d=this.h();c&&c!==d;){var e=c.id;if(e in this.wg){c=this.wg[e];break a}c=c.parentNode}c=l}if(c)switch(b.type){case "mousedown":c.ve(b);break;case "mouseup":c.Sf(b);break;case "mouseover":c.kd(b);break;case "mouseout":c.Wh(b);break;case "contextmenu":c.Nn(b)}};t.ue=ca();t.Vc=function(){this.Ob(-1);this.Xf=m;this.jc&&this.jc.tb(m)};
t.Wb=function(b){return this.isEnabled()&&this.P()&&(0!=Qh(this)||this.Ox)&&this.gf(b)?(b.preventDefault(),b.stopPropagation(),j):m};
t.gf=function(b){var c=bt(this);if(c&&"function"==typeof c.Wb&&c.Wb(b)||this.jc&&this.jc!=c&&"function"==typeof this.jc.Wb&&this.jc.Wb(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return m;switch(b.keyCode){case 27:if(this.Zh())this.hc().blur();else return m;break;case 36:ct(this);break;case 35:dt(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.xb==Ym)et(this);else return m;break;case 37:if(this.xb==Xm)this.zd()?ft(this):et(this);else return m;break;case 40:if(this.xb==
Ym)ft(this);else return m;break;case 39:if(this.xb==Xm)this.zd()?et(this):ft(this);else return m;break;default:return m}return j};a.$s=function(b,c){var d=c.h(),d=d.id||(d.id=c.Qd());b.wg||(b.wg={});b.wg[d]=c};t.H=function(b,c){Zs.n.H.call(this,b,c)};t.Kk=function(b,c,d){b.lk|=2;b.lk|=64;(this.Zh()||!this.LJ)&&uj(b,32,m);b.dp(m);Zs.n.Kk.call(this,b,c,d);b.ya&&this.ya&&$s(this,b);c<=this.Eb&&this.Eb++};
t.removeChild=function(b,c){if(b=na(b)?Nh(this,b):b){var d=es(this,b);-1!=d&&(d==this.Eb?b.pd(m):d<this.Eb&&this.Eb--);(d=b.h())&&(d.id&&this.wg)&&J.remove(this.wg,d.id)}b=Zs.n.removeChild.call(this,b,c);b.dp(j);return b};t.ep=function(b){this.h()&&f(Error("Component already rendered"));this.xb=b};t.P=p("kb");
t.C=function(b,c){if(c||this.kb!=b&&this.dispatchEvent(b?"show":"hide")){this.kb=b;var d=this.h();if(d){S(d,b);if(this.Zh()&&(d=this.hc()))d.tabIndex=this.fc&&this.kb?0:-1;c||this.dispatchEvent(this.kb?"aftershow":"afterhide")}return j}return m};t.isEnabled=p("fc");
t.Za=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.fc=j,Ph(this,function(b){b.wI?delete b.wI:b.Za(j)})):(Ph(this,function(b){b.isEnabled()?b.Za(m):b.wI=j}),this.Xf=this.fc=m),this.Zh()){var c=this.hc();c&&(c.tabIndex=b&&this.kb?0:-1)}};t.Zh=p("pw");t.Ke=function(b){b!=this.pw&&this.ya&&at(this,b);this.pw=b;if(this.fc&&this.kb){var c=this.hc();c&&(c.tabIndex=b?0:-1)}};t.Ob=function(b){(b=Rh(this,b))?b.pd(j):-1<this.Eb&&bt(this).pd(m)};
t.pd=function(b){this.Ob(es(this,b))};a.bt=function(b){return Rh(b,b.Eb)},a.ct=function(b){dt(b,function(b,d){return(b+1)%d},Qh(b)-1)},a.ft=function(b){dt(b,function(b,d){return(b+1)%d},b.Eb)},a.et=function(b){dt(b,function(b,d){b--;return 0>b?d-1:b},b.Eb)},a.dt=function(b,c,d){for(var d=0>d?es(b,b.jc):d,e=Qh(b),d=c.call(b,d,e),g=0;g<=e;){var h=Rh(b,d);if(h&&b.SB(h)){b.yz(d);break}g++;d=c.call(b,d,e)}};t.SB=function(b){return b.P()&&b.isEnabled()&&!!(b.Pb&2)};t.yz=function(b){this.Ob(b)};
a.gt=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<Yb().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=ys(document);window.scrollTo(g.x,g.y+c-d)})}},a.ht=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=Math.floor(b/604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=
d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.it=function(){var b=T;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.jt=function(b,c){return!la(b)?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',
b[0],"</a>"].join("")},a.kt=function(b){if(0===b||1===b)return"匿名用户";var c=M("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.lt=function(b){if(0===b||1===b)return M("span");if(la(b)){var c=M("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},M("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.mt=function(b){return 1===b?j:la(b)?b[3]===T[3]:m},a.nt=function(b,c){return $.post("/question/askpeople",
{qid:b,uid:c,op:"remove"})},a.ot=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.pt={MD:function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},EA:function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,params:{answer_id:b}},function(b){b&&b.r&&Fi("提示信息","<p>"+b.msg+'</p><p><a href="/question/24752645" target="_blank">为什么回答会被建议修改？</a></p>')})},wz:function(b,c){return $.post("/node/AnswerMetaV2",
{method:"set_copyright",params:{answer_id:b,is_copyable:Number(c)}})}},a.qt=function(b,c,d,e,g){Xj.call(this,b,[c],[d],e,g)};A(qt,Xj);qt.prototype.sh=function(){this.element.style.height=Math.round(this.coords[0])+"px"};a.rt=function(b,c,d,e,g){Xj.call(this,b,[c],[d],e,g)};A(rt,Xj);rt.prototype.sh=function(){this.element.style.width=Math.round(this.coords[0])+"px"};a.st=function(b,c,d,e,g){(2!=c.length||2!=d.length)&&f(Error("Start and end points must be 2D"));Xj.apply(this,arguments)};A(st,Xj);
st.prototype.sh=function(){var b=this.xi&&this.zd()?"right":"left";this.element.style[b]=Math.round(this.coords[0])+"px";this.element.style.top=Math.round(this.coords[1])+"px"};
a.tt=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(ms.test(d))return c.Or=Ls(d),c.type="hex",c;d=Ks(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=ls(e.toString(16));b=ls(b.toString(16));d=ls(d.toString(16));c.Or="#"+e+b+d;c.type="rgb";return c}if(Ms&&(d=Ms[b.toLowerCase()]))return c.Or=d,c.type="named",c;f(Error(b+" is not a valid color string"))},
a.ut=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return m;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return m;case 0:return!D;default:return 166>b.keyCode||183<b.keyCode}},a.vt=function(b){var c=Rb(b),d=C&&b.currentStyle;if(d&&Kc(Sb(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=
wg(b,d.width,"width","pixelWidth"),b=wg(b,d.height,"height","pixelHeight"),new Ob(c,b);d=vg(b);c=yg(b);b=hg(b);return new Ob(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.wt=function(b,c){var d=b.style[eb(c)];return"undefined"!==typeof d?d:b.style[Vf(b,c)]||""},a.xt=function(b){var c=arguments,d=c.length;return function(){for(var b,g=0;g<d;g++)b=c[g].apply(this,arguments);return b}},a.yt=function(b,c,d){return Math.min(Math.max(b,c),d)},a.zt=function(){f(Error("unimplemented abstract method"))},
a.At=function(b){O.call(this);this.view=this.name=l;J.extend(this.options={},this.defaults,b||{})};A(At,Gd);a.Bt={},a.Ct=function(b,c){function d(c){At.call(this,c);this.name=b}A(d,At);ya(d.prototype,c);Bt[b]=d};At.prototype.defaults={};At.prototype.m=function(){return this.Ig||(this.Ig=new me(this))};At.prototype.init=ca();At.prototype.w=function(){At.n.w.call(this);this.view&&(J.remove(this.view.nd,this.name),this.view=l);this.Ig&&(this.Ig.F(),this.Ig=l)};a.Dt=function(b){U.call(this);J.extend(this.D={},this.defaults,b||{});this.source=this.D.source;this.promise=$.Deferred().resolve();this.nd={}};A(Dt,U);t=Dt.prototype;t.defaults={source:l,fa:["autoload","shortcut"],kh:j,bn:"zg-btn-white zu-button-more"};t.fa=function(b,c){var d,e=Bt[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.ya?d.init(this):this.m().e(this,"initialized",function(){d.init(this)});this.nd[b]=d;return this};
t.Oi=function(){!this.Hd&&this.D.kh&&(this.Hd=this.yq(),kc(this.Hd,this.g),this.m().e(this.Hd,"click",this.Cs))};t.z=function(){Dt.n.z.call(this);this.Oi();B.forEach(this.wb(),this.Oq,this);B.forEach(this.D.fa,this.fa,this);this.dispatchEvent("initialized")};t.w=function(){J.forEach(this.nd,function(b){b.F()});this.nd=l;Dt.n.w.call(this)};a.Et=function(b,c,d){b.ya&&B.forEach(b.wb(),c,d);b.m().e(b,"itemcreated",function(b){c.call(d,b.item)})};t.wb=function(){return oc(this.g)};
t.Oq=function(b,c){this.Rj(b,c);this.dispatchEvent({type:"itemcreated",item:b,index:c})};t.Rj=w;a.Ft=function(b){b.Hd&&(N(b.Hd),b.Hd=l);b.dispatchEvent("complete")};t.fQ=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.W(c);this.dispatchEvent("next");(d||b.next===m)&&Ft(this)}};t.W=function(b,c){var b=$.isArray(b)?b.join(""):b,d=fc(b+" ");B.forEach($.makeArray(oc(d)),this.Oq,this);lc(this.g,d,c)};
t.Cs=function(){if(this.dispatchEvent("beforeloadnext")!==m&&"pending"!==this.promise.state())return this.Lz(j),this.promise=this.source().done(y(this.fQ,this)).always(y(xa(this.Lz,m),this))};t.Cc=p("Hd");t.yq=function(){return M("a",{"aria-role":"button","class":this.D.bn},"更多")};t.Lz=function(b){this.Hd&&(this.Hd.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",H.enable(this.Hd,"loading",b))};a.Ht=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,n,q,r,v,x){if("%"==r)return"%";var F=d.shift();"undefined"==typeof F&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=F;return Gt[r].apply(l,arguments)})},a.Gt={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+Array(d-b.length+
1).join(" "):Array(d-b.length+1).join(" ")+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+Array(b+1).join(" "):(c=0<=c.indexOf("0",0)?"0":" ",e=h+Array(b+1).join(c)+e);return e},d:function(b,c,d,e,g,h,k,n){return Gt.f(parseInt(b,10),c,d,e,0,h,k,n)}};Gt.i=Gt.d;
Gt.u=Gt.d;Ct("activeSource",{defaults:{sK:"%d 条新动态",bn:"zu-main-feed-fresh-button",uY:w},init:function(b){this.data=[];this.button=this.yq();jc(this.button,b.h());this.m().e(this.button,"click",function(){b.W(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!pa(d.F))&&f(Error("Source must return a disposable object."));this.yL=d},setData:function(b){this.data=b;this.PP()},PP:function(){var b=this.data.length;
xc(this.button,Ht(this.options.sK,b));S(this.button,!!b)},yq:function(){return M("a",{href:"javascript:;",style:"display:none","class":this.options.bn})},F:function(){At.prototype.F.call(this);Tc(this.yL);this.options=l;this.button&&(N(this.button),this.button=l)}});a.It=function(b){O.call(this);this.viewport=b||window;this.size=l;this.zW=yg(document.body).top;this.ca=new me(this);this.wp=l;this.sL=250;this.hf();setTimeout(y(this.update,this))};A(It,Gd);It.prototype.hf=function(){var b=this.wp=new an(this.update,this.sL,this);this.ca.e(this.viewport,"scroll",b.fire,m,b).e(this.viewport,"resize",b.fire,m,b)};It.prototype.m=p("ca");It.prototype.w=function(){It.n.w.call(this);this.ca.F();this.ca=l;this.wp.F();this.wp=l};
It.prototype.update=function(){this.size=(qa(this.viewport)&&this.viewport.window==this.viewport?Yb:og)(this.viewport);this.dispatchEvent("update")};a.Kt=function(b,c,d){var e=Jt;e.ca.e(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.ca.Fa(this,"update",h))})},a.Jt=new It;$(function(){Jt.update()});Ct("autoload",{defaults:{EB:j,viewport:window,oY:s(j)},init:function(b){if(b.Cc()&&(!this.options.EB||T.oa())){var c=this.options.viewport,d=new It(c);Rc(this,d);var e=this;e.m().e(d,"update",function(d){var h;h=ua(e);var k=sd[h];if(k){var n=ka("nearbottom"),q=ka(i);n&&q?(k=rd.nearbottom,h=!!k&&!!k[i]&&h in k[i]):h=!n&&!q?j:B.some(k,function(b){return n&&"nearbottom"==b.type||q&&b.capture==i})}else h=m;h&&(!rg(b.Cc())?0:400>=(qa(c)&&c.window==c?b.Cc().getBoundingClientRect().top-d.target.size.height:
c.scrollHeight-c.scrollTop-d.target.size.height))&&e.dispatchEvent("nearbottom")});this.m().e(b,"complete",this.F).e(b,"next",function(){this.enable()});this.enable()}},enable:function(){oe(this.m(),this,"nearbottom",function(){this.view.Cs()})}});Ct("childConstructor",{defaults:{Qi:l,factory:l},init:function(b){pa(this.options.Qi)&&Et(b,this.YK,this);pa(this.options.factory)&&Et(b,this.pR,this)},YK:function(b){var c=new this.options.Qi;this.view.H(c);c.o(b)},pR:function(b){var c=this.options.factory(b);this.view.H(c);c.o(b)}});Ct("dataPagingSource",{defaults:{XB:j},init:function(b){var c=$(b.h()).data("paging").next;c||Ft(b);b.source=function(){return $.get(c).then(function(b){c=b.paging.next;return{results:b.htmls,next:!!c}})}}});a.Lt=function(b){J.extend(this.D={},this.defaults,b||{});this.content="";this.wc=this.Ne=this.Oe=l;this.vd=m;this.valid=j};A(Lt,U);t=Lt.prototype;t.defaults={OH:"textarea.content",QB:".toggle-expand",ZS:".summary",uv:"zm-editable-content",qr:m};
t.z=function(){Lt.n.z.call(this);var b=this.g,c=this.D;c.qr?(this.Oe=$("."+c.uv,b),this.content=this.Oe.val(),this.wc=$(c.QB,b)):(this.Rp=$(c.OH,b),this.content=this.Rp.is(":input")?this.Rp.val():this.Rp.html(),this.Oe=$(c.ZS,b),this.wc=$(c.QB,this.Oe));if(this.Oe.length){if(this.wc.length)this.wc.click(m).on("click",$.proxy(this.expand,this));this.Oe.on("click",$.proxy(this.tN,this))}else this.valid=m,this.expand=this.collapse=w,this.dispatchEvent("invalid")};t.Cc=function(){return this.wc.get(0)};
t.bb=p("content");t.Na=function(b,c){b?this.expand(c):this.collapse(c)};t.tN=function(b){var c=uo();if(!c||!c.Ec())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),this.expand())};
t.expand=function(b){!this.vd&&this.dispatchEvent("beforeexpand")!==m&&(this.vd=j,this.D.qr?(this.Oe.removeClass("fixed-summary"),this.wc.remove()):(this.Ne?this.Ne.show():this.Oe.length&&(this.Ne=$("<div>",{html:this.content,"class":this.D.uv}).insertBefore(this.Rp)),this.Oe.hide()),b!==j&&this.dispatchEvent("expand"))};t.collapse=function(b){this.vd&&(this.vd=m,this.Ne&&this.Ne.hide(),this.D.qr?this.Oe.addClass("fixed-summary"):this.Oe.show(),b!==j&&this.dispatchEvent("collapse"))};Ct("expandLimit",{defaults:{zY:3},init:function(b){var c=aj.create("ExpandLimit");c.get("expandCount")||c.Zd("expandCount","0");T.oa()||this.m().e(b,"beforeloadnext",function(){Jm("expand");return m})}});Ct("locationSource",{defaults:{vs:20,param:l,Xs:m,offset:function(b){return b.length}},init:function(b){function c(b){return{start:d.Xs?B.Wd(b).id.split("-")[1]:0,offset:d.offset(b)}}var d=this.options,e=d.url||location.href,g=b.wb().length;(!g||g<d.vs)&&Ft(b);b.source=function(){return $.post(e,(d.param||c)(b.wb())).then(function(c){if(!c.r){var c=c.msg,e=c[0];oa(e)&&e<d.vs&&Ft(b);return{results:c[1]}}})}}});Ct("nodeSource",{defaults:{XB:j},init:function(b){var c=$(b.h()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0,c=e.limit,h=e.pagesize;this.options.XB&&(c&&b.wb().length<c)&&Ft(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.wb().length})}).then(function(b){var c=j;h&&(!b.r&&b.msg.length<h)&&(c=m);return!b.r&&{results:b.msg,next:c}})}}});Ct("shortcut",{defaults:{items:">div"},init:function(b){b.wb().length&&(this.Ao=new lq(this.options),this.Ao.o(b.h()),this.m().e(this.Ao,"action",function(c){c.data.index>=c.data.size&&b.Cc()&&rg(b.Cc())&&b.Cc().click()}))},F:function(){At.prototype.F.call(this);this.Ao&&(this.Ao.F(),this.Ao=l)}});a.Mt=function(b){Dt.call(this,b)};A(Mt,Dt);a.Nt=function(){};A(Nt,cj);ia(Nt);Nt.prototype.L=s("goog-menuheader");a.Ot=function(b,c,d){rj.call(this,b,d||Nt.N(),c);uj(this,1,m);uj(this,2,m);uj(this,4,m);uj(this,32,m);this.V=1};A(Ot,rj);pj("goog-menuheader",function(){return new Ot(l)});a.Pt=function(){this.kv=[]};A(Pt,cj);ia(Pt);a.Qt=function(b,c){var d=b.kv[c];if(!d){switch(c){case 0:d=b.L()+"-highlight";break;case 1:d=b.L()+"-checkbox";break;case 2:d=b.L()+"-content"}b.kv[c]=d}return d};t=Pt.prototype;t.qc=function(){return Vc.XI};t.v=function(b){var c=b.J().v("div",this.df(b).join(" "),Rt(this,b.bb(),b.J()));St(this,b,c,!!(b.Pb&8)||!!(b.Pb&16));ej(this,b,c);return c};t.R=function(b){return b&&b.firstChild};
t.o=function(b,c){var d=qc(c),e=Qt(this,2);d&&H.has(d,e)||c.appendChild(Rt(this,c.childNodes,b.J()));H.has(c,"goog-option")&&(b.ap(j),this.ap(b,c,j));return Pt.n.o.call(this,b,c)};t.Aa=function(b,c){var d=this.R(b),e=Tt(this,b)?d.firstChild:l;Pt.n.Aa.call(this,b,c);e&&!Tt(this,b)&&d.insertBefore(e,d.firstChild||l)};a.Rt=function(b,c,d){b=Qt(b,2);return d.v("div",b,c)};t.qi=function(b,c,d){c&&(Mc(c,d?Vc.ZI:this.qc()),St(this,b,c,d))};t.ap=function(b,c,d){c&&(Mc(c,d?Vc.YI:this.qc()),St(this,b,c,d))};
a.Tt=function(b,c){var d=b.R(c);if(d){var d=d.firstChild,e=Qt(b,1);return!!d&&H.has(d,e)}return m},a.St=function(b,c,d,e){e!=Tt(b,d)&&(H.enable(d,"goog-option",e),d=b.R(d),e?(b=Qt(b,1),d.insertBefore(c.J().v("div",b),d.firstChild||l)):d.removeChild(d.firstChild))};t.Fn=function(b){switch(b){case 2:return Qt(this,0);case 16:case 8:return"goog-option-selected";default:return Pt.n.Fn.call(this,b)}};
t.Jw=function(b){var c=Qt(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return Pt.n.Jw.call(this,b)}};t.L=s("goog-menuitem");a.Ut=function(b,c,d,e){rj.call(this,b,e||Pt.N(),d);this.Ba(c)};A(Ut,rj);t=Ut.prototype;t.S=function(){var b=this.ly;return b!=l?b:this.Fg()};t.Ba=da("ly");t.qi=function(b){uj(this,8,b);this.Ae()&&!b&&this.$c(m);var c=this.h();c&&this.K.qi(this,c,b)};t.ap=function(b){uj(this,16,b);var c=this.h();c&&this.K.ap(this,c,b)};
t.Fg=function(){var b=this.bb();return la(b)?(b=B.map(b,function(b){var d=H.get(b);return B.contains(d,"goog-menuitem-accel")||B.contains(d,"goog-menuitem-mnemonic-separator")?"":Gc(b)}).join(""),La(b)):Ut.n.Fg.call(this)};t.Sf=function(b){var c=this.getParent();if(c){var d=c.vG;c.vG=l;if(c=d&&oa(b.clientX))c=new Lb(b.clientX,b.clientY),c=d==c?j:!d||!c?m:d.x==c.x&&d.y==c.y;if(c)return}Ut.n.Sf.call(this,b)};t.gf=function(b){return b.keyCode==this.ky&&this.Xd(b)?j:Ut.n.gf.call(this,b)};t.jM=p("ky");
pj("goog-menuitem",function(){return new Ut(l)});a.Vt=function(){};A(Vt,Vm);ia(Vt);t=Vt.prototype;t.qc=function(){return Vc.WI};t.dc=function(b){return"UL"==b.tagName||Vt.n.dc.call(this,b)};t.Hn=function(b){return"HR"==b.tagName?new Um:Vt.n.Hn.call(this,b)};t.Ef=function(b,c){return sc(b.h(),c)};t.L=s("goog-menu");t.ye=function(b){Vt.n.ye.call(this,b);Nc(b.h(),Uc.Hk,"true")};a.Wt=function(b){Um.call(this,Tm.N(),b)};A(Wt,Um);pj("goog-menuseparator",function(){return new Um});a.Xt=function(b,c){Zs.call(this,Ym,c||Vt.N(),b);this.Ke(m)};A(Xt,Zs);t=Xt.prototype;t.Qm=j;t.MJ=m;t.L=function(){return this.K.L()};t.Ef=function(b){if(this.K.Ef(this,b))return j;for(var c=0,d=Qh(this);c<d;c++){var e=Rh(this,c);if("function"==typeof e.Ef&&e.Ef(b))return j}return m};t.Ga=function(b){this.H(b,j)};t.Ii=function(b,c){this.Kk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.F()};t.Th=function(b){return Rh(this,b)};t.yl=function(){return Qh(this)};
t.wb=function(){var b=[];Ph(this,function(c){b.push(c)});return b};t.Nc=function(b,c){var d=this.P();d||S(this.h(),j);xs(this.h(),b,c);d||S(this.h(),m)};t.C=function(b,c,d){(c=Xt.n.C.call(this,b,c))&&(b&&this.ya&&this.Qm)&&this.hc().focus();this.vG=b&&d&&oa(d.clientX)?new Lb(d.clientX,d.clientY):l;return c};t.Uw=function(b){this.Qm&&this.hc().focus();return Xt.n.Uw.call(this,b)};t.SB=function(b){return(this.MJ||b.isEnabled())&&b.P()&&!!(b.Pb&2)};
t.Z=function(b){var c=this.K,d;d=this.J();d=Tb(d.Ha,"div",c.L()+"-content",b);for(var e=d.length,g=0;g<e;g++)Wm(c,this,d[g]);Xt.n.Z.call(this,b)};t.gf=function(b){var c=Xt.n.gf.call(this,b);c||Ph(this,function(d){!c&&(d.jM&&d.ky==b.keyCode)&&(this.isEnabled()&&this.pd(d),c=d.Wb(b))},this);return c};t.Ob=function(b){Xt.n.Ob.call(this,b);(b=Rh(this,b))&&ig(b.h(),this.h())};a.Yt=function(b,c,d,e){Ps.call(this,b,c,d||e);if(d||e)this.um(65|(e?32:132))};A(Yt,Ps);a.Zt=function(){};A(Zt,hj);ia(Zt);t=Zt.prototype;t.v=function(b){var c={"class":"goog-inline-block "+this.df(b).join(" "),title:b.Rf()||""},c=b.J().v("div",c,this.Oi(b.bb(),b.J()));ej(this,b,c);return c};t.qc=function(){return Vc.Tp};t.R=function(b){return b&&b.firstChild.firstChild};t.Oi=function(b,c){return c.v("div","goog-inline-block "+(this.L()+"-outer-box"),c.v("div","goog-inline-block "+(this.L()+"-inner-box"),b))};t.dc=function(b){return"DIV"==b.tagName};
t.o=function(b,c){$t(c,j);$t(c,m);var d;a:{d=b.J().FD(c);var e=this.L()+"-outer-box";if(d&&H.has(d,e)&&(d=b.J().FD(d),e=this.L()+"-inner-box",d&&H.has(d,e))){d=j;break a}d=m}d||c.appendChild(this.Oi(c.childNodes,b.J()));H.add(c,"goog-inline-block",this.L());return Zt.n.o.call(this,b,c)};t.L=s("goog-custom-button");
a.$t=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==Ma(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Na(g);break}}else break;d=e}};a.au=function(){};A(au,Zt);ia(au);D&&(au.prototype.Aa=function(b,c){var d=au.n.R.call(this,b&&b.firstChild);d&&mc(this.createCaption(c,Sb(b)),d)});t=au.prototype;t.R=function(b){b=au.n.R.call(this,b&&b.firstChild);D&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.o=function(b,c){var d=Ub("*","goog-menu",c)[0];if(d){S(d,m);Rb(d).body.appendChild(d);var e=new Xt;e.o(d);b.ih(e)}return au.n.o.call(this,b,c)};
t.Oi=function(b,c){return au.n.Oi.call(this,[this.createCaption(b,c),c.v("div","goog-inline-block "+(this.L()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return bu(b,this.L(),c)};a.bu=function(b,c,d){return d.v("div","goog-inline-block "+(c+"-caption"),b)};t.L=s("goog-menu-button");a.cu=function(b,c,d,e){yj.call(this,b,d||au.N(),e);uj(this,64,j);this.Tl=new Yt(l,5);c&&this.ih(c);this.EF=l;this.na=new Id(500);if((Og||Pg)&&!G("533.17.9"))this.ms=j};A(cu,yj);t=cu.prototype;t.ms=m;t.ek=m;t.z=function(){cu.n.z.call(this);this.qa&&du(this,this.qa,j);Nc(this.h(),Uc.Hk,"true")};t.ib=function(){cu.n.ib.call(this);if(this.qa){this.tb(m);this.qa.ib();du(this,this.qa,m);var b=this.qa.h();b&&N(b)}};t.w=function(){cu.n.w.call(this);this.qa&&(this.qa.F(),delete this.qa);delete this.hR;this.na.F()};
t.ve=function(b){cu.n.ve.call(this,b);this.Fb()&&(this.tb(!this.rb(),b),this.qa&&(b=this.rb(),this.qa.Xf=b))};t.Sf=function(b){cu.n.Sf.call(this,b);this.qa&&!this.Fb()&&(this.qa.Xf=m)};t.Xd=function(){this.setActive(m);return j};t.DM=function(b){this.qa&&(this.qa.P()&&!this.Ef(b.target))&&this.tb(m)};t.Ef=function(b){return b&&sc(this.h(),b)||this.qa&&this.qa.Ef(b)||m};
t.gf=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return m;if(this.qa&&this.qa.P()){var c=this.qa.Wb(b);return 27==b.keyCode?(this.tb(m),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.tb(j),j):m};t.On=function(){this.tb(m)};t.dN=function(){this.Fb()||this.tb(m)};t.Vc=function(b){this.ms||this.tb(m);cu.n.Vc.call(this,b)};t.Ua=function(){this.qa||this.ih(new Xt(this.J()));return this.qa||l};
t.ih=function(b){var c=this.qa;if(b!=c&&(c&&(this.tb(m),this.ya&&du(this,c,m),delete this.qa),b)){this.qa=b;Oh(b,this);b.C(m);var d=this.ms;(b.Qm=d)&&b.Ke(j);this.ya&&du(this,b,j)}return c};a.eu=function(b){b.EF=new Pf(7,0,7,0)};t.Ga=function(b){this.Ua().H(b,j)};t.Ii=function(b,c){this.Ua().Kk(b,c,j)};t.removeItem=function(b){(b=this.Ua().removeChild(b,j))&&b.F()};t.Th=function(b){return this.qa?Rh(this.qa,b):l};t.yl=function(){return this.qa?Qh(this.qa):0};
t.C=function(b,c){var d=cu.n.C.call(this,b,c);d&&!this.P()&&this.tb(m);return d};t.Za=function(b){cu.n.Za.call(this,b);this.isEnabled()||this.tb(m)};a.fu=function(b){b.Tl.um&&b.Tl.um(33)};t.CH=function(){this.tb(j)};
t.tb=function(b,c){cu.n.tb.call(this,b);if(this.qa&&!!(this.V&64)==b){if(b)this.qa.ya||(this.ek?this.qa.W(this.h().parentNode):this.qa.W()),this.vk=gg(this.h()),this.Mi=pg(this.h()),gu(this),this.qa.Ob(-1);else if(this.setActive(m),this.qa.Xf=m,this.h()&&Nc(this.h(),Uc.Lm,""),this.Ws!=l){this.Ws=i;var d=this.qa.h();d&&mg(d,"","")}this.qa.C(b,m,c);if(!this.If){var d=this.m(),e=b?d.e:d.Fa;e.call(d,this.J().Da(),"mousedown",this.DM,j);this.ms&&e.call(d,this.qa,"blur",this.dN);e.call(d,this.na,Jd,this.Zl);
b?this.na.start():this.na.stop()}}};a.gu=function(b){if(b.qa.ya){var c=b.Tl;b.Tl.element=b.hR||b.h();var d=b.qa.h();b.qa.P()||(d.style.visibility="hidden",S(d,j));!b.Ws&&(b.Tl.In&&b.Tl.In()&32)&&(b.Ws=og(d));c.X(d,c.Ff^1,b.EF,b.Ws);b.qa.P()||(S(d,m),d.style.visibility="visible")}};
t.Zl=function(){var b=pg(this.h()),c=gg(this.h());if(!(this.Mi==b||(!this.Mi||!b?0:this.Mi.left==b.left&&this.Mi.width==b.width&&this.Mi.top==b.top&&this.Mi.height==b.height))||!(this.vk==c||(!this.vk||!c?0:this.vk.top==c.top&&this.vk.right==c.right&&this.vk.bottom==c.bottom&&this.vk.left==c.left)))this.Mi=b,this.vk=c,gu(this)};a.du=function(b,c,d){var e=b.m(),d=d?e.e:e.Fa;d.call(e,c,"action",b.On);d.call(e,c,"highlight",b.Yw);d.call(e,c,"unhighlight",b.gx)};t.Yw=function(b){Nc(this.h(),Uc.Lm,b.target.h().id)};
t.gx=function(){bt(this.qa)||Nc(this.h(),Uc.Lm,"")};pj("goog-menu-button",function(){return new cu(l)});a.hu=function(){O.call(this)};A(hu,Gd);hu.prototype.fB={question:"问题",comment:"评论",answer:"回答",favlist:"收藏",member:"用户",message:"私信",image:"图片",video:"视频",post:"文章"};hu.prototype.Av="report-dialog";hu.prototype.uF="loading";hu.prototype.tD='<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %><span class="error-container"></span></div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
hu.prototype.submit=zt;t=hu.prototype;t.Aw=p("wn");t.Tk=function(b,c){var d=new Ai;ci(d,j);d.Cg=j;ii(d,ki);d.addEventListener(ji,this.CM,m,this);Rc(d,this);b&&d.Ta(b);c&&d.Aa(c);d.C(j);d.X();H.add(d.h(),this.Av);return this.wn=d};t.CM=function(b){if("ok"===b.key)return(b=$("form",this.wn.h()).valid())&&this.submit(),b};
t.open=function(b,c,d){var e=this.Tk(this.CD(b),this.dv());H.add(e.h(),this.uF);this.JD(b).then(y(function(g){e.Aa(cl(this.tD,{each:B.forEach,options:g,headnote:d}));H.remove(e.h(),this.uF);e.X();Ci(e,450);this.LL={type:b,id:c};this.tq(g)},this))};t.ZD=ca();
t.tq=function(b){var c=this,d=$(this.wn.h()),e=$("form",d),g=$(".reason-text",d);d.on("change",":radio",function(h){h=$(h.target);d.find("li").removeClass("checked");h.parentsUntil(e,"li").addClass("checked");var k=this.value,n=B.find(b,function(b){return k===String(b.value)});c.ZD(n);n="0"===k;g.toggle(n);n&&g.placeholder();h.closest("li").find("ul, :text").length||e.valid()});d.find("ul ul").on("change",":radio",function(b){$(b.delegateTarget).parent().find(".group-description").text($(this).data("description"))});
e.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",d).length}}},messages:{reason:"请选择理由",detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",e)})};t.dv=s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>');a.ju=function(b,c,d){U.call(this);this.type=b;this.id=c;this.Tu=d||iu[b]||"other_report"};A(ju,U);a.iu={question:"question_report",answer:"question_answer_report",post:"article_report",member:"member_report",comment:"comment_report",favlist:"favlist_report",message:"message_report"},a.ku=y(Or(function(b){return $.getJSON(Ha("/report/%s/options",b))}),ga);
ju.submit=function(b,c,d){c=$.extend({type:b,id:c},d);X.ha({type:"ga_click_report",data:{type:b}});$.post("/report",c).done(function(b){if(b.r)"duplicate_report"===b.errtype?V(b.msg,3E3,"重复举报"):V(b.msg);else if(b.noti){var c=Ei({title:"举报成功！",Mj:j,content:'<p>您的举报正在等待人工审核，我们会在 24 小时内审核完成</p><p>处理完成后会「私信」通知您</p><p>您也可以进入 <a href="/community/report">社区服务中心</a> 查看实时处理进度</p><label class="modal-dialog-cancelNoti"><input type="checkbox" name="cancelNoti" />不再提醒</label>',className:"report-success-dialog",
X:j,Re:["知道啦"]});c.m().e(c,gi,function(){$($h(c)).find("input[name=cancelNoti]")[0].checked&&$.post("/community/report/noti",{cancel:j});return j})}else V("您的举报正在等待人工审核，我们会在 24 小时内审核完成",2E3,"举报成功！")})};ju.prototype.submit=Km(function(b){ju.submit(this.type,this.id,b)},function(){return{oa:this.Tu,ed:j}});ju.prototype.AH=Km(function(){(new lu(this.type,this.id)).open(this.type,this.id);X.ha({type:"ga_click_report_box",data:{type:this.type}})},function(){return{oa:this.Tu,ed:j}});
a.mu=function(b,c){if(b.type&&b.id&&!$(c).hasClass("goog-menu-button")){var d=new cu("report",new Xt);d.ek=j;d.dc=of;d.o(c);Rc(d,b);b.DF=d;oe(b.m(),d.h(),["mouseover","focus"],zi(b.aO))}};
ju.prototype.aO=function(){var b=this.DF,c=this.DF.Ua();ku(this.type).then(function(d){$.each(d,function(b,d){var h=new Ut(d.label,{value:d.value,options:d.options});c.Ga(h)});gu(b);$(c.h()).addClass("report-menu")});this.m().e(c,"show",Km(function(){X.ha({type:"ga_click_report_box",data:{type:this.type}})},{oa:this.Tu,ed:j})).e(c,"action",this.Nw)};
ju.prototype.Nw=function(b){var c=b.target.S().value,d=b.target.S().options,b=this.type;0===c?(c=new lu(this.type,this.id),c.Tk("请填写你的举报理由",'<form><p class="input-container"><textarea class="textarea" name="detail"></textarea></p><p class="error-container"></p><input value="0" name="reason" type="hidden"></form>'),c=$(c.Aw().h()),c=$("form",c),c.validate({rules:{detail:{rangelength:[2,100],required:j}},messages:{detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",c)})):"member"===b&&10018!==
c?(new lu(this.type,this.id)).Tk("请填写你的举报理由",'<form><p class="input-container"><input placeholder="填写违规内容链接会更快被管理员处理" type="text" name="link" class="reason-text zg-form-text-input"></p><p class="error-container"></p><input value="'+c+'" name="reason" type="hidden"></form>'):"question"===b&&d?$.get("/report/reported",{type:"question",id:this.id},$.proxy(function(b){if(b.r)V(b.msg);else if(b.reported)V(b.msg,3E3,"重复举报");else{var b=new lu(this.type,this.id),c=cl(b.tD,{each:B.forEach,options:d,headnote:'<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>'});
b.Tk("需要进一步修改",c);b.tq(d)}},this)):ju.submit(b,this.id,{reason:c})};a.lu=function(b,c){O.call(this);this.type=b;this.id=c};A(lu,hu);lu.prototype.JD=ku;lu.prototype.submit=function(){var b=$($("form",this.wn.h())[0]).serializeArray(),b=B.reduce(b,function(b,d){d.value&&(b[d.name]=d.value);return b},{});ju.submit(this.type,this.id,b)};lu.prototype.CD=function(b){return Ha("为什么举报这个%s？",this.fB[b]||"条目")};a.nu=function(){O.call(this);this.lf="zm-pm-item"};A(nu,Lm);
nu.prototype.init=function(){var b=K("zh-create-pm");b&&this.m().e(b,"click",this.NP);var b=K("zh-pm-item-wrap"),c=new Mt;c.fa("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.o(b);this.m().e(b,"click",this.ta);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})});$('a[name="report"]').each(function(b,c){var g=$(c).closest(".zm-pm-item").data("report-token");
mu(new ju("message",g),c)})};nu.prototype.NP=Km(function(){var b;this.Vn();this.Nb.show();Zq(this.Nb,-1);(b=Xa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Nb.Ct(b)},j);nu.prototype.Vn=function(){this.Nb||(this.Nb=new Vq({kt:j}))};
nu.prototype.ta=function(b){if(b=Wk(this.bY,b.target)){var c=b.name,d=Ic(b,l,this.lf);if(!d||!b.name)return j;var e=$(d).data(),g=e.member,h=e.name;switch(c){case "reply":Km(y(function(){this.Vn();this.Nb.show();var b=this.Nb,c=e.type;b.vp=e.token;b.iA=c;Zq(this.Nb,g,h,m);this.Nb.Xb.focus()},this),j)();break;case "delete":var k=d.getAttribute("data-token");Ei("删除私信会话","你确定要删除与 "+h+"的所有会话吗？",function(b){if(b){var c=new W(j);c.on("success",function(){var b=Je(c);b.r?V(b.msg):window.location.reload()});
c.ajax("/inbox/delete","type=thread&token="+k)}},this);break;case "edit":b=this.ng,S(this.Mc,j),S(b,m),this.si=-1}}};a.ou=function(){O.call(this);this.lf="zm-pm-item"};A(ou,Lm);
ou.prototype.init=function(){this.ys=K("zh-pm-detail-item-wrap");this.m().e(this.ys,"click",this.ta);var b=K("zh-pm-editor-form");if(b){this.Nb=new Vq({kt:j});this.Nb.Hp=m;this.Nb.hh(b);this.Nb.show();if(b=this.wb()[0]){var b=$(b).data(),c=this.Nb,d=b.type;c.vp=b.token;c.iA=d;Zq(this.Nb,b.member,b.name)}else b=kh,Zq(this.Nb,b.id,b.vw);this.Nb.focus()}else this.Nb=new Vq({kt:j});this.wb().length&&(b=new Mt,b.fa("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),
b.o(this.ys));this.wj()};ou.prototype.wj=function(){$('a[name="report"]').each(function(b,c){var d=$(c).closest(".zm-pm-item").data("token");mu(new ju("message",d),c)})};ou.prototype.wb=function(){return oc(this.ys)};
ou.prototype.ta=function(b){var c=Wk(this.ys,b.target);if(c&&(b=c.name,c=Ic(c,l,this.lf))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Nb.show();var b=this.Nb,e=c.type;b.vp=d;b.iA=e;Zq(this.Nb,c.member,c.name,m);this.Nb.focus();break;case "delete":Ei("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new W(j);oe(this.m(),c,"success",function(){var b=Je(c);b.r?V(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this)}}};a.pu=function(b,c,d){U.call(this);this.offset=this.Le=0;this.vS=d;this.HL=b;this.url=c||window.location.href;this.Uf="zm-item";this.params={}};A(pu,U);t=pu.prototype;t.AA=!sb;t.zA=!sb;t.ni=da("Uf");t.init=function(){this.Yb=K("zh-load-more");this.o(this.HL)};
t.z=function(){pu.n.z.call(this);this.Um=1;qu(this);this.Fk=$(this.Yb);this.Yb&&ru(this)&&(this.m().e(this.Yb,"click",function(){this.eo=j;this.vh&&"pending"===this.vh.state()&&1===this.Um?(this.vh.done(y(this.Vg,this)),this.Jz=j,su(this,j)):this.Ey()}),this.AA&&(this.jA=new an(this.By,100,this),this.m().e(window,"scroll",function(){this.jA.fire()})));tu(this,this.wb())};a.su=function(b,c){c?b.Fk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.Fk.html("更多").prop("disabled",m)};
t.By=function(){var b=this.Yb;if(b&&rg(b)&&1E3>=b.getBoundingClientRect().top-Yb().height&&!(this.bt||this.vh&&"pending"===this.vh.state()))this.zA&&(3===this.Um?(this.Um=1,this.Jz=m):(this.eo=m,this.Um++,this.Jz=j)),this.Ij()};t.Ey=function(){this.AA&&this.bt?(this.Vg(this.bt),this.bt=l):(su(this,j),this.Ij())};a.ru=function(b){var c=b.wb();b.offset=b.sy?b.sy(c):c.length;if(b.Lr)return c=b.Lr(),S(b.Yb,c),c;if(b.Yb){if("-1"===b.Fk.attr("data-next")||!c||10>c.length)return b.Fk.hide(),m;b.Fk.removeClass("hidden").show()}return j};
t.Ij=function(b,c,d){c=c||w;if(!(this.vh&&"pending"===this.vh.state())){var e=this.MG($.extend(this.params,{offset:this.offset,start:this.Le}));this.vh=$.post(this.url,e).done(c).done($.proxy(function(c){if(d)return d.call(this,c);this.AA&&!b?this.Jz?this.Vg(c):(this.bt=c,su(this,m)):this.Vg(c)},this));1!==this.Um&&su(this,j);return this.vh}};t.MG=ba();
t.Vg=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.Yb.setAttribute("data-next",g));0<d&&(this.Rm(e),this.offset=this.sy?this.sy(this.wb()):this.offset+d);c=j;c=this.Lr?this.Lr(b):!(-1===g||10>d);S(this.Yb,c);su(this,m);uu(this)}};a.uu=function(b){b.dispatchEvent({data:{eo:b.eo,zA:b.zA},type:"afterload"})};t.wb=function(){return Vb(this.Uf,this.g)};t.EG=function(b){return b.id.split("-")[1]};
a.qu=function(b){var c=b.wb(),d;if(b.vS)if(b.Yb&&(d=b.Yb.getAttribute("data-next")),d)b.Le=d;else if(c=B.Wd(c))b.Le=b.EG(c)};t.Rm=function(b,c){var d=la(b)?b.join(""):b,d=fc(d+" "),e=Vb(this.Uf,d);tu(this,e);"prepend"===c?jc(d,this.g.firstChild):this.g.appendChild(d);qu(this)};a.tu=function(b,c){B.forEach(c,function(b){var c=this.Rj(b);this.dispatchEvent({data:{item:b,NO:c},type:"itemcreated"})},b)};t.Rj=w;a.vu=function(b){O.call(this);this.g=b;b=C||E&&!G("531")&&"TEXTAREA"==b.tagName;this.M=new me(this);this.M.e(this.g,b?["keydown","paste","cut","drop","input"]:"input",this)};A(vu,Gd);vu.prototype.na=l;
vu.prototype.handleEvent=function(b){if("input"==b.type)wu(this),(!rb||this.g==Rb(this.g).activeElement)&&this.dispatchEvent(xu(b));else if("keydown"!=b.type||ut(b)){var c="keydown"==b.type?this.g.value:l;C&&229==b.keyCode&&(c=l);var d=xu(b);wu(this);this.na=Kd(function(){this.na=l;this.g.value!=c&&this.dispatchEvent(d)},0,this)}};a.wu=function(b){b.na!=l&&(Ld(b.na),b.na=l)},a.xu=function(b){b=new kd(b.Vb);b.type="input";return b};vu.prototype.w=function(){vu.n.w.call(this);this.M.F();wu(this);delete this.g};a.zu=function(b,c,d,e){O.call(this);this.Kd=b;this.Lh=c;this.Tg=d;this.RC=e||yu;this.yj=new vu(b);P(this.yj,"input",this.Eo,m,this);this.Ni()};A(zu,Gd);a.yu=0;t=zu.prototype;t.Eo=function(){this.Ni()};t.Ni=function(){var b=this.vr();this.Lh&&(0>this.Tg-b?(xc(this.Lh,"已超出 "+(b-this.Tg)+" 字"),H.add(this.Lh,"zg-text-error")):(xc(this.Lh,"还可以输入 "+(this.Tg-b)+" 字"),H.remove(this.Lh,"zg-text-error")))};t.w=function(){zu.n.w.call(this);delete this.Kd;this.yj.F();this.yj=l};
t.isValid=function(){return 0<=this.Tg-this.Kd.value.length};t.vr=function(){return this.Kd.value.length};a.Au=function(b,c,d,e){zu.call(this,b,c,d,e)};A(Au,zu);Au.prototype.vr=function(){return Yk(this.Kd.value)};a.Bu=function(b,c){O.call(this);this.ba=l;this.qL=c;this.pS.apply(this,b);this.init()},a.Cu=void 0,a.Du=function(b,c){Cu||(Cu=new Bu(b,c))};A(Bu,Lm);Bu.prototype.Ue={};a.Eu=Or(function(){return $.get("/node/WebShareDialogV2")});t=Bu.prototype;t.init=function(){this.m().e(Ni,"question_title_change",function(){this.Ue[this.zf]=l});Eu().then(y(function(b){b=fc(Ma(b));this.v(b);this.pb();this.show();Fu(this,this.qL)},this))};
t.show=function(){Gu(this);this.uc&&(this.uc.checked=m,this.Tj());Pm.N().refresh();this.ba.C(j)};t.hide=function(){this.ba.C(m)};t.pS=function(b,c,d,e){this.rf={title:b,type:c,pT:d,params:e};this.zf=c+":"+d};
a.Gu=function(b){b.ba.Ta(b.rf.title);b.Ue[b.zf]||(b.xhr=new W(j),oe(b.m(),b.xhr,"success",b.qS),b.xhr.ajax("/"+b.rf.type+"/"+b.rf.pT+"/sharetext","","GET"));K("zh-webshare-sina-pm").value=b.Ue[b.zf]&&b.Ue[b.zf].sina||"加载中...";b.EH.Ni();Qm(b.Rz);b.Rz.bu();var c=b.zk;c.Xb.value=b.Ue[b.zf]&&b.Ue[b.zf].pm||"加载中...";c.wK&&c.wK.Ni();Qm(c.HG);c.HG.bu();S(c.Mc,j);S(c.ng,m);if("answer"===b.rf.type||"post"===b.rf.type)$(b.g).find("#tb-webshare-daily").parent().removeClass("zg-hide"),b.Ue[b.zf]&&$(b.g).find(".tb-webshare-daily-title").html(b.Ue[b.zf].daily)};
t.qS=function(){var b=Je(this.xhr);b&&b.r?V(b.msg):(this.Ue[this.zf]=b,Gu(this))};t.v=function(b){this.g=b;this.ba=new Ai(l,m);ii(this.ba,l);this.ba.Cg=j;this.ba.R().appendChild(this.g);P(this.ba,gi,function(){Cu=l});this.zk=new Vq({GG:"share"});this.zk.qb=this.ba;this.zk.hh(K("tb-webshare-letter-content"));this.zk.Wk=m;this.zk.init()};t.Cz=function(){this.uc.checked=j;this.Tj()};
a.Fu=function(b,c){var d=K(c+"-content"),e=K(c);B.forEach(b.bT,function(b){H.remove(b.parentNode,"active")});B.forEach(b.aT,function(b){S(b,m)});H.add(e.parentNode,"active");S(d,j);b.RR||(b.ba.X(),b.RR=j)};
t.pb=function(){var b=L("tab-navs",this.g);this.m().e(b,"click",this.CQ);this.bT=$(".tab-nav > a",this.g);this.aT=Vb("zm-tab-content",this.g);$(".zm-command",this.g).on("click",$.proxy(this.ta,this));this.Uy=K("zh-webshare-sina-pm");this.Rz=new Sm(this.Uy);this.EH=new Au(this.Uy,K("zg-webshare-sina-counter"),140,yu);this.m().e(X,"sina_callback",function(b){this.Cz(b.Kc.id,b.Kc.name)});this.Wu();b=L("zg-btn-blue",this.zk.h());T.Hi||H.LH(b,"zg-btn-blue","zg-btn-disabled");this.m().e(b,"click",this.ta)};
t.Wu=function(){this.uc=L("sina-checkbox",this.g);this.m().e(this.uc,"change",this.Hy)};t.Tj=function(){var b=L("weibo-share-button",this.g),c=this.uc.checked;H.enable(b,"zg-btn-blue",c);H.enable(b,"zg-btn-disabled",!c)};t.Hy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.uc&&!sh.id?(window.open(c),b.checked=m,b=j):b=i;b||this.Tj()};t.CQ=function(b){(b=this.cf(b.target))&&Fu(this,b.id)};
t.ta=function(b){var c=this.cf(b.target);if(c)switch(c.name){case "send_sina":if(!H.has(c,"zg-btn-disabled")){var d=this.Uy.value;d&&this.zf in this.Ue&&(c=new Xk(j),c.add("content",d),d=[],this.uc.checked&&d.push("sina"),c.add("via",d.join(",")),this.Yj(c),this.rf&&X.ha({type:"ga_click_share_"+this.rf.type+"_weibo",data:{sI:d}}))}break;case "send":if(!H.has(c,"zg-btn-disabled"))if(c=this.zk,"-1"===String(c.si))Xq(c,"请填写收信人。");else if(d=c.Xb.value,this.zf in this.Ue)if(Ma(d)){var e=new Xk(j);e.add("talker_id",
c.si);e.add("content",d);e.add("via","pm");this.Yj(e);this.rf&&X.ha("ga_click_share_"+this.rf.type+"_message")}else Xq(c,"请填写私信内容。");break;case "send_daily":c=new Xk(j);c.add("content",$(".tb-webshare-daily-form [name=recommend-reason]").val());c.add("via","daily");this.Yj(c);break;case "cancel":this.hide()}b.stopPropagation();b.preventDefault()};
t.Yj=function(b){J.forEach(this.rf.params,function(c,d){b.add(d,c)});this.xhr=new W(j);oe(this.m(),this.xhr,"complete",this.Ku);this.xhr.ajax("/"+this.rf.type+"/share",b.hd())};t.Ku=function(){var b=Je(this.xhr);this.ba.C(m);b&&b.r?V(b.msg):V(b.msg||"分享发送完毕")};t.P=function(){return this.ba.P()};a.Hu=void 0,a.Iu=[],a.Ju=[].slice,a.Ku=il(550,function(){if(Iu.length){var b=Iu;T.oa()&&(b={items:JSON.stringify(b)},$.post("/lastread/touch",b));Iu=[]}});Hu=function(){Iu.push(Ju.call(arguments));Ku()};a.Lu=function(b){var c=l;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.Mu=function(b){var c=[],b=b||document.styleSheets,d=ka(i)?i:m;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)B.extend(c,Mu(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)B.extend(c,Mu(b[e]))}else{var h=Lu(b);if(h&&h.length)for(var e=0,g=h.length,k;e<g;e++)k=h[e],k.styleSheet&&B.extend(c,Mu(k.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.Nu=/a(:(link|visited|active|hover))?/,a.Ou=function(){this.un="";this.gh=[]};Ou.prototype.clone=function(){var b=new Ou;b.gh=this.gh.concat();b.un=this.un;return b};
a.Pu=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.un=e.join("")},a.Qu=/(^|;|{)\s*color:([^;]+);/g,a.Su=function(b){this.Sy=[];this.Pu={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new Ru(b[d]);c.push(e)}this.hi=c}},a.Ru=function(b){var c=Tu[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.JE=b;this.gP=d;this.PH={};Tu[b]=this},a.Tu={},a.Uu=function(b,c){var d=c.uid,e=b.PH[d];if("undefined"!=typeof e)return e;var g=b.gP,e=g.tagName,h=g.className,g=g.id,k=j;e&&"*"!=e&&e!=c.nodeName?k=m:g&&g!=c.id?k=m:h&&!c.EK[h]&&(k=m);return b.PH[d]=k},a.Wu=function(b){var c=ua(b),d=Vu[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=H.get(b),k=0;k<h.length;k++)g[h[k]]=1;e.EK=g;d.unshift(e)}while(b=b.parentNode);
this.WF=d;this.uid=ua(this);Vu[c]=this},a.Vu={},a.Xu={},a.Yu="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Zu="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.$u=function(){O.call(this);this.fc=this.aq()};A($u,Gd);t=$u.prototype;t.B=l;t.bK=j;t.Lb=le("goog.editor.Plugin");t.iI=function(){this.B&&(this.disable(this.B),this.B=l)};t.enable=function(b){this.B==b?this.fc=j:this.Lb.log(ce,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.B==b?this.fc=m:this.Lb.log(ce,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.B==b?this.fc:m};t.aq=nf;t.JO=nf;
t.w=function(){this.B&&this.iI(this.B);$u.n.w.call(this)};a.av=J.Fm({$w:1,XM:2,Gr:3,oj:4,Hr:5,execCommand:6,queryCommandValue:7,LG:8,GK:10,FK:11}),a.bv=J.Ih(8,10,11);$u.prototype.execCommand=function(b,c){var d=this.JO(b);d||(D&&cv(this.B,j,j),this.B.Kh());try{var e=this.$e.apply(this,arguments)}finally{d||(this.B.Xe(),dv(this.B))}return e};$u.prototype.Be=s(m);a.ev=function(b,c,d,e,g){this.iD=b;this.Uz=c;this.vq=d;this.nD=e;this.gw=g||{}},a.fv=function(b,c){this.ST=b;this.sC=c},a.gv=function(b,c,d,e){var g=[];b.vq&&b.Uz&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.vq&&g.push("height:",b.nD?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.sC&&g.push(d.sC);D&&b.Uz&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Ts&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.iD,'" style="min-width:0;');D&&b.vq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.Uz?"100%":"auto"),b.nD?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));rb&&g.push(";outline:hidden");for(var h in b.gw)g.push(";"+h+":"+b.gw[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.nv=function(b,c){O.call(this);this.Jg=this.id=b;this.gb=l;this.nd={};this.uj={};for(var d in av)this.uj[d]=[];this.$k="";this.pk={};this.pk[hv]=1;this.pk[iv]=1;this.Fx=this.ns=m;this.Xq=new Pj(this.PC,jv,this);this.Vq={};for(var e in kv)this.Vq[kv[e]]=0;D&&(this.le=new Pj(this.Mn,lv,this));this.gc=new me(this);this.TT=[];this.Jj=mv;this.am=Sb(c||document);this.Jc=this.am.h(this.id);this.Mk=this.am.Pa()};A(nv,Gd);nv.prototype.field=l;nv.prototype.Jc=l;nv.prototype.Lb=le("goog.editor.Field");
a.hv="change",a.iv="delayedchange",a.kv={oU:"cvc",eV:"load",nW:"unload",fU:"beforechange",mU:hv,tU:iv,gU:"beforefocus",CU:"focus",iU:"blur",hU:"beforetab",SU:"ifrsz",RV:"selectionchange"},a.mv=0,a.ov=l;t=nv.prototype;t.Kg=m;t.oI=m;t.gu=m;t.h=p("field");t.addListener=function(b,c,d,e){var g=this.h();Eo&&(g&&this.nc())&&(g=g.ownerDocument);this.gc.e(g,b,c,d,e)};t.Uh=function(b){return this.nd[b]};a.lv=15,a.jv=250;nv.prototype.nc=of;nv.prototype.fo=of;nv.prototype.zH=nf;a.pv={46:j,8:j};C||(pv[9]=j);
a.qv={86:j,88:j};C&&(pv[229]=j);a.rv=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in pv;return(b.ctrlKey||b.metaKey)&&b.keyCode in qv||c},a.sv=function(b,c){b.Jj=2;b.field=c;b.gb=Sb(c);b.ns=m;b.Fx=m;c.setAttribute("g_editable","true")};
nv.prototype.nv=function(){this.gc&&this.gc.removeAll();if((Og||Pg)&&this.nc()&&this.zH()){try{var b=this.gb.Pa();b.removeEventListener("keydown",this.Zm,m);b.removeEventListener("touchend",this.Zm,m)}catch(c){}delete this.Zm}if(rb&&this.nc()){try{b=this.gb.Pa(),b.removeEventListener("focus",this.$u,m),b.removeEventListener("blur",this.Zu,m)}catch(d){}delete this.$u;delete this.Zu}this.le&&this.le.stop();this.Xq.stop()};
nv.prototype.w=function(){(1==this.Jj||this.Td())&&this.Lb.xk("Disposing a field that is in use.");this.Jc&&this.execCommand("clearlorem");this.Jj=mv;for(var b in this.nd){var c=this.nd[b];c.aq()||c.disable(this)}this.gb=this.field=l;this.nv();this.pl&&(zd(this.pl),this.pl=l);this.am=l;this.gc&&(this.gc.F(),this.gc=l);for(;b=this.TT.pop();)b.F();ov==this.id&&(ov=l);for(var d in this.nd)b=this.nd[d],b.bK&&b.F();delete this.nd;nv.n.w.call(this)};
a.tv=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];nv.prototype.Fz=function(){if(Bo||!this.nc())this.gc.e(this.h(),"DOMSubtreeModified",this.ax);else{var b=this.gb.Da();this.gc.e(b,tv,this.ax,j);this.gc.e(b,"DOMAttrModified",y(this.QD,this,this.ax),j)}};
a.uv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||D&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),m;var d;if(!(d=c.charCode))d=rv(c)?j:!(!D||c.ctrlKey||c.metaKey||D&&!c.charCode);b.Mw=d;b.Mw&&b.Kh();return j},a.vv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.wv={65:j,86:j,88:j},a.xv={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=nv.prototype;
t.co=function(b,c){for(var d=this.uj[b],e=B.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||bv[b])&&h[av[b]].apply(h,e))return j}return m};t.vO=function(b,c){for(var d=this.uj[b],e=B.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||bv[b])&&h[av[b]].apply(h,e)}};t.ht=function(b,c,d){for(var e=this.uj[b],g=B.slice(arguments,1),h=0;h<e.length;++h){var k=e[h];if(k.isEnabled(this)||bv[b])g[0]=k[av[b]].apply(k,g)}return g[0]};
a.yv=function(b,c,d){var e={},b=b.ht(8,c||"",e);Uf(d,e);d.innerHTML=b};t.ff=function(b){(D||uv(this,b))&&!this.co(1,b)&&Lo&&zv(this,b)};t.YM=function(b){if(D){if(!uv(this,b))return}else this.Mw=j,this.Kh();!this.co(2,b)&&!Lo&&zv(this,b)};t.ZM=function(b){!D&&(this.Mw||rv(b))&&this.Mn();this.co(3,b);Av(this,"selectionchange")||(vv[b.keyCode]||(b.ctrlKey||b.metaKey)&&wv[b.keyCode])&&this.qH.start()};
a.zv=function(b,c){if(!c.altKey){var d=kb?c.metaKey:c.ctrlKey;if(d||xv[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.co(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.uj[6],h=0;h<g.length;++h){var k=g[h];if(k.isEnabled(this)&&k.Be(b)){e=k.execCommand.apply(k,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Td()&&this.kf;if(na(b))return this.ft(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.ft(b[e],c);return d};t.ft=function(b,c){for(var d=this.uj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.Be(b)&&(c||g.aq()))return g.queryCommandValue(b)}return c?l:m};t.QD=function(b,c){if(!Av(this,hv)){var d=c.Vb;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.ax=function(b){Av(this,hv)||(b=b.zD?b.Vb:b,b.target.firebugIgnore||(this.Fx=this.ns=j,this.le.start()))};t.Dr=function(){C&&this.execCommand("clearlorem",j);D&&this.Ov();this.Xe()};a.Bv=function(b){var c;return b.nc()&&(c=b.gb)?(b=c.Pa())&&b.frameElement:l},a.Cv=function(b){return(b=b.gb&&b.gb.Pa())&&uo(b)},a.dv=function(b,c,d){if(!Av(b,"selectionchange")){var e=Cv(b),e=e&&e.Cb();b.kf=!!e&&sc(b.h(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",$X:c&&c.type});b.co(4,c,d)}};
t.rN=function(){var b=this.pH;this.pH=l;dv(this,i,b)};t.Kh=function(){Av(this,"beforechange")||this.dispatchEvent("beforechange")};a.cv=function(b,c,d){c&&(b.le&&cs(b.le),b.pk[hv]=1);d&&(Dv(b),b.pk[iv]=1)},a.Ev=function(b,c,d){!c&&b.le&&cs(b.le);b.pk[hv]=0;b.pk[iv]=0;c&&b.Mn();d&&b.PC()},a.Av=function(b,c){return!!b.pk[c]||b.Vq[c]&&500>=Aa()-b.Vq[c]};t.Xe=function(b){Ev(this,j,b)};t.Mn=function(){Av(this,hv)||(this.le&&this.le.stop(),this.Fx=this.ns=j,Av(this,iv)||this.Xq.start())};
t.PC=function(){Av(this,iv)||(this.Xq.stop(),this.ns=m,this.dispatchEvent(iv))};a.Dv=function(b){b.le&&cs(b.le);cs(b.Xq)};t.Ov=function(){this.OC();this.QC()};t.OC=function(){Av(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.QC=function(){if(!Av(this,"focus")){ov=this.id;this.kf=j;this.dispatchEvent("focus");if(D){var b=this.h(),c=Cv(this);if(c){var d=Fn(c);0==Gn(c)&&(!d||d==b||"BODY"==d.tagName)&&Rs(b)}}!Co&&this.nc()&&this.gb.Pa().parent.getSelection().removeAllRanges()}};
t.ar=function(){Av(this,"blur")||(ov==this.id&&(ov=l),this.kf=m,this.dispatchEvent("blur"))};a.Fv=function(b){Ic(b.target,"A")&&b.preventDefault()};t.lj=function(b){ov=this.id;if(C){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.am.Pa().open(c.href)}this.gu=j};t.Tw=function(){this.gu=m};t.WD=function(b){if(!this.oI||this.gu)this.gu=m,dv(this,b),C&&(this.pH=b.target,this.qH.start())};t.eN=function(b){dv(this,b)};
t.ul=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Td()){var b=this.Jc;b||this.Lb.log(be,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.h(),b=c.cloneNode(m),c=c.innerHTML;C&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.vO(11,b);return this.ht(10,b.innerHTML)};
t.Cd=function(b,c,d,e){if(1==this.Jj)this.Lb.log(ce,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&cv(this,m,j);b=c;if(c=this.h()){if(this.nc()&&E)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Jc;c&&yv(this,b,c);e&&this.execCommand("updatelorem");this.Td()&&(d?(D&&cs(this.le),Ev(this)):this.Xe())}};
t.rA=function(){var b=this.gb.Da();b.designMode="on";Ho&&b.execCommand("styleWithCSS",m,m)};t.LE=function(){this.$k&&Gv(this)&&sg(this.$k,this.h())};t.Td=function(){return 2==this.Jj};t.focus=function(){if(!Ts&&this.nc())this.gb.Pa().focus();else{if(rb)var b=this.Mk.pageXOffset,c=this.Mk.pageYOffset;this.h().focus();rb&&this.Mk.scrollTo(b,c)}};t.Qf=function(){(zo||E)&&Hv(this);this.focus()};a.Hv=function(b){var c=b.h();if(c){var d=As(c);c==d?wo(c,0).select():Zr(d,j);dv(b)}};
t.De=function(b){this.Jj=1;var c=this.Jc;this.nodeName=c.nodeName;this.pY=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.cy(b)};t.cy=function(b){var c=this.Jc;if(c){var c=c.innerHTML,d={},c=this.ht(8,c,d),e=this.am.v("IFRAME",this.HD());if(Gv(this)){var g=y(this.yE,this,e,c,d);this.pl=P(e,"load",g,j);b&&(e.src=b)}this.DB(e);Gv(this)||this.yE(e,c,d)}};
t.Er=function(){C&&Us(this.gb.Pa());ov!=this.id&&this.execCommand("updatelorem");if((Og||Pg)&&this.nc()&&this.zH()){var b=this.gb.Pa();this.Zm=y(b.focus,b);b.addEventListener("keydown",this.Zm,m);b.addEventListener("touchend",this.Zm,m)}rb&&this.nc()?(this.$u=y(this.Ov,this),this.Zu=y(this.ar,this),b=this.gb.Pa(),b.addEventListener("focus",this.$u,m),b.addEventListener("blur",this.Zu,m)):(Ko?(this.addListener("focus",this.QC),this.addListener(id,this.OC)):this.addListener("focus",this.Ov),this.addListener("blur",
this.ar,D));if(D)this.Fz();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.Kh);var c=this.Xe,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.Dr)}this.addListener(E?"dragend":"dragdrop",this.Dr);this.addListener("keydown",this.ff);this.addListener("keypress",this.YM);this.addListener("keyup",this.ZM);this.qH=new Pj(this.rN,250,this);Io&&this.addListener("click",Fv);this.addListener("mousedown",
this.lj);this.oI?(this.gc.e(this.gb.Da(),"mouseup",this.WD),this.addListener("dragstart",this.Tw)):this.addListener("mouseup",this.WD);this.addListener("mouseover",this.eN);this.LE();Ev(this);this.Lb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.nd)this.nd[e].enable(this)};a.Gv=function(b){if(!ka(b.Ix)&&(b.Ix=m,C&&b.nc())){for(var c=b.am.Pa();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.Ix="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.Ix};
t.DB=function(b){var c=this.Jc;b.className=c.className;b.id=c.id;mc(b,c)};t.Bw=function(b){var c=Kc(Sb(this.Jc));return new ev(this.id,c,m,m,b)};t.BI=function(b,c,d){d=this.Bw(d);Gv(this)?(b=(b.contentDocument||b.contentWindow.document).body,Ts&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.iD,Uf(b,d.gw),b.innerHTML=c):gv(d,c,new fv(this.h(),this.$k),b)};
t.yE=function(b,c,d){this.pl&&(zd(this.pl),this.pl=l);b.sW="true";this.BI(b,c,d);sv(this,(b.contentDocument||b.contentWindow.document).body);!Ts&&this.nc()&&this.rA();this.Er()};t.HD=function(){var b="padding:0;"+this.Jc.style.cssText;Ga(b,";")||(b+=";");b+="background-color:white;";C&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.Iv=function(b,c){nv.call(this,b,c)},a.Jv=void 0;A(Iv,nv);t=Iv.prototype;t.Lb=le("goog.editor.SeamlessField");t.TE=m;t.BO=m;t.fo=p("TE");t.$D=function(){Av(this,hv)||Kv(this)};
t.Sz=function(){if(this.lp?0:this.lp=j){var b=m,c=Bv(this);if(c){var d,e=Bv(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(wt(e,"height"),10)&&Uf(e,"height","1px");Kc(Sb(g))?e=d.offsetHeight:(e=d.scrollHeight,d.clientHeight!=d.offsetHeight&&(e+=Jv||(Jv=Bg())));d=e;this.nP&&(d=Math.max(d,this.nP));parseInt(wt(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.lp=m;b&&this.dispatchEvent("ifrsz")}};
a.Kv=function(b){if(b.lp?0:b.lp=j){var c=Bv(b),d=b.h(),e=m;if(c&&d){var g,h=c.parentNode,k=h.offsetWidth;parseInt(wt(c,"width"),10)!=k&&(g=yg(d),c.style.width=k+"px",d.style.width=k-g.left-g.right+"px",e=j);h=h.offsetHeight;b.fo()&&parseInt(wt(c,"height"),10)!=h&&(g||(g=yg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.lp=m;e&&b.dispatchEvent("ifrsz")}},a.Lv=function(b){b.h()&&(Kv(b),b.fo()||b.Sz())};t.lx="";a.Mv=m;t=Iv.prototype;t.nc=function(){return!Ts};
t.Fz=function(){Iv.n.Fz.call(this);if(this.nc()){var b=Bv(this).ownerDocument;this.gc.e(b,tv,this.$D,j);this.VO=wd(this.gb.Pa(),"load",this.Sz,j,this);this.gc.e(b,"DOMAttrModified",y(this.QD,this,this.$D),j)}};t.Mn=function(){Av(this,hv)||(Iv.n.Mn.call(this),this.nc()&&this.Sz())};
t.ar=function(){if(!Av(this,"blur")&&(Iv.n.ar.call(this),!Ts&&!Co)){var b=this.gb.Pa(),c=m;zd(this.lF);this.lF=wd(b.document.body,"dragover",function(){c=j});ga.setTimeout(y(function(){if(!c&&this.gb){var b=Cv(this),e=this.gb.Pa();Us(e);b&&(b.collapse(j),b.select())}},this),0)}};t.rA=function(){Iv.n.rA.call(this);var b=this.gb.Da();b.execCommand("enableInlineTableEditing",m,"false");b.execCommand("enableObjectResizing",m,"false")};
t.LE=function(){!this.nc()&&!Mv&&(this.$k&&sg(this.$k,this.h()),Mv=j)};t.cy=function(b){if(this.nc())Iv.n.cy.call(this,b);else if(b=this.Jc)sv(this,b),b.contentEditable=j,yv(this,b.innerHTML,b),this.Er()};t.Er=function(){if(this.nc()){var b=this;ga.setTimeout(function(){Lv(b)},0)}Iv.n.Er.call(this)};t.HD=function(){return{frameBorder:0,style:"padding:0;"}};
t.DB=function(b){if(!this.BO){var c=this.Jc;c&&(this.TE="auto"==Yf(c,"overflowY"))}var c=this.Jc,d=Sb(c),e=c.style.width,g=c.style.height;Uf(c,"visibility","hidden");var d=d.v("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=vt(c),d=h.width,h=h.height,k="";this.fo()&&(k="&nbsp;",Uf(c,"position","relative"),Uf(c,"overflow","visible"),Uf(b,"position","absolute"),Uf(b,"top","0"),Uf(b,"left","0"));mg(c,d,h);Kc(Sb(c))&&(this.ZX=
c.style.lineHeight,Uf(c,"lineHeight","0"));c.innerHTML=k;mg(b,d,h);mg(c,e,g);Uf(c,"visibility","");c.appendChild(b);Gv(this)||(c=b.contentWindow.document,Kc(Sb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.Bw=function(b){var c=this.Jc;if(c)return new ev(this.id,Kc(Sb(c)),j,this.fo(),b);f(Error("no field"))};
t.BI=function(b,c,d){Uf(b,"visibility","hidden");var d=this.Bw(d),e=this.Jc,g=this.$k;if(!this.lx){var h=this.Jc;if(h){var k=h.ownerDocument,n=ua(k);if(!Xu[n]){for(var q=ua(k),r=[],k=Mu(k.styleSheets),v=0,x;x=k[v];v++)if((x=Lu(x))&&x.length)for(var F=0,I=x.length;F<I;F++){var R=new Ou,aa;aa=R;var ta=x[F],Nb=ta.style;if(Nb){var Oa=i,Ua=i;Nb&&(Oa=ta.selectorText)&&(Ua=Nb.cssText)?C&&(Ua+="/* */"):ta.cssText&&(Ua=/([^\{]+)\{/,Oa=Ua.exec(ta.cssText)[1],Ua=ta.cssText.replace(Ua,"").replace(/\}[^\}]*$/g,
""));if(Oa){ta=aa;ta.gh=[];Oa=Oa.split(/,\s*/gm);for(Nb=0;Nb<Oa.length;Nb++){var ye=Oa[Nb];0<ye.length&&ta.gh.push(new Su(ye))}aa.un=Ua;aa=j}else aa=m}else aa=m;aa&&r.push(R)}Xu[q]=r}q=Xu[n];n=[];for(r=0;r<q.length;r++)n.push(q[r].clone());k=new Wu(h);v=new Ru("body");for(q=0;q<n.length;q++){x=n[q].gh;r=x.length;for(F=0;F<r;F++){I=x[F];R=I;aa=k.uid;if(R.Pu[aa])aa=R.Pu[aa];else{for(var Ua=0,Nb=Oa=ta=l,ye=k.WF,FE=ye.length,ek=0;ek<=R.hi.length;ek++){for(Oa=R.hi[ek];Ua<FE;){var xy=ye[Ua];if(Oa&&Uu(Oa,
xy)){ta={YC:Ua,rH:ek};Ua++;break}else Nb&&Uu(Nb,xy)&&(ta={YC:Ua,rH:ek-1});Ua++}Nb=Oa}aa=R.Pu[aa]=ta}aa&&(R=aa.rH,I=I.hi,Ua=I.length-1,aa.YC==k.WF.length-1||R<Ua?(I=I.concat(),I.splice(0,R+1,v),R=new Su,R.hi=I,x.push(R)):0<R&&R==Ua&&(R=new Su,R.hi=[v,I[Ua]],x.push(R)))}}k=new Ou;h=h.currentStyle||Rb(h).defaultView.getComputedStyle(h,"")||{};q=new Su;q.hi=[new Ru("html")];k.gh=[q];v={};for(q=0;r=Yu[q];q++)v[r]=h[eb(r)];Pu(k,v);n.push(k);k=new Ou;v=new Su;v.hi=[new Ru("body")];x={position:"relative",
top:"0",left:"0",right:"auto",display:"block",visibility:"visible"};for(q=0;r=Zu[q];q++)x[r]=h[eb(r)];Pu(k,x,j);k.gh=[v];n.push(k);h=[];r=n.length;for(q=0;q<r;q++){x=n[q];k=h;F=x.gh.length;v=m;for(I=0;I<F;I++){R=x.gh[I].hi;aa=R.length;for(Ua=0;Ua<aa;Ua++)k.push(R[Ua].JE," ");I<F-1&&k.push(",");D&&!G("1.9a")&&(v=v||Nu.test(R[aa-1].JE))}x=x.un;v&&(x=x.replace(Qu,"$1 color: $2 ! important; "));k.push("{",x,"}\n")}this.lx=h.join("")}}e=new fv(e,g+this.lx);d.vq&&(g=yg(e.ST),(g.top||g.left||g.right||g.bottom)&&
Uf(b,"margin",-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));gv(d,c,e,b);Lv(this);Uf(b,"visibility","visible")};t.nv=function(){zd(this.lF);zd(this.VO);Iv.n.nv.call(this)};a.Nv={};Nv._default_={Fw:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},vl:zt,wl:zt,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},Yx:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
Nv.answer={vl:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},wl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},aK:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
Nv.question={vl:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},wl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
Nv.favlist={vl:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},wl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
Nv.post={Fw:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},vl:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},wl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},Yx:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
Nv.roundtable={Fw:function(b){return $.get("/roundtable/comments/"+b)},vl:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},wl:function(b){return $.get("/roundtable/comments",{roundtable_id:b})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},Yx:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/RoundtableCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};a.Pv=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.vc=new Ov(c)};A(Pv,gd);a.Ov=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};Ov.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.Qv=function(){O.call(this)};A(Qv,hu);a.Rv=function(b,c,d){$.post(b,c).done(function(b){if(b.r)V(b.msg);else{var c=b.msg;(c=c&&c.redirect)?window.location.href=c:(V("操作成功！"),d&&d(b))}})},a.Sv=void 0,a.Tv=Or($.getJSON);Sv=function(b,c){return Tv(Ha("/manage/%s/options?action=%s",b,c))};t=Qv.prototype;t.VA={remove:"删除",lock:"锁定",unlock:"解除锁定",collapse:"折叠",uncollapse:"解除折叠",mute:"隔离",unmute:"解除隔离"};t.JD=function(b){return Sv(b,this.tl())};
t.Tk=function(b,c){var d=Qv.n.Tk.call(this,b,c);d.oc.set("ok",this.VA[this.tl()]);return d};t.tl=function(){return $(this.cv).data("op").split("-")[0]};t.CD=function(b){return Ha("确定要%s该%s？",this.VA[this.tl()],this.fB[b]||"条目")};t.uH=function(b){$(".footnote",this.Aw().h()).text(b)};t.ZD=function(b){b&&(b.trackable?(b=$.extend({action:"get_member_info",reason:b.value},this.LL),$.post("/manage",b).then(function(b){return Ha("用户已被警告 %s 次，禁言 %s 次",b.warn_num,b.ban_num)}).then(y(this.uH,this))):this.uH(""))};
Qv.prototype.submit=function(){var b=$(this.cv).data(),c=b.action,b=b.content,d=$($("form",this.wn.h())[0]).serialize();b&&(d+="&"+b);Rv(c,d,this.Vk)};Qv.prototype.w=function(){this.Vk=this.cv=l;Qv.n.w.call(this)};Qv.prototype.open=function(b,c,d){this.cv=b;this.Vk=d||fa.TX;Qv.n.open.call(this,c.type,c.id,"")};a.Uv=function(b){U.call(this);J.extend(this.D={},this.defaults,b||{});this.Ik=new Od;this.Bf=l};A(Uv,U);t=Uv.prototype;t.defaults={trigger:{A:"data-editable"},uJ:"hc-actionbar",MO:"checked",zS:100,LN:100};
t.z=function(){Uv.n.z.call(this);this.Wm=M("div");document.body.appendChild(this.Wm);var b=this.D,c=new Oq(b.trigger,m,l,this.g);c.Ht=b.zS;c.Qr=b.LN;c.hh(this.Wm);P(c,"trigger",function(b){c.Nc(new vq(b.anchor,1))});P(c,"beforeshow",function(b){this.Bf=b.target.anchor;this.W()},m,this);c.className=b.uJ;this.QN=c};t.Dw=p("QN");
a.Vv=function(b,c){var d=b.D.MO,e=oc(b.Wm),g=B.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||H.has(g,d))return m;B.forEach(e,function(b){H.remove(b,d)});H.add(g,d);return j};t.rK=function(b,c,d){c=M("div",{title:b.Q,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[M("i","icon icon-actionbar-"+b.name)]);ug(c,j);this.m().e(c,"click",function(){Vv(this,b.name)&&b.Uk(this.Bf)});return c};
t.W=function(){this.Wm.innerHTML="";hc(this.Wm,B.map(J.La(this.Ik.Xt()),this.rK,this))};a.Wv=function(b){U.call(this);J.extend(this.D={},this.defaults,b||{})};A(Wv,U);Wv.prototype.defaults={pE:{},YJ:j};
Wv.prototype.z=function(){Wv.n.z.call(this);var b=this,c=this.g;if(this.D.YJ){var d=new Uv({});d.Ik.set("link",{name:"link",Q:"链接",Uk:function(b){xc(b,b.href)}||w});d.Ik.set("text",{name:"text",Q:"文本",Uk:function(b){xc(b,b.getAttribute("data-title"))}||w});d.o(c);var e=d.Dw();Wr(e,new Pf(2,0,0,0));e.Kl=new Pf(2,0,0,0)||l;var g=d.m();g.e(e,"beforeshow",function(b){var b=b.target.anchor,c=Fc(b);c===b.href?Vv(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Vv(d,"text"))}).e(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Xv(b))return m});var h;g.e(e,"show",function(b){h=b.target.anchor;H.add(h,"hover")}).e(e,"hide",function(){h&&(H.remove(h,"hover"),h=l)});this.Zp=d}this.m().e(c,"paste",function(){setTimeout(function(){var c=b.D,d=b.g,e=zc(d,function(b){return 3===b.nodeType&&!Yv(b,d,function(b){return Xv(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=uo(),x=h&&En(h);B.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Zv,function(b){Fa(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=fc(d),x===b&&(g=c.lastChild),mc(c,b))});g&&Zr(g);var F=c.pE,c=B.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=B.contains($v,b.protocol))c=Fc(b),Fa(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=B.map(c,function(b){return aw(b.href).done(function(c){var e=F;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
uo();if(e){var g=e.U(),h=e.ra(),k=e.ea(),n=e.Ia();sc(c,g)&&(g=b,h=0);sc(c,k)&&(k=b,n=0);d(function(){g===b&&k===b?Zr(b):fo(g,h,k,n).select()})}else d(w)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){xc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){mc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).e(c,"keydown",this.GN)};
Wv.prototype.GN=function(b){var c=uh(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=uo(),e=c.U(),g=c.ea(),h=this.g,k,n=Yv(e,h,Xv)||g!==e&&(k||(k=Yv(g,h,Xv)));if(n){var q=Fc(n),r=c.ra(),v=c.Ia();if(n.getAttribute("data-editable")&&q===n.href){var x=m;k=k||Yv(g,h,Xv)||n;var h=n.contains(e),F=k.contains(g);if(d)h&&(e=n,r=0,x=j),F&&(g=k,v=Rr(k),x=j),x&&fo(e,r,g,v).select();else if(h&&F&&k===n){if(!c.isCollapsed()||!(0===r||q.length===r))b.preventDefault(),Zr(n)}else h&&
(e=n.nextSibling,r=0,x=j),F&&(g=k.previousSibling,v=Rr(g),x=j),x&&fo(e,r,g,v).select()}}}};a.Zv=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.$v=["http:","https:"],a.Yv=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Xv=function(b){return"A"===b.nodeName},a.aw=Or(function(b){return $.post("/scraper",{url:b})});a.bw=function(b,c,d){U.call(this);this.id=b;this.type=c;this.field=l;this.vd=this.Zg=m;this.Yd="写下你的评论…";this.placeholder='<p style="color:#999">'+this.Yd+"</p>";this.Pl="";this.da=-1;this.sF=$.Deferred().resolve();this.Xy=this.Bs=l;this.cC="zm-comment-box";this.rh=l;(b=Nv[c])||f(Error("API not found"));this.vg=$.extend({},Nv._default_,b);this.mn="";J.extend(this.D={},this.defaults,d||{})};A(bw,U);
a.cw=function(b,c){return Km(b,function(){return{oa:{question:"question_comment_"+c,answer:"question_answer_comment_"+c}[this.type]||j,ed:j}},p("mn"))};t=bw.prototype;t.defaults={pF:m,autofocus:j,Tv:"empty",lf:"zm-item-comment"};t.Z=function(b){bw.n.Z.call(this,b);dw(this);ew(this);this.vd=j;B.forEach(fw(this),this.Rs,this)};a.gw=function(b,c,d){var e=L(b.cC,c);d&&(b.rh=d);e?b.o(e):(b.Zg=j,b.W(c))};t.WJ="zm-comment-bubble";t.AB="."+bw.prototype.WJ;t.lu=function(b){return $(b,this.g)};
t.v=function(){this.g=M("div",{"class":this.cC,style:"display:none"});this.Ze()};t.Pi=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');t.w=function(){bw.n.w.call(this);this.field=this.gC=this.ln=this.sB=this.rh=this.Xy=this.qF=l};
a.hw=function(b){var c=b.il,d=c.h();if(c.ul()!==b.placeholder){c.Cd(m,b.placeholder);var e=["click","focus","keydown"],g=function(){c.Cd(m,this.Pl||"");this.field.lastChild?Zr(this.field.lastChild):c.Qf();xd(d,e,g,m,this)};P(d,e,g,m,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&sc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};t.es=function(b){(b=b.h&&b.h())&&(new Wv({pE:{image:w}})).o(b)};
t.ds=function(b,c){if(b.h){var d=(new Ul).add("type",this.type+"_comment").add("resource_id",this.id),e=b.h();this.NX=d=new lp(e,{Nm:{source:"/people/autocomplete?"+d.toString()},Vj:L("zu-main")||document.body});new hp(e,{jz:np});pa(c)&&c(d)}};
t.ES=cw(function(b){var c=L("zm-comment-content-wrap",b),d=L("zm-comment-form",b),e=b.getAttribute("data-id"),g=this,h;if(d){h=L("zm-comment-editable",d);if(rg(d)){if(us(d))return S(d,m)}else S(d,j);iw(h)}else{(b=L("zm-comment-reply-hack"))?(b=fc(Vr(b)),H.Gu(b,"zm-comment-reply-hack","zm-comment-reply-hacked"),kc(b,c)):(b="",T.oa()&&(b='<img class="avatar" src="'+T.gM()+'">'),b=fc('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+b+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>'),
c.appendChild(b));d=b;h=L("zm-comment-editable",d);var k=new Iv(h);k.Cd(m,"");k.De();this.ds(k,function(){iw(h)});this.es(k);c=L("zm-comment-close",d);b=L("zm-comment-submit",d);b.name="";var n=function(){var b=Ma(k.ul()),c=Ma(Fc(h));b&&c?jw(g,{content:b,PR:e},function(b){b.r||(S(d,m),k.Cd(m,""),(b=B.Wd(fw(g)))&&Hs(b,{offsetTop:100,xB:j}))}):(V("请填写内容"),h.focus())};P(c,"click",function(){S(d,m)});P(b,"click",n);P(h,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))n(),b.preventDefault()})}Hs(d,
100)},"reply");a.iw=function(b){b.focus();b=Hn(b);b.collapse();b.select()},a.ew=function(b){var c=location.hash.slice(1).split("-"),d="comment"===c[0]&&c[1];d&&(b=B.find(fw(b),function(b){return b.getAttribute("data-id")===d}),Qk(b),Hs(b))},a.fw=function(b){return $(b.ln).children(".zm-item-comment").get()};t.Gt=function(b){H.enable(this.gC,"expanded",b)};t.ti=function(b,c){this.dispatchEvent(new Pv("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:oa(c)?c:this.Oa()}))};
t.jj=function(){this.vd?kw(this):this.Zg=j};t.dQ=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.bq(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&lw(this)};
t.ta=function(b){var c=Wk(this.g,b.target,"BUTTON")||Wk(this.g,b.target);if(c&&c.name){var d=Ic(c,l,this.D.lf);b.preventDefault();switch(c.name){case "reply_comment":this.ES(d);break;case "cancelanon":b=$(this.g).parents(".feed-item-hook").data("qid");ds(0,l,b);break;case "delcomment":this.Br(c);break;case "like_comment":this.aN(c);break;case "author_delcomment":var e=Ic(c,l,this.D.lf),g=e.getAttribute("data-id"),b="你确定要删除这条评论吗？";if(c=$(".zm-item-link-avatar",e).prop("href"))b+='<p class="js-block" style="margin-top:.2em;color:#999;visibility:hidden"><label><input type="checkbox">同时将此人屏蔽</label></p>',
$.get(c+"/block",function(b){!b.r&&!b.msg&&$(".js-block",h.h()).css("visibility","visible")});var h=Ei("删除评论",b,function(b){if(b){var b=$(":checkbox",h.h()).prop("checked"),c=xa(N,e);this.vg.aK(g,Number(b)).done(y(function(){pa(c)&&c();this.da-=1;mw(this)},this))}},this);break;case "admin_delcomment":var k=Ic(c,l,this.D.lf);(new Qv).open(c,{id:k.getAttribute("data-id"),type:"comment"},y(function(){N(k);this.da-=1;mw(this)},this));break;case "closeform":lw(this);break;case "addnew":this.bq();break;
case "load-more":this.ti("comments_all"),this.qF(c)}}};
t.qF=function(b){this.Bs&&"pending"===this.Bs.state()||(b&&H.add(b,"loading"),this.Bs=this.Xy||this.rF(),this.Bs.done(y(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=fw(this);d.length&&(c=B.filter(c,function(b){return!B.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=B.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),B.forEach(c,this.Rs,this),b&&N(b));hc(this.ln,c)}},this)))};
t.aN=cw(function(b){var c=$(b),d=Ic(b,l,this.D.lf),b=$(".like-num",d),e=d.getAttribute("data-id");(d=!c.hasClass("liked"))&&this.ti("like_comment");this.vg.Yx(e,d);var e=$("em",b),g=+e.text()+(d?1:-1);b.toggleClass("liked",d).toggleClass("nil",0>=g).attr("data-tip","s$r$"+g+" 人觉得这个很赞");e.text(g);c.toggleClass("liked",d);Ik(c[0],d?"取消赞":"赞")},"like");a.lw=function(b){0<b.Oa()?(b.Pl=b.bb(),b.Gt(m),hw(b)):b.rh?b.collapse():b.Gt();b.Hf()};t.expand=function(){this.Na(j)};t.collapse=function(){this.Na(m)};
t.Gc=p("vd");t.Na=function(b){if(b!==this.vd){b&&(this.lu(this.AB).hide(),this.Ze());this.vd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");S(this.g,this.vd);var c=y(function(){b&&nw(this);this.dispatchEvent(b?"expand":"collapse");this.rl&&!b&&(dp(this.rl),Hs(this.rl.g))},this),d;b&&this.Zg?(d=kw(this))&&d.done(c):setTimeout(c);this.rh&&(b?(this.WQ=Fc(this.rh),Ik(this.rh,"收起评论")):Ik(this.rh,0>this.da?this.WQ:this.da?this.da+" 条评论":"添加评论"))}};t.yf=function(){this.Na(!this.vd)};
a.nw=function(b){if(b.rh){var c=$(b.rh);b.lu(b.AB).show().css("left",c.position().left+c.width()/2)}},a.kw=function(b){if("pending"!==b.sF.state()){b.ib();b.g.innerHTML=b.Pi();b.expand();var c=b.vg.vl(b.id,b.D.pF).done(y(b.IR,b));return b.sF=c}};t.rF=function(){return this.vg.wl(this.id)};t.zt=da("mn");a.ow=function(b,c,d){var c=$(c),e=$(d);d?($(".zm-command, .zm-comment-info",b.g).hide(),$(b.field).hide().after(e).after(c)):c.insertAfter(b.field);b=y(cw(w,"box"),b);c.on("click",b);e.on("click",b)};
t.IR=function(b){b=fc(Ma(b));S(b,this.vd);B.forEach($("."+this.D.lf,b).get(),this.Rs,this);this.Zg=m;this.ib();mc(b,this.g);this.g=b;dw(this)};
a.dw=function(b){J.forEach({sB:".load-more",ln:".zm-comment-list",gC:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.g)[0]},b);b.field&&b.field.setAttribute("aria-label",b.Yd);if(Tg){var c=b.field;c.setAttribute("contentEditable",j);var d=b.il={h:function(){return c},ul:function(){return bl(c)?"":c.innerHTML},Cd:function(b,d){c.innerHTML=d},Qf:function(){Rs(c)}};b.ds(d);b.es(d)}else{var e=M("textarea",{placeholder:b.Yd,"class":"zm-comment-textarea"});mc(e,b.field);
new Sm(e,22);b.field=e;b.il={h:function(){return e},ul:function(){return e.value},Cd:function(){e.value="";e.style.height=$f(22,j)},Qf:function(){e.focus()}}}b.m().e(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.Pl=Ss(this.field)?"":this.bb())});T.oa()?T.Hi||ow(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>'):ow(b,'<div class="signin-mask-tip-comment"></div>',
l);hw(b);b.m().e(b.g,"click",b.ta).e(b.field,"keydown",b.dQ).e(Ni,"anon_change",b.jj).e(b.il.h(),["click","focus"],xa(b.Gt,j)).e(b.il.h(),"focus",xa(b.ti,"add_comment_start"));b.da=Number(b.g.getAttribute("data-count"));$(b.g).on("focusin focusout","."+b.D.lf,function(b){$(this).toggleClass("focusin","focusin"===b.type)});!sb&&b.sB&&(b.Xy=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.rF,b)));mw(b);nw(b)},a.mw=function(b){var c=b.D,d=!b.Oa();H.enable(b.g,c.Tv,d);d&&b.field&&
c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.bb=function(){var b=Ma(this.il.ul());return b===this.placeholder?"":b};t.bq=function(){var b=this.bb(),c=Ma(Fc(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?jw(this,b):(V("请填写内容"),this.field.focus())};t.Oa=p("da");
a.jw=function(b,c,d){if(!(b.em&&"pending"===b.em.state())){var e;qa(c)&&(e=c.PR,c=c.content);var c=Pa(c),g=new Od;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.vg.add(g.Xt());c.done($.proxy(b.qM,b)).done(d);b.em=c;b.Pl=b.bb();b.ti("add_comment_submit")}};t.qM=function(b){if(b.r)return Fi("提示信息",b.msg);this.vg.Fw(b.msg).done($.proxy(this.JR,this));this.il.Cd("");hw(this);this.Gt(m)};
t.Rs=function(b){if(rh("auth_f_manage")&&!("favlist"===this.type||$(".del, .op.remove",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link op needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft, .actions",b))}this.wj(b)};
t.wj=function(b){var c=$("a[name=report]",b);c.length&&(b=b.getAttribute("data-id"),b=new ju("comment",b,{post:"article_comment_report",question:"question_comment_report",answer:"question_answer_comment_report"}[this.type]),mu(b,c[0]),Rc(b,this))};t.JR=function(b){this.Pl="";b=fc(b);this.ln.appendChild(b);this.Rs(b);this.da+=1;mw(this)};
t.Br=function(b){var c=Ic(b,l,this.D.lf),d=c.getAttribute("data-id");Ei("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(N,c);this.vg.remove(d).done(y(function(){pa(g)&&g();this.da-=1;mw(this)},this))}},this)};t.Ze=function(){$(window).on("beforeunload.CommentForm",y(function(){if(this.Pl)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Hf=function(){$(window).off("beforeunload.CommentForm")};
a.pw=function(b){if(!b.rl&&!eh.tc){var c=Ic(b.g,l,"zm-item-meta");if(c){var d=L("zm-meta-panel",c);d&&(b.rl=new fp(l,c),b.rl.hg="comment",b.rl.o(d))}}};a.qw=function(b){U.call(this);this.entryType=b};A(qw,U);a.rw=function(b,c){return Km(b,c,function(){return this.Gn()})};t=qw.prototype;t.ew="zm-item-expanded";t.Gs="zm-item-meta";t.Fj=l;
t.z=function(){qw.n.z.call(this);var b=$(this.g),c={};$("meta[itemprop]",b).each(function(){var b=$(this);c[b.attr("itemprop")]=b.attr("content")});this.hb=c[this.entryType+"-id"];this.Nh=c[this.entryType+"-url-token"];this.hr=c;this.Xm();this.ie();var b=$('.js-report, a[name="report"]',this.h()),d=this.entryType,e=this.hb;b.each(function(b,c){var k=$(c),n=new ju(d,e);k.hasClass("goog-menuitem")?k.click(function(){n.AH()}):(mu(n,c),Rc(n,this))})};
t.Gn=function(){var b=this.entryType+"-"+this.hb;return $('a[name="'+b+'"]',this.g).length&&"#"+b};
t.Xm=function(b){var c={'a[name="expand"]':function(b){this.Na(j);this.jo&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Na(m)},'a[name="toggleExpanded"]':this.yf,'a[name="ignore"]':this.Fr,".js-close":this.dE,".js-collect":this.kj,".js-hiderelated":this.cE,".js-share":this.sc,".js-toggle-commentbox":this.iE,".js-unhide":this.mE,'a[name="dislike"]':this.PD};J.extend(c,b||{});J.forEach(c,function(b,c){if(pa(b))$(this.g).on("click",c,$.proxy(b,this))},this);var d=$(".zm-meta-panel",
this.g);J.forEach({'a[name="toggle-comment"]':function(b){this.iE(b);d.toggleClass("focusin",this.ma.Gc())},'a[name="share"]':this.sc},function(b,c){d.on("click",c,$.proxy(b,this))},this)};t.iE=function(b){this.zp();this.ma.Gc()&&(b=parseInt(Fc(b.currentTarget),10)||0,this.ma.ti("view_comments",b))};t.fy=function(){Hu(this.entryType,this.Nh,"read")};t.Lj=function(){Hu(this.entryType,this.Nh,"touch")};t.Gc=function(){return H.has(this.g,this.ew)};t.yf=function(){this.Na(!this.Gc())};
t.Na=function(b){if(b===this.Gc())return m;b&&vt(this.g).height<Yb().height&&1<$("a.collapse",this.g).length&&$("a.collapse",this.g).eq(0).remove();H.enable(this.g,this.ew,b);this.dispatchEvent(b?"expand":"collapse");return j};t.NQ=function(){window.open(L(this.Fj,this.g).href)};t.dE=function(){$(this.g).fadeOut(150,function(){$(this).remove()})};t.kj=w;t.Fr=w;t.mE=w;t.cE=w;t.sc=rw(function(){Du(arguments,"tb-webshare-sina")},{oa:"question_answer_share"});
t.PD=function(){var b=$(this.g),c=$(".feed-item-inner",b),d=$(".undo-dislike-options",b),e={block_id:b.data("block"),offset:b.data("offset")};d.off().one("click",".revert",function(){c.slideDown();d.slideUp();$.post("/topstory/item/uninterest/revert",e)}).one("click",".close",function(){b.slideUp(function(){b.remove()})});$.post("/topstory/item/uninterest",e).done(function(){c.slideUp();d.slideDown()})};
t.zp=function(){if(!this.ma){var b=$(".toggle-comment",this.g)[0];this.ma=new bw(this.hb,this.entryType);this.H(this.ma);gw(this.ma,L(this.Gs,this.g),b);pw(this.ma);this.ma.zt(this.Gn())}this.ma.yf()};t.Xw=function(){this.ma?this.ma.field.focus():this.zp()};t.ie=function(){this.fg=Hk.zI(this.g);Gk(this.fg.register("shift+o",this.NQ,this),{group:"操作",name:"新窗口打开条目"});var b=$('a[name="dislike"], a[name="ignore"]',this.g);b.length&&Gk(this.fg.register("i g",function(){b.click()}),{group:"操作",name:"不感兴趣"})};a.tw=function(b,c){this.uo=this.td=1;this.$g=c||4;this.items=b||[];this.VB=[];sw(this)};
tw.prototype={Ic:function(b){if(b)this.VB.push(b);else{var c={current:this.td,Rn:this.Rn(),Mr:this.Mr()};B.forEach(this.VB,function(b){setTimeout(function(){b.call(l,c)})})}},remove:function(b){b=this.items.indexOf(b);-1!==b&&(this.items.splice(b,1),sw(this),this.Ic());return b},Rn:function(){return this.td<this.uo},Mr:function(){return 1!==this.td},next:function(){this.Rn()&&(this.td+=1,this.Ic())},prev:function(){this.Mr()&&(this.td-=1,this.Ic())},random:function(b){if(this.uo>=2*this.$g){for(var c=
[],d=1;d<this.uo+1;d++)c.push(d);0!==b&&B.remove(c,this.td);0!==this.items.length%this.$g&&B.remove(c,this.uo);this.td=c[Math.floor(Math.random()*c.length)]}else b===this.$g&&this.items.reverse(),this.td=1;this.Ic();return this.items.length>this.$g}};a.uw=function(b,c,d){c=(c-1)*b.$g;return b.items.slice(c,c+d)},a.sw=function(b){b.uo=Math.ceil(b.items.length/b.$g)};a.vw=function(b){qw.call(this,b)};A(vw,qw);
vw.prototype.z=function(){vw.n.z.call(this);var b=$(this.h()),c=$(".js-list",b);$(".js-hidden-list",b);var d=$(".pager",b),e=$.makeArray($("<div>").html($(".js-hidden-list").html()).children().add(c.children())),g=this.cY=new tw(e,4);g.Ic(function(b){d.find(".next").toggleClass("disabled",!b.Rn);d.find(".prev").toggleClass("disabled",!b.Mr)});$(".pager",b).on("click",".next:not(.disabled)",function(){g.next();c.html(uw(g,g.td,g.$g))}).on("click",".prev:not(.disabled)",function(){g.prev();c.html(uw(g,
g.td,g.$g))});b.on("click","[data-follow]",function(b){var c=$(b.target).closest(".item"),d;var e=c[0],b=uw(g,g.td+1,1)[0];g.Rn()&&b?(e=g.remove(e),g.remove(b),g.items.splice(e,0,b),d=b):d=i;d&&c.fadeOut(function(){c.replaceWith(d)})})};vw.prototype.PD=function(){var b=this,c=$(this.g);$.post("/actioncard/uninterest",{type:"suggest_topics"},function(){c.slideUp(function(){b.F();c.remove()})})};a.ww=function(b){qw.call(this,b)};A(ww,qw);ww.prototype.Fj="question_link";ww.prototype.Fr=function(){var b=this.hr["question-id"];this.dispatchEvent({type:"ignore",key:"question-id",value:b});$.post("/question/uninterest",{qid:b})};a.xw=function(){qw.call(this,"question")};A(xw,ww);xw.prototype.z=function(){xw.n.z.call(this);Kt(this.g,function(){Hu("question",this.Nh,"touch")},this)};xw.prototype.sc=function(){xw.n.sc.call(this,"分享问题","question",this.Nh,{qid:this.hb})};
xw.prototype.ie=function(){xw.n.ie.call(this);Gk(Gk(Gk(this.fg.register("c",this.zp,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("shift+c",this.Xw,this),{group:"操作",name:"定位到评论框"})};a.yw=function(){qw.call(this,"answer")};A(yw,ww);a.zw=function(b){return L("zm-item-answer",b)||L("entry-body",b)};t=yw.prototype;t.z=function(){yw.n.z.call(this);this.yB=zw(this.g);this.jo=this.yB.getAttribute("data-isowner");this.vx();this.Ml()};t.sc=w;
t.Na=function(b){yw.n.Na.call(this,b)&&(b||(gt(this.ug.h()),Aw(this,m)),b&&this.Ml(),this.ug.Ez(b),this.ug.Ot.Na(b))};t.vx=function(){var b=L("zm-item-answer-author-wrap",this.g);b&&(b=L("zm-list-avatar",b),ok.add(b))};t.Ml=function(){this.ug=new Bw(this.hr["question-id"],{ob:this.hr["question-url-token"]},this.hb);var b=L("zm-item-meta",this.g);this.ug.Hc=b;this.H(this.ug);this.ug.o(this.yB);b=this.ug.Ot;this.m().e(b,"expand",function(){this.Na(j)});this.Ml=w};
t.ie=function(){yw.n.ie.call(this);Gk(this.fg.register("o",this.yf,this),{group:"操作",name:"显示全部/收起"})};t.Xm=function(){yw.n.Xm.call(this,{"a[name=expandQuestionDetail]":function(){Aw(this,j)}})};a.Aw=function(b,c){$(".feed-question-detail-item",b.g).toggleClass("question-detail-expanded",c)};a.Cw=function(){qw.call(this,"column")};A(Cw,qw);Cw.prototype.z=function(){Cw.n.z.call(this);var b=L("column",this.g);Kt(b,this.Lj,this)};Cw.prototype.Lj=function(){Hu("column",this.Nh,"touch")};a.Dw={EA:function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},MD:function(b){return $.get("/node/ColumnPostVoteInfoV2",{params:{post_id:b}})}};a.Ew=function(b,c,d){U.call(this);this.hb=b;this.entryType=c||"answer";this.ud=l;this.D=$.extend({},this.defaults,d||{})};A(Ew,U);a.Fw={ge:1,sg:-1,ZA:0};Ew.prototype.defaults={CT:"up",AL:"down",aL:"count",ct:"pressed"};J.extend(Ew.prototype,Fw);t=Ew.prototype;t.V=Fw.ZA;
t.o=function(b){Ew.n.o.call(this,b);var c=this.D,b=this.G=$(b);this.uu=$("."+c.CT,b);this.ou=$("."+c.AL,b);this.HA=$("."+c.aL,b);c=this.uu.hasClass(this.D.ct);b=this.ou.hasClass(this.D.ct);c?this.V=Fw.ge:b&&(this.V=Fw.sg);Gw(this);this.uu.click($.proxy(this.Zt,this));this.ou.click($.proxy(this.Yt,this));return this};t.Rd=p("V");
t.Zb=Km(function(b){if(b!==this.V&&J.yg(Fw,b)){this.dispatchEvent({type:"action",data:{state:b}});this.ud&&"pending"===this.ud.state()&&this.ud.abort();var c=this.V,d=+this.HA.text(),e=0;b===Fw.ge?e=1:c===Fw.ge&&(e=-1);this.HA.text(d+e);this.V=b;Gw(this);b={};b[Fw.ge]="vote_up";b[Fw.sg]="vote_down";b[Fw.ZA]="vote_neutral";this.ud=("post"===this.entryType?Dw.EA:pt.EA)(this.hb,b[this.V]);this.ud.done(y(function(b){b.r||this.Ic()},this))}},function(b){var c={};c[Fw.ge]="question_answer_vote_up";c[Fw.sg]=
"question_answer_vote_down";return{oa:c[b],ed:j}});t.tT=function(b){b===Fw.ge?$k("vote","voteup","side_vote"):b===Fw.sg&&$k("vote","votedown","side_vote")};t.Zt=function(){this.Zb(this.V===Fw.sg?Fw.ge:this.V^Fw.ge)};t.Yt=function(){this.Zb(this.V===Fw.ge?Fw.sg:this.V^Fw.sg)};
a.Gw=function(b){var c=b.V,d=b.D,e=c===Fw.ge,c=c===Fw.sg,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.uu.toggleClass(d.ct,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.ou.toggleClass(d.ct,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Ic=function(){this.dispatchEvent("change")};a.Hw=function(b){U.call(this);this.Lp="votebar-mobile";this.Mv="votebar-mobile-dialog";this.FA=b;this.uI=M("span","_votebar-holder")};A(Hw,U);Hw.prototype.Z=function(b){Hw.n.Z.call(this,b);this.m().e(b,"click",this.QQ)};Hw.prototype.uL=function(){var b=this.FA;mc(b.h(),this.uI);H.remove(b.h(),this.Lp)};Hw.prototype.RO='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
Hw.prototype.QQ=Km(function(){this.qb&&this.qb.F();var b=new Ai(l,m);b.Cg=j;b.rm(j);b.rD=j;var c=this.FA;mc(this.uI,c.h());H.add(c.h(),this.Lp);this.m().e(c,"action",function(){this.qb&&setTimeout(y(function(){this.qb.C(m)},this),150)});oe(this.m(),b,"hide",this.uL);c=b.R();c.appendChild(this.FA.h());c.appendChild(fc(this.RO));H.add(b.h(),this.Mv);b.C(j);this.qb=b;Rc(this,b)},j);a.Iw=function(){qw.call(this,"post")};A(Iw,qw);t=Iw.prototype;t.Fj="post-link";
t.z=function(){Iw.n.z.call(this);var b=this.Ot=new Lt;this.H(b);Rc(this,b);this.m().e(b,"expand",function(){this.Na(j)});b.o(this.g);b.Cc()&&oe(this.m(),b,"expand",this.fy);Kt(this.g,this.Lj,this);if(b=L("zm-votebar",this.g))this.lb=new Ew(this.hb,this.entryType),Rc(this,this.lb),this.lb.o(b),(b=L("votenum-mobile",this.g))&&(new Hw(this.lb)).o(b);if(b=L("zm-item-vote-info",this.g)){var c=this.DY=new Jw(this.hb,this.entryType);Rc(this,c);c.o(b);this.lb&&this.m().e(this.lb,"change",function(){c.ck()}).e(c,
"change",function(){var b=L("zm-item-vote-count",this.g),e=$(".zm-votebar .count",this.g)[0];b&&Ik(b,c.Oa());e&&Ik(e,c.Oa())})}};t.sc=function(){Iw.n.sc.call(this,"分享文章","post",this.hb,{post_id:this.hb})};t.Na=function(b){Iw.n.Na.call(this,b)&&(b||gt($(".entry-body",this.g)[0]),this.Ot.Na(b),this.Ez(b))};t.Ez=function(b){var c=this.xj();c&&cp(c,b)};
t.xj=function(){if(this.th)return this.th;var b=!sb,c=L("zm-editable-content",this.g),d=this.lb&&this.lb.h();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.th=new fp(l,c),this.H(b),b.hg="votebar",b.Py=50,b.o(d))};t.Fr=function(){$(".feed-hide-options",this.g).show().siblings().hide();$.post(Ht("/post/uninterest"),{id:this.hb})};t.mE=function(){$(".feed-hide-options",this.g).hide().siblings().show();$.post(Ht("/post/undo_uninterest"),{id:this.hb})};
t.cE=function(b){var b=$(b.currentTarget),c=b.data();Ei(b.attr("title"),Ht("确定%s吗？",b.text()),function(b){b&&(this.dE(),$.post(Ht("/%s/uninterest",c.type),{id:c.id}))},this)};
t.ie=function(){Iw.n.ie.call(this);Gk(this.fg.register("v",function(){this.lb&&this.lb.Zt()},this),{group:"操作",name:"赞同"});Gk(this.fg.register("d",function(){this.lb&&this.lb.Yt()},this),{group:"操作",name:"反对"});Gk(Gk(Gk(Gk(this.fg.register("o",this.yf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.zp,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("shift+c",this.Xw,this),{group:"操作",name:"定位到评论框"})};a.Kw=function(){qw.call(this,"roundtable")};A(Kw,qw);t=Kw.prototype;t.z=function(){Kw.n.z.call(this);this.Zn()};t.Fj="roundtable_link";t.Fr=function(){$.post("/roundtable/"+this.Nh,{action:"mute"});this.dispatchEvent({type:"ignore",key:"roundtable-id",value:this.hb})};t.Zn=function(){Kt(this.g,this.Lj,this)};t.Lj=function(){Hu("roundtable",this.Nh,"touch")};a.Lw=function(b){var c=b.getAttribute("data-type");return(c={ac:vw,p:Iw,a:yw,q:xw,r:Kw,c:Cw}[c])?new c:zw(b)?new yw:new U};a.Mw=function(b,c,d){pu.call(this,b,c,d)};A(Mw,pu);Mw.prototype.Rj=function(b){var c=Lw(b);this.H(c);c.o(b);c instanceof yw&&c.Na(m)};a.Nw=function(){O.call(this);this.ba=l;this.ga=0;this.Zx=[];this.xs=[];this.mA="最多输入 20 字";this.Kv="最多输入 256 字"};A(Nw,Lm);ia(Nw);t=Nw.prototype;
t.v=function(){this.zL=j;this.g=M("div",l,[this.UO=M("div",l,[this.Qg=M("div","zm-favo-list-content"),this.nB=M("div","zh-favo-add-new-wrap zm-command",this.RS=M("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.ov=M("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.Fu=M("div","zh-favo-add-new-wrap zm-command",this.MK=M("a",{href:"javascript:;","class":""},"取消"),this.SS=M("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.tw=
M("div",{style:"display:none"},[M("div",l,["标题",this.lA=M("span",{"class":"zh-favo-add-title-error"},"请填写标题")]),M("div","zg-section",this.Gj=M("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),M("div",l,"描述（可选）"),M("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.Ql=M("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.rR=M("label",l,[this.GO=M("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),M("strong",l," 公开 "),M("span","zg-gray-normal",
"公开后不能设置为私密")]),this.PO=M("br"),this.nR=M("label",l,[this.FO=M("input",{type:"radio",value:"private",name:"mode"}),M("strong",l," 私密 "),M("span","zg-gray-normal","只有你可以查看这个收藏夹")]),M("div","zm-command",[this.Yz=M("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.Gq=M("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.lB=M("a",{"class":"zg-btn-blue"},"确认创建")])])]);S(this.lA,m);S(this.Fu,m);(new gn(this.mA)).o(this.Gj);(new gn(this.Kv)).o(this.Ql);B.forEach(this.Zx,function(b){Ow(this,b)},this);
this.Zx.length||(this.Qg.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',S(this.Fu,j),S(this.nB,m));Pw(this);this.ba.R().innerHTML="";this.ba.R().appendChild(this.g);this.ba.X()};
a.Pw=function(b,c,d){b.ba||(b.ba=new Ai(l,m),ii(b.ba,l),b.ba.Ta(c||""),d&&(b.ba.R().innerHTML=d),b.m().e(b.ba,"afterhide",b.Hf))},a.Ow=function(b,c,d){var e=K("zh-fav-list-item-place-holder");e&&S(e,m);b.Yy=c[5]?"":M("span","zm-fav-list-item-lock",[M("i","icon icon-lock")]);e=M("span","zm-favo-list-item-title");xc(e,c[1]);e=M("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Yy,e,M("span",{className:"meta zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+
c[4]+" 人关注"})]);b.Yy&&b.Yy.setAttribute("data-tip","s$t$私密收藏夹");e.setAttribute("data-lid",c[0]);B.contains(b.xs,c[0])&&H.add(e,"zm-favo-list-item-link-active");c=L("zm-favo-list-item-link",b.Qg);d&&c?jc(e,c):b.Qg.appendChild(e)};
t.pb=function(){this.oK||(this.oK=j,this.m().e(this.Yz,"click",function(){this.ga?Qw(this,0):Rw(this)}).e(this.RS,"click",function(){X.ha({type:"ga_click_add_collection"});Qw(this,1)}).e(this.ov,"click",function(){Rw(this)}).e(this.SS,"click",function(){X.ha({type:"ga_click_add_collection"});Qw(this,1)}).e(this.MK,"click",function(){Rw(this)}).e(this.Gq,"click",function(){Rw(this)}).e(this.lB,"click",this.Xg).e(this.Qg,"click",this.tQ).e(this.Gj,"change",function(){S(this.lA,m)}))};
t.tQ=function(b){var c=Ic(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=m;H.has(c,"zm-favo-list-item-link-active")?(d=j,this.yC=b):this.uC=b;c=new Xk;c.add("answer_id",this.ga);c.add("favlist_id",b);this.uz=new W(j);this.locked=j;oe(this.m(),this.uz,"complete",this.IJ);this.uz.ajax(d?"/collection/remove":"/collection/add",c.hd())}};
t.IJ=function(){this.locked=m;this.ov.innerHTML="关闭";var b=Je(this.uz);b&&!b.r?(b=Vb("zm-favo-list-item-link",this.Qg),B.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=L("num",b),g=parseInt(e.innerHTML,10);d===this.yC?(e.innerHTML=g-1+"",H.remove(b,"zm-favo-list-item-link-active")):d===this.uC&&(e.innerHTML=g+1+"",H.add(b,"zm-favo-list-item-link-active"))},this),this.uC=this.yC=l,$k("Favorite","add_favorite")):V("添加失败: "+b.msg)};
a.Sw=function(b,c){if(b.ga!==c&&b.Qg){var d=Vb("zm-favo-list-item-link",b.Qg);B.forEach(d,function(b){H.remove(b,"zm-favo-list-item-link-active")},b)}b.ga=c};t.Sj=function(){this.pb();this.ov.innerHTML="关闭";this.ga?(S(this.Gq,m),Qw(this,0)):(Qw(this,1),S(this.Yz,m),this.Gq.innerHTML="取消")};t.show=function(b){b?(Tw(this),this.ba.C(j),this.Sj()):(Pw(this,"添加到收藏夹",'<div style="text-align: center; color: #999;">收藏夹加载中<i class="spinner-gray"></i></div>'),this.ba.C(j),this.wr())};
a.Vw=function(b,c,d,e){var g=K("zh-fav-head-title"),h=K("zh-fav-head-description-source"),c=c||(g?Fc(g):""),d=d||(h?Fc(h):"");b.xC=e||lh;Tw(b);b.pb();Qw(b,1);S(b.Yz,m);b.Gq.innerHTML="取消";b.lB.innerHTML="保存";b.ba.Ta("编辑收藏夹");b.Gj.value=Za(c);b.Ql.value=Za(d);b.xC[1]?(S(b.rR,m),S(b.nR,m),S(b.PO,m)):b.FO.setAttribute("checked",j);b.eO=Uw(b);b.ba.C(j);b.ls=j};t.wr=function(){this.ga&&$.get("/collections/json",{answer_id:this.ga}).done(y(this.jQ,this))};
a.Tw=function(b){if(b.zL){var c=Vb("zm-favo-list-item-link",b.Qg);B.forEach(c,function(b){var c=b.getAttribute("data-lid");H.remove(b,"zm-favo-list-item-link-active");B.contains(this.xs,+c)&&H.add(b,"zm-favo-list-item-link-active")},b)}else b.v()};t.jQ=function(b){b&&!b.r&&(this.Zx=b.msg[0],this.xs=b.msg[1],Tw(this),this.Sj())};
a.Qw=function(b,c){var d=!!c;b.ba.Ta(0===c?"添加到收藏夹":"创建新收藏夹");S(b.UO,!d);S(b.tw,d);new pm(b.Gj,b.mA);new pm(b.Ql,b.Kv);if(1===c)$(b.tw).on("change.FavoDiag","input, textarea, select",function(){b.Ze()});else $(b.tw).off("change.FavoDiag"),b.Hf()},a.Uw=function(b){var c=new Xk,d=Lk(b.Gj.value),e=Wa(b.Ql.value===b.Kv?"":b.Ql.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.GO.checked?1:0);return c};
t.Xg=function(){if(!this.xhr||!this.xhr.Fb()){var b=Lk(this.Gj.value);if(!b||b===this.mA)S(this.lA,j);else{b=Uw(this);this.ga&&b.add("answer_id",this.ga);if(this.ls){if(this.eO.hd()===b.hd()){Rw(this);return}b.add("favlist_id",this.xC[0])}this.xhr=new W(j);oe(this.m(),this.xhr,"complete",this.AJ);this.xhr.ajax(this.ls?"/collection/update":"/collection/create",b.hd())}}};
t.AJ=function(){var b=Je(this.xhr);b&&!b.r?this.ls?(Rw(this),V("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.ls=m):this.ga?(S(this.Fu,m),S(this.nB,j),Qw(this,0),this.xs.push(b.msg[0]),Ow(this,b.msg,j),this.Gj.value="",this.Ql.value=""):(Rw(this),V("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):V(b.msg)};t.P=function(){return this.ba.P()};
a.Rw=function(b){b.ba.C(m);b.dispatchEvent(Ww);X.ha({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.Qg).length}})},a.Ww="close";Nw.prototype.Ze=function(){$(window).on("beforeunload.FavoDiag",y(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};Nw.prototype.Hf=function(){$(window).off("beforeunload.FavoDiag")};a.Xw=function(b){var c=b.type;if(!ka(c))return l;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:l;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:l;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:l;default:return ka(b.value)?b.value:l}},a.Yw=function(b,c){var d=b.elements[c];if(d.type)return Xw(d);for(var e=0;e<d.length;e++){var g=Xw(d[e]);if(g)return g}return l};a.Zw=function(b){O.call(this);this.g=b;b=qa(this.g)&&1==this.g.nodeType?this.g:this.g?this.g.body:l;this.IO=!!b&&fg(b);this.mF=P(this.g,D?"DOMMouseScroll":"mousewheel",this)};A(Zw,Gd);
Zw.prototype.handleEvent=function(b){var c=0,d=0,e=0,b=b.Vb;if("mousewheel"==b.type){d=1;if(C||E&&(lb||G("532.0")))d=40;e=$w(-b.wheelDelta,d);ka(b.wheelDeltaX)?(c=$w(-b.wheelDeltaX,d),d=$w(-b.wheelDeltaY,d)):d=e}else e=b.detail,100<e?e=3:-100>e&&(e=-3),ka(b.axis)&&b.axis===b.HORIZONTAL_AXIS?c=e:d=e;oa(this.AF)&&(c=yt(c,-this.AF,this.AF));oa(this.BF)&&(d=yt(d,-this.BF,this.BF));this.IO&&(c=-c);c=new ax(e,b,c,d);this.dispatchEvent(c)};a.$w=function(b,c){return E&&(kb||mb)&&0!=b%c?b:b/c};
Zw.prototype.w=function(){Zw.n.w.call(this);zd(this.mF);delete this.mF};a.ax=function(b,c,d,e){c&&this.init(c,i);this.type="mousewheel";this.detail=b;this.Ti=d;this.Ui=e};A(ax,kd);a.bx=function(){O.call(this)};A(bx,Gd);t=bx.prototype;t.be=0;t.yo=0;t.vo=100;t.ol=0;t.nk=1;t.RE=m;t.Js=m;t.Ba=function(b){b=cx(this,b);this.be!=b&&(this.be=b+this.ol>this.vo?this.vo-this.ol:b<this.yo?this.yo:b,!this.RE&&!this.Js&&this.dispatchEvent("change"))};t.S=function(){return cx(this,this.be)};t.bp=function(b){b=cx(this,b);this.ol!=b&&(this.ol=0>b?0:this.be+b>this.vo?this.vo-this.be:b,!this.RE&&!this.Js&&this.dispatchEvent("change"))};
t.Sh=function(){return this.nk==l?this.ol:Math.round(this.ol/this.nk)*this.nk};t.Dc=function(){return cx(this,this.yo)};t.Uc=function(){return cx(this,this.vo)};t.Kw=p("nk");a.cx=function(b,c){return b.nk==l?c:b.yo+Math.round((c-b.yo)/b.nk)*b.nk};a.dx=function(b){U.call(this,b);this.pB=l;this.Sa=new bx;P(this.Sa,"change",this.bE,m,this)};A(dx,U);a.ex=Fd("dragvaluestart"),a.fx=Fd("dragvalueend"),a.gx=Fd("dragextentstart"),a.hx=Fd("dragextentend"),a.ix=Fd("dragstart"),a.jx=Fd("dragend");t=dx.prototype;t.xb="horizontal";t.hs=m;t.sP=m;t.Df=10;t.xo=0;t.VE=j;t.fc=j;t.Nd=m;t.v=function(){dx.n.v.call(this);var b=this.J().v("div",this.L(this.xb));this.Z(b)};
t.Z=function(b){dx.n.Z.call(this,b);H.add(b,this.L(this.xb));var b=this.h(),c=Ub(l,"goog-slider-thumb",b)[0];c||(c=this.J().v("div","goog-slider-thumb"),Mc(c,Vc.Tp),b.appendChild(c));this.Wa=this.wd=c;Mc(this.h(),Vc.hJ);kx(this)};t.z=function(){dx.n.z.call(this);this.ae=new yh(this.Wa);this.Of=new yh(this.wd);this.ae.Kf(this.Nd);this.Of.Kf(this.Nd);this.ae.Hv=this.Of.Hv=w;this.nb=new ij(this.h());lx(this,j);this.h().tabIndex=0;mx(this)};
a.lx=function(b,c){c?(b.m().e(b.ae,"beforedrag",b.yr).e(b.Of,"beforedrag",b.yr).e(b.ae,["start","end"],b.Jr).e(b.Of,["start","end"],b.Jr).e(b.nb,"key",b.ff).e(b.h(),"mousedown",b.lj),b.VE&&nx(b,j)):(b.m().Fa(b.ae,"beforedrag",b.yr).Fa(b.Of,"beforedrag",b.yr).Fa(b.ae,["start","end"],b.Jr).Fa(b.Of,["start","end"],b.Jr).Fa(b.nb,"key",b.ff).Fa(b.h(),"mousedown",b.lj),b.VE&&nx(b,m))};t.ib=function(){dx.n.ib.call(this);Sc(this.ae,this.Of,this.nb,this.Oj)};
t.yr=function(b){var c=b.cr==this.ae?this.Wa:this.wd,d;"vertical"==this.xb?(d=this.h().clientHeight-c.offsetHeight,d=(d-b.top)/d*(this.Uc()-this.Dc())+this.Dc()):d=b.left/(this.h().clientWidth-c.offsetWidth)*(this.Uc()-this.Dc())+this.Dc();d=b.cr==this.ae?Math.min(Math.max(d,this.Dc()),this.S()+this.Sh()):Math.min(Math.max(d,this.S()),this.Uc());ox(this,c,d)};
t.Jr=function(b){var c="start"==b.type;H.enable(this.h(),"goog-slider-dragging",c);H.enable(b.target.handle,"goog-slider-thumb-dragging",c);b=b.cr==this.ae;c?(this.dispatchEvent(ix),this.dispatchEvent(b?ex:gx)):(this.dispatchEvent(jx),this.dispatchEvent(b?fx:hx))};
t.ff=function(b){var c=j;switch(b.keyCode){case 36:px(this,this.Dc());break;case 35:px(this,this.Uc());break;case 33:qx(this,this.Df);break;case 34:qx(this,-this.Df);break;case 37:var d=this.Nd&&this.zd()?1:-1;qx(this,b.shiftKey?d*this.Df:d*this.Fp);break;case 40:qx(this,b.shiftKey?-this.Df:-this.Fp);break;case 39:d=this.Nd&&this.zd()?-1:1;qx(this,b.shiftKey?d*this.Df:d*this.Fp);break;case 38:qx(this,b.shiftKey?this.Df:this.Fp);break;default:c=m}c&&b.preventDefault()};
t.lj=function(b){this.h().focus&&this.h().focus();var c=b.target;!sc(this.Wa,c)&&!sc(this.wd,c)&&(this.sP?px(this,rx(this,b)):(this.bA(b),this.Me=sx(this,rx(this,b)),this.CE="vertical"==this.xb?this.rs<this.Me.offsetTop:this.rs>tx(this,this.Me)+this.Me.offsetWidth,b=Rb(this.h()),this.m().e(b,"mouseup",this.Zz,j).e(this.h(),"mousemove",this.bA),this.Yh||(this.Yh=new Id(200),this.m().e(this.Yh,Jd,this.hE)),this.hE(),this.Yh.start()))};t.XD=function(b){qx(this,(0<b.detail?-1:1)*this.Fp);b.preventDefault()};
t.hE=function(){var b;if("vertical"==this.xb){var c=this.rs,d=this.Me.offsetTop;this.CE?c<d&&(b=ux(this,this.Me)+this.Df):c>d+this.Me.offsetHeight&&(b=ux(this,this.Me)-this.Df)}else c=this.rs,d=tx(this,this.Me),this.CE?c>d+this.Me.offsetWidth&&(b=ux(this,this.Me)+this.Df):c<d&&(b=ux(this,this.Me)-this.Df);ka(b)&&ox(this,this.Me,b)};t.Zz=function(){this.Yh&&this.Yh.stop();var b=Rb(this.h());this.m().Fa(b,"mouseup",this.Zz,j).Fa(this.h(),"mousemove",this.bA)};
a.vx=function(b,c){var d=kg(c,b.h());return"vertical"==b.xb?d.y:b.Nd&&b.zd()?b.h().clientWidth-d.x:d.x};t.bA=function(b){this.rs=vx(this,b)};
a.rx=function(b,c){var d=b.Dc(),e=b.Uc();if("vertical"==b.xb){var g=b.Wa.offsetHeight,h=b.h().clientHeight-g,g=vx(b,c)-g/2;return(e-d)*(h-g)/h+d}g=b.Wa.offsetWidth;h=b.h().clientWidth-g;g=vx(b,c)-g/2;return(e-d)*g/h+d},a.ux=function(b,c){if(c==b.Wa)return b.Sa.S();if(c==b.wd)return b.Sa.S()+b.Sa.Sh();f(Error("Illegal thumb element. Neither minThumb nor maxThumb"))},a.qx=function(b,c){var d=ux(b,b.Wa)+c,e=ux(b,b.wd)+c,d=yt(d,b.Dc(),b.Uc()-b.xo),e=yt(e,b.Dc()+b.xo,b.Uc());wx(b,d,e-d)},a.ox=function(b,
c,d){var e=l;c==b.wd&&(d<=b.Sa.Uc()&&d>=b.Sa.S()+b.xo)&&(e=d-b.Sa.S());var g=e||b.Sa.Sh();c==b.Wa&&(d>=b.Dc()&&d<=b.Sa.S()+g-b.xo)&&(c=g-(d-b.Sa.S()),cx(b.Sa,d)+cx(b.Sa,c)==cx(b.Sa,d+c)&&(wx(b,d,c),e=l));e!=l&&b.Sa.bp(e)},a.wx=function(b,c,d){b.Dc()<=c&&(c<=b.Uc()-d&&b.xo<=d&&d<=b.Uc()-c)&&!(c==b.S()&&d==b.Sh())&&(b.Sa.Js=j,b.Sa.bp(0),b.Sa.Ba(c),b.Sa.bp(d),b.Sa.Js=m,b.bE())};t.Dc=function(){return this.Sa.Dc()};t.Uc=function(){return this.Sa.Uc()};
a.sx=function(b,c){return c<=b.Sa.S()+b.Sa.Sh()/2?b.Wa:b.wd};t.bE=function(){mx(this);kx(this);this.dispatchEvent("change")};
a.mx=function(b){if(b.Wa&&!b.hs){var c=xx(b,ux(b,b.Wa)),d=xx(b,ux(b,b.wd));if("vertical"==b.xb)b.Wa.style.top=c.y+"px",b.wd.style.top=d.y+"px",b.Mb&&(c=yx(d.y,c.y,b.Wa.offsetHeight),b.Mb.style.top=c.offset+"px",b.Mb.style.height=c.size+"px");else{var e=b.Nd&&b.zd()?"right":"left";b.Wa.style[e]=c.x+"px";b.wd.style[e]=d.x+"px";b.Mb&&(c=yx(c.x,d.x,b.Wa.offsetWidth),b.Mb.style[e]=c.offset+"px",b.Mb.style.width=c.size+"px")}}},a.yx=function(b,c,d){var e=Math.ceil(d/2);return{offset:b+e,size:Math.max(c-
b+d-2*e,0)}},a.xx=function(b,c){var d=new Lb;if(b.Wa){var e=b.Dc(),g=b.Uc(),g=c==e&&e==g?0:(c-e)/(g-e);"vertical"==b.xb?(e=b.h().clientHeight-b.Wa.offsetHeight,g=Math.round(g*e),d.x=tx(b,b.Wa),d.y=e-g):(e=Math.round(g*(b.h().clientWidth-b.Wa.offsetWidth)),d.x=e,d.y=b.Wa.offsetTop)}return d},a.px=function(b,c){c=yt(c,b.Dc(),b.Uc());b.hs&&b.Qq.stop(j);var d=new oq,e,g=sx(b,c),h=b.S(),k=b.Sh(),n=ux(b,g),q=xx(b,n);e=b.Kw();Math.abs(c-n)<e&&(c=yt(n+(c>n?e:-e),b.Dc(),b.Uc()));ox(b,g,c);n=xx(b,ux(b,g));
e="vertical"==b.xb?[tx(b,g),n.y]:[n.x,g.offsetTop];q=new st(g,[q.x,q.y],e,100);q.Kf(b.Nd);d.add(q);if(b.Mb){var q=xx(b,h),r=xx(b,h+k),k=q;e=r;g==b.Wa?k=n:e=n;"vertical"==b.xb?(g=yx(r.y,q.y,b.Wa.offsetHeight),k=yx(e.y,k.y,b.Wa.offsetHeight),n=new st(b.Mb,[tx(b,b.Mb),g.offset],[tx(b,b.Mb),k.offset],100),g=new qt(b.Mb,g.size,k.size,100)):(g=yx(q.x,r.x,b.Wa.offsetWidth),k=yx(k.x,e.x,b.Wa.offsetWidth),n=new st(b.Mb,[g.offset,b.Mb.offsetTop],[k.offset,b.Mb.offsetTop],100),g=new rt(b.Mb,g.size,k.size,100));
n.Kf(b.Nd);g.Kf(b.Nd);d.add(n);d.add(g)}b.pB&&(h=b.pB.PW(h,c,100),B.forEach(h,function(b){d.add(b)}));b.Qq=d;b.m().e(d,"end",b.JL);b.hs=j;d.play(m)};t.JL=function(){this.hs=m};t.ep=function(b){if(this.xb!=b){var c=this.L(this.xb),d=this.L(b);this.xb=b;this.h()&&(H.LH(this.h(),c,d),b=this.Nd&&this.zd()?"right":"left",this.Wa.style[b]=this.Wa.style.top="",this.wd.style[b]=this.wd.style.top="",this.Mb&&(this.Mb.style[b]=this.Mb.style.top="",this.Mb.style.width=this.Mb.style.height=""),mx(this))}};
t.w=function(){dx.n.w.call(this);this.Yh&&this.Yh.F();delete this.Yh;this.Qq&&this.Qq.F();delete this.Qq;delete this.Wa;delete this.wd;this.Mb&&delete this.Mb;this.Sa.F();delete this.Sa;this.nb&&(this.nb.F(),delete this.nb);this.Oj&&(this.Oj.F(),delete this.Oj);this.ae&&(this.ae.F(),delete this.ae);this.Of&&(this.Of.F(),delete this.Of)};t.Fp=1;t.Kw=function(){return this.Sa.Kw()};t.S=function(){return this.Sa.S()};t.Ba=function(b){ox(this,this.Wa,b)};t.Sh=function(){return this.Sa.Sh()};
t.bp=function(b){ox(this,this.wd,this.Sa.S()+b)};t.C=function(b){S(this.h(),b);b&&mx(this)};a.kx=function(b){var c=b.h();if(c){var d=b.Dc();Nc(c,Uc.pJ,d);d=b.Uc();Nc(c,Uc.oJ,d);b=b.S();Nc(c,Uc.qJ,b)}},a.nx=function(b,c){c?(b.Oj||(b.Oj=new Zw(b.h())),b.m().e(b.Oj,"mousewheel",b.XD)):b.m().Fa(b.Oj,"mousewheel",b.XD)};t.Za=function(b){if(this.fc!=b&&this.dispatchEvent(b?"enable":"disable"))this.fc=b,lx(this,b),b||this.Zz(),H.enable(this.h(),"goog-slider-disabled",!b)};t.isEnabled=p("fc");
a.tx=function(b,c){return b.Nd?xh(c):c.offsetLeft};a.zx=function(b){dx.call(this,b);this.Sa.bp(0)};A(zx,dx);zx.prototype.L=function(b){return"vertical"==b?"goog-slider-vertical":"goog-slider-horizontal"};a.Ax=function(b){this.options=$.extend({},this.defaults,b)};A(Ax,U);t=Ax.prototype;t.defaults={iC:310,jC:310,og:250,pg:250,jP:2,opacity:0.25,EY:"#eee"};t.Z=function(b){Ax.n.Z.call(this,b);this.src=this.g.src;this.options.src=this.src;this.options.Hm=(this.options.iC-this.options.og)/2;this.options.Gm=(this.options.jC-this.options.pg)/2;this.Nq()};
t.Nq=function(){var b=this.options;this.GA=$(cl('            <div class="avatar-editor-container" style="width:<%=containerWidth%>px">              <div class="avatar-editor-container-inner" style="height:<%=containerHeight%>px;">                <div class="avatar-editor-window" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;margin:<%=windowMarginTop%>px <%=windowMarginLeft%>px;">                  <div class="avatar-editor-window-shadow" style="height:<%=windowHeight%>px;width:<%=windowWidth%>px;"></div>                  <div class="avatar-editor-window-inner" style="width:<%=containerWidth%>px; height:<%=containerHeight%>px;margin:-<%=windowMarginTop%>px 0 0 -<%=windowMarginLeft%>px;">                    <img class="inner" title="拖动相片"/>                  </div>                </div>                <img class="outer" style="opacity:<%=opacity%>;"/>              </div>              <div class="goog-slider-wrap">                  <i class="zg-icon image-minus"></i>                  <i class="zg-icon image-plus"></i>                  <div class="goog-slider">                      <div class="line"></div>                      <div class="goog-slider-thumb"></div>                  </div>              </div>            </div>',{containerWidth:b.jC,
containerHeight:b.iC,windowHeight:b.og,windowWidth:b.pg,windowMarginTop:b.Hm,windowMarginLeft:b.Gm,src:b.src,opacity:b.opacity}));this.Ub=this.GA[0];this.GA.insertBefore(this.g);S(this.g,m);this.ZK=L("avatar-editor-container-inner",this.Ub);this.Vr=L("outer",this.Ub);this.qx=L("inner",this.Ub);this.Km=$(this.Vr);this.pu=$(this.qx);this.AE=0;this.Km.load(y(this.fI,this));this.pu.load(y(this.fI,this));this.qx.src=this.Vr.src=this.options.src;this.HS=L("goog-slider",this.Ub)};
t.z=function(){this.Tz=new zx;this.Tz.o(this.HS);this.m().e(this.ZK,["mousedown","touchstart"],function(b){var c=new yh(this.Ub);c.addEventListener("drag",y(function(b){var c=this.zoom;this.Ce={Mp:this.options.pg/c,Jn:this.options.og/c,x:(this.options.Gm-(this.IE.left+(b.clientX-this.Jt)))/c,y:(this.options.Hm-(this.IE.top+(b.clientY-this.Kt)))/c};Bx(this)},this));c.addEventListener("end",y(function(){c.F()},this));c.Em(b);this.Em(b)});this.m().e(this.Ub,["touchmove"],function(b){b.stopPropagation();
b.preventDefault()});this.m().e(this.Tz,"change",function(){var b=this.Tz.S(),c=this.EI;Cx(this,(this.WT-c)*b/100+c)})};a.Cx=function(b,c){b.IX=b.zoom;b.zoom=c;Dx(b,b.Ce.Mp/2+b.Ce.x,b.Ce.Jn/2+b.Ce.y)},a.Dx=function(b,c,d){var e=b.zoom;b.Ce={Mp:b.options.pg/e,Jn:b.options.og/e,x:c-b.options.pg/e/2,y:d-b.options.og/e/2};Bx(b)};t.fI=function(){this.dO||(this.qx.complete&&this.Vr.complete?this.init():(this.AE++,2<=this.AE&&this.init()))};
t.init=function(){this.Ur=this.Km.width();this.Tr=this.Km.height();var b=this.options.pg/this.Ur,c=this.options.og/this.Tr;this.EI=b=c>b?c:b;this.WT=this.EI*this.options.jP;this.Ce={Jn:this.options.pg/b,Mp:this.options.og/b,x:0,y:0};Cx(this,b);Dx(this,this.Ur/2,this.Tr/2);this.dO=j};t.Em=function(b){this.Jt=b.clientX;this.Kt=b.clientY;this.IE=this.pu.position();this.aY=this.Km.position()};
a.Bx=function(b){var c=b.zoom,d=yt(b.options.Gm-b.Ce.x*c,b.options.pg+b.options.Gm-b.Ur*c,b.options.Gm),e=yt(b.options.Hm-b.Ce.y*c,b.options.og+b.options.Hm-b.Tr*c,b.options.Hm),g={width:c*b.Ur,height:c*b.Tr,left:d,top:e};b.Km.css(g);b.pu.css(g);b.Ce.x=(b.options.Gm-d)/c;b.Ce.y=(b.options.Hm-e)/c};t.support=function(){return"getContext"in document.createElement("canvas")};a.Fx=function(b,c,d){U.call(this);this.mq=b||Ex;this.bD=c;this.hH=d||"l"};A(Fx,U);a.Ex=1;t=Fx.prototype;t.Z=function(b){this.g=b;this.v()};
t.v=function(){this.xA="http://upload."+eh.km+"/upload_avatar";this.Dk=$(cl('            <form target="av_up_frame" style="display:none;" method="post" enctype="multipart/form-data" action="<%=uploadAction%>">                <label for="avt_file"></label>                <input type="file" accept="image/*" name="picture" id="avt_file" />                <input type="hidden" name="handle_mode" value="upload" />                <input type="hidden" name="type" value="<%=type%>" />                <input type="hidden" name="dest_id" value="<%=dest_id%>" />                <input type="hidden" name="return_size" value="<%=return_size%>" />            </form>',{uploadAction:this.xA,
type:this.mq,dest_id:this.mq===Ex?T[3]:this.bD,return_size:this.hH}));this.HI=$('<iframe id="av_up_frame" name="av_up_frame" style="position: absolute; height: 0px; width: 0px; left: -9000px;"></iframe>');this.HI.appendTo(document.body);this.input=this.Dk.find("input[type=file]")[0];C?(this.Dk.find("label").html($(this.g).html()),this.g.innerHTML="",$(this.g).append(this.Dk),this.Dk.addClass("avatar-editor-form-ie")):(this.Dk.insertAfter(this.g),$(this.g).click($.proxy(function(){this.input.click()},
this)));this.m().e(this.input,"change",this.Ic).e(this.input,"click",function(b){this.dispatchEvent("beforeopen")===m&&b.preventDefault()});this.m().e(X,"iframe_data",function(b){(b=b.Kc)&&!b.r?"upload"===b.handle_mode?(this.Ll=b.url,this.px=b.id,Gx()||this.Jo()):"resize"===b.handle_mode&&($(this.g).find("form").remove(),this.rC(b)):V(b.msg)})};a.Gx=function(){return!!window.FileReader};
t.Ic=function(b){this.Ll=this.px=this.rj="";if(this.wa)this.wa.X();else{this.wa=new Ai(l,m);this.wa.Ta("修改图片");var c=mi.MI,d=mi.rJ,e=new ei;e.set(c,"取消",m,j).set(d,"确定",j);ii(this.wa,e);this.m().e(this.wa,ji,function(b){if(b.key===d){if(Gx()){var c=this.zv,b=$("<canvas></canvas>");b.attr("width",c.options.pg);b.attr("height",c.options.og);var e=b[0];$(document.body).append(e);var n=b[0].getContext("2d"),q=c.Ce;n.drawImage(c.Vr,q.x,q.y,q.Mp,q.Jn,0,0,c.options.pg,c.options.og);c=e.toDataURL("image/png");
b.remove();b=c}else b=this.zv.Ce;if((this.rj=b)&&(Gx()||this.px))if(this.dispatchEvent("beforepost"),b={type:this.mq,dest_id:this.mq===Ex?T[3]:this.bD,return_size:this.hH},Gx()){var r=new FormData;r.append("handle_mode","upload");r.append("picture",Hx(this.rj.replace(/data\:image\/\w{3,4};base64,/,"")),this.file.name);$.each(b,function(b,c){r.append(b,c)});$.ajax({url:this.xA,data:r,method:"post",processData:m,contentType:m,success:$.proxy(this.rC,this),dataType:"json",xhrFields:{withCredentials:j},
crossDomain:j})}else{var b=$.extend(b,{handle_mode:"resize",x:Math.round(this.rj.x),y:Math.round(this.rj.y),height:Math.round(this.rj.Jn),width:Math.round(this.rj.Mp),hashval:this.px}),v='<form target="av_up_frame" style="display:none;" method="post" action="'+this.xA+'">';$.each(b,function(b,c){v+='<input type="hidden" name="'+b+'" value="'+c+'" />'});v+="</form>";b=$(v);b.appendTo(this.g);b[0].submit()}this.wa.C(m);return m}})}e=this.wa.R();c=$("<div class='new-avatar-editor-loading'><div><span></span></div><div>正在上传...</div></div>");
e=$(e);e.html("");e.append(c);this.wa.C(j);H.add(this.wa.g,"avatar-edit-dialog");b=this.input=b.target;Gx()?b.files&&b.files[0]&&(this.file=b=b.files[0],c=new window.FileReader,c.onload=y(function(b){this.Ll=b.target.result;this.Jo()},this),c.readAsDataURL(b)):this.Dk[0].submit();b=this.input.cloneNode();mc(b,this.input);this.input=b;this.m().e(this.input,"change",this.Ic)};t.Jo=function(){var b=this.wa.R();this.ox=new Image;this.ox.src=this.Ll;b=$(b);b.html("");b.append(this.ox);this.zv=new Ax;this.zv.o(this.ox)};
t.rC=function(b){b&&!b.r?this.data=b:V(b.msg);this.dispatchEvent({type:"success",src:this.data});this.wa.C(m)};t.getData=function(){return this.data||l};a.Hx=function(b){var c,d;d="image/png";c=c||512;for(var b=atob(b),e=[],g=0;g<b.length;g+=c){for(var h=b.slice(g,g+c),k=Array(h.length),n=0;n<h.length;n++)k[n]=h.charCodeAt(n);h=new Uint8Array(k);e.push(h)}return new Blob(e,{type:d})};a.Ix=function(){U.call(this)};A(Ix,U);Ix.prototype.Z=function(b){Ix.n.Z.call(this,b);this.m().e(X,"sina_callback",this.Ps);this.m().e(X,"qqconn_callback",this.Ps);this.m().e(K("zh-setting-page-bind-sina-unbindbtn"),"click",this.tG);this.m().e(K("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.tG)};
Ix.prototype.Ps=function(b){if("sina_callback"===b.type){var c=sh.name=b.Kc.name,b=sh.id=b.Kc.id;K("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>";Jx(j)}else"qqconn_callback"===b.type&&(K("zh-setting-page-bind-qqconnname").innerHTML=b.Kc.name,Kx(j))};
Ix.prototype.tG=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new W(j);oe(this.m(),d,"success",function(){var b=Je(d);b&&!b.r?"sina"===c?Jx():"qqconn"===c&&Kx():V(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.Jx=function(b){S(K("zh-setting-page-bind-sina-binded-wrap"),!!b);S(K("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.Kx=function(b){S(K("zh-setting-page-bind-qqconn-binded-wrap"),!!b);S(K("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.Lx=function(b){U.call(this);this.aR=b};A(Lx,U);t=Lx.prototype;t.Z=function(b){Lx.n.Z.call(this,b);this.fe=$("input",b);this.rd=$(".zm-profile-details-items",this.g);this.Yp=[];var c=this;c.Yp=this.fe.map(function(){var b=new Mx("/topic/autocomplete",this,c.aR||$(this).parents(".topic-input-wrap")[0]);b.Tm=m;var e=y(c.filter,c);b.filter=e;return b});this.jm()};
t.z=function(){this.m().e(L("add",this.g),"click",this.add);var b=this;this.fe.each(function(){b.m().e(this,"keydown",function(b){this.keydown(b)})});B.forEach(this.Yp,function(c){b.m().e(c.K,rl,b.select)});this.rd.on("click","[name='del']",$.proxy(this.remove,this));this.jm()};
t.jm=function(){if(!eh.tc){var b=this;this.Jf&&this.Jf.F();var c=new Cs;c.dr="profile-edit-item-moving";Ds(c,this.rd[0],0);c.init();this.Jf=c;$('a, input, [role="button"]',this.rd).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})})}};t.keydown=function(b){13===b.keyCode&&setTimeout(y(function(){Nx(this)&&this.add();this.fe[0].value&&(this.fe[1]&&!this.fe[1].value)&&this.fe[1].focus()},this));return j};
a.Nx=function(b){return B.every(b.fe,function(b){return!!b.value})},a.Ox=function(b){B.forEach(b.fe,function(b){b.value=""});b.fe[0].focus()};t.select=function(){Nx(this)&&this.add()};t.add=function(){var b=Ma(this.fe[0].value),c={title:b,member_url_token:kh["1"]};if(this.fe[1]){var d=Ma(this.fe[1].value);if(!b&&!d)return;c.sub_title=d}Js("ProfileEditItemV2",c,this.CP,this)};
t.CP=function(b){var b=$(b),c;if(b.data("title")){if(c=this.rd.find("[data-title='"+b.data("title")+"']")[0]){Qk(c);Ox(this);return}}else if(b.data("sub-title")&&(c=this.rd.find("[data-sub-title='"+b.data("sub-title")+"']")[0])){Qk(c);Ox(this);return}this.rd.append(b);this.jm();Ox(this);this.dispatchEvent("add")};t.remove=function(b){$(b.target).parents("li").remove();this.dispatchEvent("remove")};
Lx.prototype.filter=function(b){return B.filter(b,function(b){return!this.rd.find("[data-title='"+b+"']")[0]},this)};a.Mx=function(b,c,d,e,g){this.Ee=b=new em(b,!g);d=new im(d);e=new El(l,l,!!e,300);ul.call(this,b,d,e);e.Y=this;e.Nk(c);(e=c.getAttribute("placeholder"))&&new pm(c,e)};A(Mx,om);Mx.prototype.im=function(b,c){b=b[0].slice(1);b=B.filter(b,function(b){return 3<b.length});b=B.map(b,function(b){return b[1]});this.filter&&(b=this.filter(b));Mx.n.im.call(this,b,c)};a.Px=function(){U.call(this)};A(Px,U);t=Px.prototype;
t.Z=function(b){Px.n.Z.call(this,b);if(b=L("profile-edit-avatar-btn")){var c=this.Uu=new Fx(Ex);c.o(b);this.m().e(this.Uu,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.m().e(this.Uu,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),V("更新失败")):($(".avatar-edit-preview-loading").remove(),
$("img.zm-avatar-editor-preview").attr("src",c.getData().url))})})}this.T=[];var d=this;$(".editable-group",this.g).each(function(){var b=new Lx;d.T.push(b);b.o(this)});b=K("zm-profile-edit-submit");this.m().e(b,"click",this.Fy);(new Ix).o(this.g);$(this.g).on("change","input, textarea, select",function(){d.Ze()})};
t.z=function(){Px.n.z.call(this);Km(w,j)();var b=K("zm-profile-progress-anim"),c=new Qx;c.addEventListener("update",function(){var d=100*c.S()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});B.forEach(this.T,function(b,d){c.watch({name:"name"+d,target:b,Oh:["add","remove"],Fh:function(){return!!b.rd.children().length}})},this);var d=this.g,e=K("zm-profile-edit-male"),g=K("zm-profile-edit-female"),h=K("zm-profile-edit-description"),k=$(".business-selection select")[0],n=K("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:K("zm-profile-edit-expert-enable"),Oh:["change"],Fh:function(){return l!==Yw(d,"enable_expert")}}).watch({name:"expert_progress",target:n,Oh:["change"],Fh:function(){return l!==Yw(d,"enable_expert")}}).watch({name:"gender_progress",target:e,Oh:["change"],Fh:function(){return l!==Yw(d,"gender")}}).watch({name:"gender_progress",target:g,Oh:["change"],Fh:function(){return l!==Yw(d,"gender")}}).watch({name:"desc_progress",target:h,Oh:["blur"],Fh:function(){return!!Ma(h.value)}}).watch({name:"business_progress",
target:h,Oh:["blur"],Fh:function(){return!!Ma(h.value)}}).watch({name:"headline_progress",target:k,Oh:["blur"],Fh:function(){return!!Ma(k.value)}})};t.Ze=function(){$(window).on("beforeunload.profileedit",y(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Hf=function(){$(window).off("beforeunload.profileedit")};
t.Fy=Km(function(){function b(b){V(la(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var k=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);k.push([b.data("title"),b.data("sub-title")||""])});var n=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);n.push([b.data("title"),b.data("sub-title")||""])});var q=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=J.filter({gender:c,headline:d,description:e,location:h,business:g,employment:k,education:n,enable_weibo:q,enable_expert:r},fs),v=y(function(){this.Hf();window.location.href="/people/"+T[1]+"/about"},this),d=new W(j);d.addEventListener("complete",function(){var c;try{c=Je(this)}catch(d){}c&&!c.r&&pa(v)?v.call(this,c):pa(b)&&
b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(Zc(c)))},j);a.Qx=function(){this.Sy={}};A(Qx,Gd);Qx.prototype.update=function(b,c){this.Sy[b]=c;this.dispatchEvent({type:"update"});return this};Qx.prototype.watch=function(b){var c=y(function(){this.update(b.name,b.Fh())},this);P(b.target,b.Oh,c);c();return this};Qx.prototype.S=function(){var b=J.La(this.Sy);return b.length&&B.filter(b,Boolean).length/b.length};a.Rx=function(){this.Zi="editing";U.call(this)};A(Rx,U);Rx.prototype.Z=function(b){Rx.n.Z.call(this,b);this.G=$(b);this.G.on("click",'a[href^="javascript"]',$.proxy(this.ta,this));this.G.on("click",'a[href^="javascript"], input',m);this.G.on("click",".item",$.proxy(this.PQ,this))};a.Sx=function(b,c,d){if(!eh.tc||navigator.userAgent.match(/iPad/i)!=l)b=$(".item",b.G).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
Rx.prototype.PQ=function(b){var c=$(b.currentTarget),d=c.data("href"),c=d&&!c.hasClass(this.Zi),b=b.metaKey||b.ctrlKey;c&&(b?window.open(d):location.href=d)};
Rx.prototype.ta=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Zi).closest(".skilled-topics").addClass(this.Zi),Sx(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Zi).closest(".skilled-topics").removeClass(this.Zi),Sx(this,d,j);else if("save"===b){var e=
new W(j);this.m().e(e,"success",function(){var b=Je(e);b.r?V(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Zi).closest(".skilled-topics").removeClass(this.Zi),Sx(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.Tx=function(){U.call(this)};A(Tx,U);
Tx.prototype.Z=function(b){Tx.n.Z.call(this);if(b&&(this.G=$(b),$(".editable-group",this.G).each(function(){(new Ux).o(this)}),(b=K("profile-header-description-input"))&&new Sm(b),(b=L("zm-profile-header-avatar-container"))&&H.has(b,"self"))){var c=new Fx(Ex);c.o(b);this.m().e(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.m().e(c,"success",function(){$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:c.getData().id}}},
function(b){b&&b.r?($(".avatar-edit-preview-loading").remove(),V("更新失败")):($(".avatar-edit-preview-loading").remove(),L("zm-avatar-editor-preview").src=c.getData().url)})})}};a.Ux=function(){U.call(this)};A(Ux,U);Ux.prototype.Z=function(b){Ux.n.Z.call(this);this.G=$(b);this.de=$(".info-wrap",this.G);this.Fd=$(".edit-wrap",this.G);this.Sp=$(".title",this.de);this.YT=$("input",this.Fd)};
Ux.prototype.z=function(){Ux.n.z.call(this);this.G.on("click","[name='edit']",Km($.proxy(function(){this.G.addClass("editing");var b=this.Fd.find("input").get(0);b?b.focus():(b=this.Fd.find("textarea").get(0))&&b.focus()},this),j));var b=this;this.Yp=[];$("input[type=text]",this.G).each(function(){var c=new Mx("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Yp.push(c)});this.Fd.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Fd.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
Ux.prototype.save=function(){var b=this,c=this.G.data("name");if("location"===c){var c=this.Fd.find("input.location"),d=this.Fd.find("select"),e=this.Fd.find("input.male").is(":checked")?1:0;$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{location:[c.val()],business:d.val(),gender:e}}},function(c){c&&c.r?V(c.msg):(c=c.msg,c.location[0].html||(c.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>"),c.business.html||(c.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>"),
b.de.find("span.location").attr("title",c.location[0].text).html(c.location[0].html),b.de.find("span.business").attr("title",c.business.text).html(c.business.html),c=1===parseInt(c.gender,10)?"male":"female",b.de.find("span.gender i").removeClass("icon-profile-female icon-profile-male").addClass("icon-profile-"+c),b.cancel())})}else"employment"===c?(d=this.Fd.find("input.employment"),c=this.Fd.find("input.position"),d=d.val(),c=c.val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{employment:[[d,
c]]}}},function(c){c&&c.r?V(c.msg):(c=c.msg,!c.employment[0][0].text&&!c.employment[0][1].text?b.G.addClass("empty"):b.G.removeClass("empty"),c.employment[0][0].html||(c.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>"),c.employment[0][1].html||(c.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>"),b.de.find(".employment").attr("title",c.employment[0][0].text).html(c.employment[0][0].html),b.de.find(".position").attr("title",
c.employment[0][1].text).html(c.employment[0][1].html),b.cancel())})):"education"===c?(d=[this.Fd.find("input.education"),this.Fd.find("input.education-extra")],c=d[0].val(),d=d[1].val(),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{education:[[c,d]]}}},function(c){c&&c.r?V(c.msg):(c=c.msg,!c.education[0][0].text&&!c.education[0][1].text?b.G.addClass("empty"):b.G.removeClass("empty"),c.education[0][0].html||(c.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>"),
c.education[0][1].html||(c.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>"),b.de.find(".education").attr("title",c.education[0][0].text).html(c.education[0][0].html),b.de.find(".education-extra").attr("title",c.education[0][1].text).html(c.education[0][1].html),b.cancel())})):"description"===c&&(c=this.Fd.find("textarea.description"),$.post("/node/ProfileHeaderV2",{method:"save",params:{data:{description:c.val()}}},function(c){c&&c.r?V(c.msg):(c=c.msg,
c.description.text?b.G.removeClass("empty"):(c.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",c.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",b.G.addClass("empty")),b.de.find(".fold-item .content").empty().html(c.description.fold_html),b.de.find(".unfold-item .content").html(c.description.unfold_html),c.description.shortened?b.de.removeClass("disable-fold"):b.de.addClass("disable-fold"),
b.cancel())}))};Ux.prototype.cancel=function(){this.G.removeClass("editing")};a.Vx=function(){O.call(this);this.Uf="zm-item";this.DW="zm-item-top-btn";this.bS=j};A(Vx,Lm);t=Vx.prototype;t.init=function(b){this.Ub=b;this.m().e(b,"click",this.ta);this.refresh()};t.ni=da("Uf");
t.ta=function(b){if(b.target){var c=Wk(this.Ub,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Ic(b.target,l,this.Uf),this.type&&(this.id&&this.action&&this.item)&&(this.DI||(this.DI=j,this.xhr=new W(j),this.m().e(this.xhr,"complete",this.Vg),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.AW=c))}};
t.Vg=function(){if("cancel-top"===this.action)Jk(this.item,j);else if("top"===this.action){var b=Vb(this.Uf,this.Ub);this.eY=eg(this.item).y;b&&2<=b.length&&jc(N(this.item),L(this.Uf,this.Ub));this.scroll();Qk(this.item);S(L("zm-item-top-btn-top",this.item),m);S(L("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.DI=m};t.scroll=function(){if(this.bS){var b=L("zm-profile-section-wrap"),c=Lc(Sb((ga||window).document)).y;b&&0>eg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Vb(this.Uf,this.Ub);b&&0<b.length&&B.forEach(b,function(b,d){if(0!==d){var e=L("zm-item-top-btn-top",b);e&&S(e,j)}},this)};a.Wx=function(b,c){b.m().e(c,"next",b.refresh)};a.Xx=function(){this.qw=["zg-btn-follow","zg-btn-unfollow"];this.rw="people"};A(Xx,U);Xx.prototype.z=function(){this.m().e(this.g,"click",this.ta)};Xx.prototype.ta=function(b){var c=Wk(this.g,b.target);this.hn&&this.hn(c);c&&(c.name&&"focus"===c.name)&&Qp(c,this.rw,function(){c.getAttribute("data-followme")&&(H.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.qw,{gX:"question"===this.rw?"关注问题":l})};Xx.prototype.tH=da("hn");a.Zx=function(b,c,d,e){O.call(this);this.Kd=b;this.Lh=c;this.Tg=d;this.RC=e||Yx;b.maxLength=d;this.yj=new vu(b);P(this.yj,"input",this.Eo,m,this);this.Ni()};A(Zx,Gd);a.Yx=0;Zx.prototype.Eo=function(){this.Ni()};Zx.prototype.Ni=function(){var b=this.Kd.value.length;if(b>this.Tg){var c=this.Kd.scrollTop,d=this.Kd.scrollLeft;this.Kd.value=this.Kd.value.substring(0,this.Tg);b=this.Tg;this.Kd.scrollTop=c;this.Kd.scrollLeft=d}this.Lh&&xc(this.Lh,1==this.RC?b:this.Tg-b)};
Zx.prototype.w=function(){Zx.n.w.call(this);delete this.Kd;this.yj.F();this.yj=l};a.$x=function(b){O.call(this);this.ba=l;this.ia=b;this.st=0;this.OG=""},a.ay=void 0;A($x,Lm);t=$x.prototype;t.init=function(){this.fs||(this.fs=j,this.v(),this.pb())};t.pb=function(){C||(new gn("搜索问题")).o(this.Mc);this.T=new qn("/redirect-question/autocomplete",this.Mc,l,l,K("zh-question-redirect-diag-content"),m);this.T.Tm=m;this.T.jh(j);this.m().e(this.T,ul.wh.Fi,hl);this.m().e(this.T,"select",this.vQ).e(this.qK,"click",function(){this.ba.C(m)})};
t.vQ=function(){var b=this.T.gj();if("search_link"===b[0])window.open("/search?q="+encodeURIComponent(b[1])+"&type=question");else{this.Mc.value="";var c=b[3],b=b[1];this.ba.C(m);this.Mc.value="";this.xhr=new W(j);oe(this.m(),this.xhr,"complete",this.JJ);this.xhr.ajax("/question/redirect","qid="+this.ia+"&rqid="+c);this.st=c;this.OG=b}};t.JJ=function(){var b=Je(this.xhr);b&&(b.r?V(b.msg):this.Gi?(this.Gi.innerHTML="已经重定向",this.Gi.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.v=function(){this.g=M("div",{id:"zh-question-redirect-diag"},["将问题跳转至",M("div",{id:"zh-question-redirect-diag-content"},this.Mc=M("input",{type:"text","class":"zg-form-text-input"})),M("div","zm-command",this.qK=M("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.ba=new Ai(l,m);this.ba.Ta("问题重定向");ii(this.ba,l);this.ba.R().appendChild(this.g)};t.show=function(){this.init();this.ba.C(j)};a.by={},a.by=function(){O.call(this)};A(by,Lm);by.xu=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];by.zj=l;by.N=function(){by.zj||(by.zj=new by,by.zj.init());return by.zj};t=by.prototype;
t.init=function(){if(!this.g){this.v();this.pb();var b=new xq(this.g);Th(b);b.sE=j;b.rm(j);b.C(m);yq(b,0);Wr(b,new Pf(13,0,0,-22));this.Wy=b}};t.pb=function(){this.m().e(this.g,"click",this.sQ)};t.sQ=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.hL.eX(b),this.Wy.C(m))};
t.v=function(){var b=M("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[M("div","zg-r5px zu-hovercard-inner",[M("div",{id:"zh-answer-flag-popup-header"},[M("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.wG=M("div",{id:"zh-answer-flog-options-wrap"})]),M("div","zu-hovercard-spin-top")]);B.forEach(by.xu,function(b,d){var e=M("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.wG.appendChild(e)},this);document.body.appendChild(b);this.g=b};t.show=function(b,c){this.Wy.Nc(new vq(b,1));var d=c.mX(),e=Vb("zm-menu-item-link",this.wG);B.forEach(e,function(b,c){S(b,!B.contains(d,c))},this);this.Wy.C(j);this.hL=c};a.cy=function(){O.call(this)},a.dy=void 0;A(cy,Lm);
cy.prototype.init=function(){this.v();this.m().e(this.ql,"change",function(){var b=this.ql.value;this.bz.value="no"===b?"":by.xu[+b][1]}).e(this.kn,"click",function(b){"cancel"===b.target.name?this.ba.C(m):this.bz.value&&"no"!==this.ql.value&&(this.mw=new W(j),this.m().e(this.mw,"complete",function(){var b=Je(this.mw);b&&!b.r?(this.Gi.innerHTML="已经标记",this.ba.C(m)):V(b.msg)}),b=Lk(this.bz.value),this.mw.ajax("/answer/flag","answer_id="+this.tJ+"&flag="+this.ql.value+"&reason="+encodeURIComponent(b)))})};
cy.prototype.v=function(){this.g=M("div",l,[M("div","zg-section",[M("div",l,"标记："),this.ql=M("select")]),M("div",l,[M("div",l,"原因"),this.bz=M("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.kn=M("div","zm-command",[M("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),M("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.ql.appendChild(M("option",{value:"no"},"选择标记原因"));B.forEach(by.xu,function(b,c){this.ql.appendChild(M("option",
{value:c},b[0]))},this);this.ba=new Ai(l,m);this.ba.Ta("标记答案");ii(this.ba,l);this.ba.R().appendChild(this.g)};cy.prototype.show=function(){this.ba.C(j)};a.ey=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":dy||(dy=new cy,dy.init());c=dy;c.Gi=b;c.tJ=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;ay||(ay=new $x,ay.init());d=ay;d.Gi=b;d.ia=b.id.split("-")[1];"redirect"===c?d.show():(Hi("/question/unredirect",l,"POST","qid="+d.ia+"&rqid="+d.st),d.Gi.innerHTML="重定向已撤销",d.Gi.setAttribute("data-disabled",1))}break;case "revert":var e=Ei("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new Ul).add("revision",d).add("reason",c),n=new W(j);n.on("success",function(){var b=Je(n);b.r?V(b.msg):(e.C(m),b.msg?window.location.href=b.msg:location.reload())});n.ajax("/revert",c.toString());return m}}),g=L("content",e.R());new pm(g);new Sm(g,48);new Zx(g,l,200)}},a.fy=function(b){$(b).on("click",'a[name="revert"]',function(){ey(this)})};a.gy=function(){U.call(this)};A(gy,U);t=gy.prototype;t.init=function(){yr.H(this);this.o(document.body)};
t.z=function(){gy.n.z.call(this);var b=L("zm-profile-header-operation");b&&(new Xx).o(b);(b=L("zm-profile-header"))&&(new Tx).o(b);(b=K("zh-profile-activity-wrap"))&&this.m().e(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");Qp(b,c,l,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.sw=b=K("zh-profile-page-force-to-rename"))&&this.m().e(b,"click",this.oT);if(this.rz=K("zh-profile-search-form")){(b=K("zh-profile-search-type"))&&this.m().e(b,
"click",this.rQ);this.hk=this.rz.getAttribute("data_type");this.m().e(this.rz,"submit",this.search);P(window,"popstate",function(b){var b=b.state,c;b&&b.dt&&(c=K("zh-profile-search-query"),c.value=decodeURIComponent(b.dt),hy(this,b.type),this.search(i,m),c.focus())},m,this);var b=(new wf(location)).hd().get("pq"),c=(new wf(location)).hd().get("type");c||(c="all");if(b&&c){var d=K("zh-profile-search-info");d&&S(d,j);hy(this,c);K("zh-profile-search-query").value=b;this.search(i,i,m)}}if(b=K("zh-profile-activity-page-list"))c=
new Mt({fa:["expandLimit"],kh:j}),c.fa("locationSource",{url:"/people/"+kh[1]+"/activities",vs:10,param:function(b){return{start:B.Wd(b).getAttribute("data-time")}}}),c.fa("childConstructor",{factory:Lw}),this.H(c),c.o(b),this.m().e(c,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category","profile").fill("label","profile_feed")});(b=L("zm-profile-fav-wrap"))&&this.m().e(b,"click",this.OL);(b=K("zm-profile-details-editform"))&&(new Px).o(b);if(b=L("zm-profile-answer-sort"))this.zh=new Xt,
this.zh.Ga(this.TJ=new Ut("按时间排序")),this.zh.Ga(this.UJ=new Ut("按投票排序")),this.zh.Ga(this.SJ=new Ut("问"+T[0]+"的问题")),this.zh.W(b),this.zh.C(m),this.m().e(b,"click",function(b){this.zh.C(j);b.stopPropagation();oe(this.m(),document,"click",function(){this.zh.C(m)})}),this.m().e(this.zh,"action",this.sN);(b=K("zh-profile-edit-expert"))&&(new iy).o(b);var e=L("profile-expert-tip");e&&this.m().e(e,"click",function(b){var c=b.target;("enable"===c.name||"close"===c.name)&&$.post("/node/ProfileExpertTopicsV2",
{method:c.name},function(b){if(!b||!b.r)"enable"===c.name?location.href="/people/edit/expert":Jk(e,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new Rx).o(this)});$(".zm-profile-module.skilled-topics").each(function(){(new Rx).o(this)});$(".zm-profile-module.active-topics").each(function(){(new Rx).o(this)});if(c=K("zh-profile-ask-list"))if(b=new Mt({fa:["autoload","locationSource"],kh:m}),this.H(b),b.o(c),c=L("zm-profile-section-list"))d=new Vx,d.ni("zm-profile-section-item"),
Wx(d,b),d.init(c);if(c=$("#zh-profile-answer-list > .zh-general-list").get(0)||$("#zh-profile-answer-list").get(0))if(b=new Mt({kh:m}),this.H(b),b.fa("childConstructor",{Qi:yw}).fa("expandLimit"),b.o(c),this.m().e(b,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category","profile").fill("label","profile_answers_list")}),c=L("zm-profile-section-list"))d=new Vx,Wx(d,b),d.init(c);if(b=$("#zh-profile-log-list").get(0))c=new Mt,c.fa("locationSource",{Xs:j}),this.H(c),c.o(b),fy(b),$(b).on("click",
'a[name="report"]',function(){(new ju("activity",$(this).data("id"))).submit();return m});if(c=K("zh-profile-topic-list"))if(b=new Mt({fa:["autoload","locationSource"]}),this.H(b),this.m().e(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(T.Fe===kh[3]){var d=new tp(j,"/topic/bio/update","bio");d.du=j;d.params=["tid="+c];d.Ib='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.o(b)}}),b.o(c),c=L("zm-profile-section-list"))d=new Vx,d.ni("zm-profile-section-item"),
Wx(d,b),d.init(c);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))c=new Mt({fa:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))c=new Mt({fa:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list-old").get(0))c=new Mt({fa:["autoload","locationSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))c=new Mt({fa:["autoload","nodeSource"],kh:m}),this.H(c),c.o(b);this.Xn();-1<location.search.indexOf("clean-followers-noti=1")&&
(new W(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){Jm("privacy_sign_in_button","singin")});$(".zm-profile-header-user-edit").click(Km(w,j))};t.oT=function(){Ei("确定","确定要强制此用户改名吗？",function(b){b&&(K("realname_form").submit(),this.sw.innerHTML="已发送",H.add(this.sw,"zg-gray"),Bd(this.sw))},this)};
t.Xn=function(){this.vj();var b=K("zm-profile-header-pm-btn");b&&P(b,"click",xt(function(b){b.preventDefault()},Km(function(){var c=new Vq;c.show();Zq(c,kh[3],kh[0]);Yq(c,b.href);c.Xb.focus()},{oa:"people_message_button",ed:j})));var c=K("zh-profile-cancel-block");c&&this.m().e(c,"click",this.$F);$("#zh-report-people, #profile-side-op a[name=report]").each(function(b,c){mu(new ju("member",kh[3]),c)});(c=K("zh-profile-search-query-mirro"))&&new pm(c,c.getAttribute("placeholder"))};
t.$F=function(){Ei("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&jy(this,m)},this)};t.Rk=function(){oe(this.m(),document,"click",function(){this.cb.C(m)})};t.vj=function(){var b=K("profile-side-op");b&&this.m().e(b,"click",this.nj)};t.sN=function(b){var c="";b.target===this.TJ?c="time":b.target===this.UJ?c="vote":b.target===this.SJ&&(c="ask");location.href="/people/"+T[1]+"/answers?sort="+c};
t.nj=function(b){b=b.target.name;"block"===b?Ei("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&jy(this,j)},this):"cancel-block"===b&&this.$F()};a.jy=function(b,c){var d=new W(j);oe(b.m(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+kh[1]+"/block","action="+(c?"add":"cancel"))};
t.OL=function(b){if(b&&b.target&&(b=Wk(this.g,b.target))){var c=L("zm-profile-fav-item-title",b),d=L("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],Vw(Nw.N(),c,d,b))}};t.rQ=function(b){if((b=b.target)&&b.name)hy(this,b.name),this.search()};
a.hy=function(b,c){var d=Vb("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)H.remove(d[e],"current"),d[e].name===c&&H.add(d[e],"current");b.hk=c};
t.search=function(b,c,d){this.He=K("zh-profile-search-query").value;this.nm="/people/"+K("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.He){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.tz)return;b&&b.preventDefault();this.om=new W(j);this.tz=j;this.m().e(this.om,"complete",this.CI);c&&window.history.pushState({dt:encodeURIComponent(this.He),type:this.hk},"","?pq="+encodeURIComponent(this.He)+"&type="+this.hk);this.om.ajax(this.nm,"type="+this.hk+"&pq="+encodeURIComponent(this.He),
"","POST")}else b||(d?(this.He=K("zh-profile-search-query").value,this.nm="/people/"+K("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.nm+"?type="+this.hk+"&pq="+encodeURIComponent(this.He)):(this.om=new W(j),this.tz=j,this.m().e(this.om,"success",this.CI),this.He=K("zh-profile-search-query").value,this.nm="/people/"+K("zh-profile-search-form").getAttribute("data_url")+"/search",this.om.ajax(this.nm,"type="+this.hk+"&pq="+encodeURIComponent(this.He),"","POST")));
(b=K("zh-profile-search-info"))&&S(b,j)}else b&&b.preventDefault()};
t.CI=function(){this.tz=m;xc(K("zh-profile-search-word"),this.He);var b=Je(this.om);if(b&&!b.r){var c=K("zh-profile-search-list");if(c)if(0===b.msg[0])K("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";K("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Vb("zm-item",
c))&&b.length)this.Le=b[b.length-1].id.split("-")[1];this.Ra=l;this.Ra=new Mw(K(c.id),l,j);this.Ra.init();this.Ra.Le=this.Le;this.Ra.url=this.nm;this.Ra.params.pq=this.He;this.Ra.params.type=this.hk;K("zh-profile-search-query").focus()}}};a.iy=function(){U.call(this)};A(iy,U);
iy.prototype.Z=function(b){this.g=b;this.Ma=new Vs;this.Ma.o(this.g);this.form=K("zm-profile-expert-editform");this.m().e(this.form,"submit",this.Fy);this.m().e(this.Ma,["add","remove","sort"],function(){this.Ze()});$(".enable").on("change","input",$.proxy(function(){this.Ze()},this));var c=K("zh-profile-expert-warning");c&&this.m().e(c,"click",function(b){"close"===b.target.name&&Jk(c)});$(".enable input[type='radio']").click(function(b){S(K("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
iy.prototype.Ze=function(){$(window).on("beforeunload.profile",y(s("你的更改还未保存，确认离开该页面吗？"),this))};iy.prototype.Hf=function(){$(window).off("beforeunload.profile")};
iy.prototype.Fy=function(b){b.preventDefault();B.map(this.Ma.data,function(b){return b[3]});var b=$(this.form).serializeArray()[0].value,c=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get(),d=this;$.post("/node/ProfileEditExpertTopicsV2",{method:"save",params:{settings:{enable_expert:b,expert_topic:c}}},function(b){if(!b||!b.r)d.Hf(),window.location.href="/people/"+T[1]})};a.ky=function(){U.call(this)};A(ky,U);a.ly=function(b){var c=$.Deferred();Ei("取消屏蔽",b,function(b){b?c.resolve():c.reject()});return c.promise()};
ky.prototype.z=function(){ky.n.z.call(this);var b=K("zh-topic-block-editor");b&&(new Xs(mh)).o(b);var c=$(".blocked-users",this.h());if(c.length)$(".item",c).on("click",".js-unblock",function(b){var d=$(b.delegateTarget);ly("取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。").then(function(){return $.post("/settings/unblockuser",{uid:d.data("id")})}).then(function(){d.fadeOut(function(){d.remove()});c.children().length||window.location.reload()})});var d=$(".blocked-columns",this.h());if(d.length)$(".item",
d).on("click",".js-unblock",function(b){var c=$(b.delegateTarget);ly("取消屏蔽之后，你将可以看到来自该专栏的文章。").then(function(){return $.post("/settings/unblockcolumn",{id:c.data("id")})}).then(function(){c.fadeOut(function(){c.remove()});d.children().length||window.location.reload()})})};a.my=function(){U.call(this);this.hX=[];this.gY="/profile/validate"};A(my,U);
my.prototype.init=function(){function b(b,c){var d={method:"save",params:{settings:b}};$.extend(d.params,th.settings_unsubscribe_formdata);$.post("/node/NotiEmailSettingsV2",d,function(b){var d;b.r?d="error":(c&&c(),d="success");var e=$(".settings-msg-"+d);e.length?e.show():(e=$('<div class="settings-msg-'+d+'">'+b.msg+"</div>"),e.appendTo($("body")));e.delay(1E3).fadeOut()})}var c=this;$('.settings-receive input[type="radio"]').on("change",function(){if(this.checked){var c=$(this),d={type:c.closest(".settings-item").data("type"),
noti:c.val()};"no"===d.noti?b(d,function(){c.closest(".settings-receive").next(".settings-mail").addClass("disabled").find('input[type="checkbox"]').prop("disabled",j)}):b(d,function(){c.closest(".settings-receive").next(".settings-mail").removeClass("disabled").find('input[type="checkbox"]').prop("disabled",m)})}});$('.settings-mail input[type="checkbox"]').on("change",function(){var c={type:$(this).closest(".settings-item").data("type"),mail:this.checked};b(c)});$("#settings-fast-answer").on("change",
function(){var c={type:$(this).closest(".settings-item").data("type"),fast:this.checked};b(c)});$(".settings-msg-disappear").delay(3E3).fadeOut();var d=$(".js-ajax-form");d.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Gr(J.La(b),5E3);c.hasClass("unsubscribe")&&(d.remove(),$(".settings-section").remove())});return m});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
var e=$(".feedback-form");e.submit(function(){var b=e.attr("action");$.post(b,e.serialize()).done(function(){e.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>');e.remove()});return m});$("#weibopageenable").on("change",function(b){$.post("/node/SettingsWeiboPageV2",{method:b.target.checked?"enable":"disable"}).done(function(b){b.r?V(b.msg):Gr([m,"保存成功"])});return m});var g=$("#js-settings-account-form");if(g.length){var h=zi(function(){new pm(K("password"))}),
k=$("#url_token"),n=$("#js-url-preview .token");k.on("input change keyup",function(){n.text($.trim(this.value))});var q=$("#email"),r=function(){$("#js-email-confirm").removeClass("hidden");q.off("focus",r);h()};q.one("focus",r);$(function(){document.activeElement===q.get(0)&&r()});$(".resend-mail",g).click(function(){var b=$(this);Ni.dispatchEvent("/activation/resend-email");$.post("/settings/resend_reset_email",function(c){c.r?V(c.msg):b.replaceWith("已发送")});return m});$(".zg-form-text-input",g).each(function(){function b(){this.value!==
this.defaultValue&&(d.hide(),c.off("change input keyup",b))}var c=$(this),d=c.next(".validate-error");if(d.length)c.on("change input keyup",b)});var k=new kr,v=$(".rename-tab",g);k.o(v.get(0));var x=function(){$("input[placeholder]:visible",v).placeholder()};k.on("select",x);var F=$(".rename-button",g),g=function(){F.remove();v.removeClass("hidden");x()};F.one("click",g);"#rename-section"===location.hash&&g()}g=$("#js-form-account-password");g.length&&($("input[placeholder]",g).each(function(){new pm(this)}),
g.validate({messages:{np:{required:'<i class="icon icon-validate-error"></i>新密码未填写'},op:{required:'<i class="icon icon-validate-error"></i>旧密码未填写'},rp:{required:'<i class="icon icon-validate-error"></i>确认密码未填写'}},errorClass:"validate-error"}));(g=K("zh-setting-page-black-list-wrap"))&&(new ky).o(g);(g=K("zh-setting-page-bind-wrap"))&&(new Ix).o(g);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){c.zn("SettingsPage")}).on("submit",function(){c.fl("SettingsPage")})};
my.prototype.zn=function(){$(window).on("beforeunload.SettingsPage",y(s("你的修改还未保存，确认离开该页面吗？"),this))};my.prototype.fl=function(){$(window).off("beforeunload.SettingsPage")};a.ny=function(b,c,d,e,g){pu.call(this,b,c,g);this.ow=d||"people";this.WL=e||["zg-follow","zg-unfollow"]};A(ny,pu);ny.prototype.init=function(b){ny.n.init.call(this,b);this.pb(this.g)};ny.prototype.BA=da("BA");ny.prototype.pb=function(b){if(this.BA){var c=new Xx,d=this.WL;c.rw=this.ow;c.qw=d||c.qw;this.hn&&c.tH(this.hn);c.o(b)}};ny.prototype.tH=da("hn");a.oy=function(b,c,d,e){O.call(this);this.g=b;this.ow=c||"people";this.VL=d||["zg-btn-follow","zg-btn-unfollow"];this.text=e||["关注","取消关注"]};A(oy,Lm);oy.prototype.init=function(){this.m().e(this.g,"click",this.Fo)};oy.prototype.Fo=function(b){b=Wk(this.g,b.target);"focus"===(b&&b.name)&&Qp(b,this.ow,l,this.VL,{follow_text:this.text[0],unfollow_text:this.text[1]})};a.py=function(b){O.call(this);this.url=b||"/topic"};A(py,Lm);t=py.prototype;t.o=function(b){this.element=b;var c=$("<ul>");this.bI=$("<li>");c.append(this.bI);$(b).append(c);this.cI||(this.cI=j,this.qA=new W(j),oe(this.m(),this.qA,"success",this.UP),this.qA.ajax(this.url,l,"POST"))};t.UP=function(){var b=Je(this.qA);b&&(b&&b.r?V(b.msg):(qy(this,this.bI,b.msg),this.cI=m,this.z()))};t.z=function(){this.m().e(this.element,"click",this.Fo)};
t.Fo=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.so){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.so=j;this.Kj=new W(j);oe(this.m(),this.Kj,"success",this.dq);this.vz=b.parentNode;this.vz.innerHTML='<span class="zg-gray">加载中...</a>';this.Kj.ajax(this.url+"?child="+c+"&parent="+d,l,"POST")}break;case "topic":window.location.href=b.href}};
a.qy=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);qy(b,h,g)}}};
t.dq=function(){var b=Je(this.Kj);if(b)if(b&&b.r)V(b.msg);else if(b=b.msg,b[1]){$(this.vz).hide();for(var c=$(this.vz.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);qy(this,g,e)}this.so=m}};a.ry=function(b){var c={Dp:m,hY:m};return function(d){if(d===m)return m;d={};J.extend(d,c,b||{});if(d.Dp&&!T.Nr)return Fi("提示信息",'<a href="/question/23261456" target="_blank">如何参与知乎话题的公共编辑？</a>'),m;if(d.fm&&!gh.EL)return Fi("提示信息",'<p>创建较久或已有较多讨论的问题限制公共编辑</p><p><a href="/question/24501563" target="_blank">如何参与问题公共编辑？</a></p>'),m}};a.sy=function(b,c,d){tp.call(this,b,c,d)};A(sy,tp);sy.prototype.Xg=function(b){jh[0][0]===b?this.ri():sy.n.Xg.apply(this,arguments)};sy.prototype.rB=function(b){if(b=Je(b.target))b.r?V(b.msg):b.msg&&(window.location.href=b.msg)};a.ty=function(){U.call(this);var b=jh;this.vf=b[0][3];this.oA=b[0];this.kY=b[1];this.CX=b[2];this.LX=b[3];this.uq=b[4];this.Jx=b[5];this.Yg="topic"};A(ty,U);t=ty.prototype;t.init=function(){yr.H(this);this.o(document.body)};
t.z=function(){function b(b){b&&b.msg&&V(b.msg)}ty.n.z.call(this);var c=K("zh-topic-side-head");if(c){var d=L("zu-entry-focus-button",c);(this.UL=d)&&this.m().e(d,"click",function(){Qp(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.Zf=K("zh-topic-operation-menu"))&&this.m().e(this.Zf,"click",this.Kz)}if(c=K("zh-current-topic-bio")){var e=new tp(j,"/topic/bio/update","bio");e.params=["tid="+this.vf];e.Ib='<a href="javascript:;" name="edit">你在 '+this.oA[0]+" 话题中的经验</a>";e.LC=j;e.o(c)}(c=K("zh-topic-top-answerer"))&&
(new oy(c,"people",["zg-follow","zg-unfollow"])).init();if(c=K("zh-topic-direct-question-list"))c=new ny(c,l,"question",l,j),c.ni("question-item"),c.init();if(c=K("zh-topic-title"))this.bd=new sy(m,"/topic/update","title"),this.bd.params=["tid="+this.vf],this.bd.addEventListener("beforeedit",ry({Dp:j})),this.bd.o(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:jh[0][3]}).done(function(c){c.r?V(c.msg):(c=b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消常去话题</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>设为常去话题</a>',b.replaceWith(c))})});if(c=K("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.el=new vp(j,"/topic/update","description",e),this.el.Ib='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.el.params=["tid="+this.vf],this.el.Bq=m,this.el.mI=m,this.el.addEventListener("beforeedit",ry({Dp:j})),this.el.o(c);if(c=K("zh-topic-faq"))this.lr=
new vp(j,"/topic/"+encodeURIComponent(jh[0][1])+"/faq","content",400),this.lr.Ib='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+jh[0][0]+"」添加常见问题</a></div>",this.lr.CY=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.lr.Bq=m,this.lr.o(c);
if(ph)$("div.topic-avatar").addClass("disabled");else if(c=L("zm-entry-head-avatar-edit-button")){var g=new Fx(2,jh[0][3]);g.o(c);var h=L("zm-avatar-editor-preview");P(g,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(h.parentNode)});P(g,"success",function(){$.post("/topic/"+jh[0][1]+"/avatar",{avatar_path:g.getData().id}).then(function(){h&&(h.src=g.getData().url)}).always(function(){$(".avatar-edit-preview-loading").remove()})});this.m().e(g,
"beforeopen",qf(ry({Dp:j}),Km(w,j)))}if(c=K("zh-topic-feed-list"))e=new Mt,this.H(e),e.fa("locationSource",{vs:0,offset:function(b){return B.Wd(b).getAttribute("data-score")}}),e.fa("childConstructor",{factory:Lw}).fa("expandLimit"),e.o(c),this.m().e(e,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category",this.Yg).fill("label","topic_activity")});if(c=K("zh-topic-top-page-list"))e=new Mt({kh:m}),this.H(e),e.fa("childConstructor",{factory:Lw}).fa("expandLimit"),e.o(c),this.m().e(e,"click!",
function(b){"comment"===b.namespace&&b.vc.fill("category",this.Yg).fill("label","topic_activity")});var k=this;k.Ra&&k.m().e(k.Ra,"afterload",function(b){X.ha({type:"ga_click_topic_more",data:b.data,target:k.Ra.Yb})});if(c=K("zh-topic-followers-list-wrap"))c=new ny(c,["/topic",encodeURI(this.oA[1]),"followers"].join("/"),l,["zg-btn-follow","zg-btn-unfollow"],j),c.ni("zm-person-item"),c.init();if(K("zh-topic-organize-page-wrap")){if(c=K("zh-topic-organize-parent-editor"))T.Nr?(e=new Bs(l,this.vf,j),
e.Ms=j,e.o(c),e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()})):uy(c);if(c=K("zh-topic-organize-child-editor"))T.Nr?(e=new Bs(l,this.vf,m),e.Ms=j,e.o(c),$("a.entire-link").insertAfter(e.xn).show()):uy(c);$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:jh[0][3],edge:this.checked^0}).done(function(b){b&&
b.msg&&V(b.msg)})});this.Lu=K("zh-topic-alias-input");new pm(this.Lu,"输入话题别名");this.Mu=K("zh-topic-alias-list");this.m().e(K("zh-topic-alias-container"),"click",this.EQ);if(c=K("zh-topic-merge"))this.Ma=new Ys,this.Ma.o(c);(c=K("zh-topic-merge-btn"))&&this.m().e(c,"click",this.hQ)}(c=K("zh-topic-organize-page-children"))&&(new py("/topic/"+encodeURIComponent(jh[0][1])+"/organize/entire")).o(c);if(c=K("zh-topic-side-related-topics"))this.CR=c,this.fz=new W(m),this.m().e(this.fz,"complete",this.qQ),
this.fz.ajax("/topic/related?tid="+this.vf);K("zh-topic-admin-page-wrap")&&(c=K("zh-topic-del-btn"))&&this.m().e(c,"click",this.QP);if(c=K("zh-topic-log-list"))(new ny(c,l,l,l,j)).init(),$(c).on("click",'a[name="revert"]',qf(function(b){b!==m&&ey(this)},ry({Dp:j}))).on("click",'.zm-item-meta a[name="report"]',function(){(new ju("activity",$(this).data("id"))).submit();return m});(c=L("zm-topic-search-input-new"))&&new pm(c,"在话题中搜索");var n=$(c);eh.tc||n.focus(function(){n.addClass("stretch-to")}).blur(function(){n.removeClass("stretch-to")});
(c=L("zm-topic-ask-in-topic"))&&this.m().e(c,"click",this.Iz);(c=L("zm-topic-feed-container"))&&(new oy(c,"question",["zg-follow","zg-unfollow"])).init();(c=K("zh-topic-side-children-list"))&&(new oy(c,"topic",["zg-follow","zg-unfollow"])).init();(this.$r=K("zh-topic-info-add"))&&this.m().e(this.$r,"submit",this.cQ);(this.DE=L("zm-topic-info-content-main",this.g))&&this.m().e(this.DE,"click",this.aQ);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+jh[0][1]+
"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:jh[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:jh[0][1],lock_type:this.name,lock_value:$(this).is(":checked")?1:0}).done(b)});(c=K("zh-topic-info-add"))&&B.forEach(oc(c),function(b){var c;b&&
(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new pm(b,c)});$(".js-may-disable").click(Km(w,j))};t.hQ=function(){this.Rq=this.Ma.AC;if(!this.FF&&this.Rq){this.FF=j;this.iy=new W(j);oe(this.m(),this.iy,"success",this.EJ);this.iy.ajax("/topic/"+encodeURIComponent(jh[0][1])+"/demand","action=merge&target_topic_id="+this.Rq[3]);var b=K("zh-topic-merged-msg");S(K("zh-topic-merge"),m);S(b,j);b=Ub("a",l,b)[0];b.href="/topic/"+this.Rq[1];b.innerHTML=this.Rq[0];this.Ma&&(this.Ma.fb.value="")}};
t.EJ=function(){var b=Je(this.iy);b&&b.r?V(b.msg):this.FF=m};t.QP=function(){this.IC||(this.IC=j,this.Jv=new W(j),oe(this.m(),this.Jv,"success",this.CJ),this.Jv.ajax("/topic/"+encodeURIComponent(jh[0][1])+"/demand","action=remove"))};t.CJ=function(){var b=Je(this.Jv);b&&b.r?V(b.msg):(b=K("zh-topic-del-msg"),S(K("zh-topic-del-btn"),m),S(b,j),this.Ma&&(this.Ma.fb.value=""),this.IC=m)};
t.EQ=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.Lu.value)this.Nu=new W(j),oe(this.m(),this.Nu,"complete",this.BJ),this.Nu.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.gz=new W(j),b=b.parentNode.getAttribute("data-token"),oe(this.m(),this.gz,"complete",this.GJ),this.gz.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.iz=new W(j),b=b.parentNode.getAttribute("data-token"),oe(this.m(),
this.iz,"complete",this.HJ),this.iz.ajax("/topic/"+encodeURIComponent(jh[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.HJ=function(){var b=Je(this.iz);b&&b.r?V(b.msg):vy(this,b.msg)};t.GJ=function(){var b=Je(this.gz);b&&b.r?V(b.msg):vy(this,b.msg)};a.vy=function(b,c){var d=Ub("li",l,b.Mu);B.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&S(b,m)})};
t.BJ=function(){var b=Je(this.Nu);if(b&&b.r)V(b.msg);else{var b=b.msg,c=M("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.Mu.appendChild(c);this.Lu.value="";S(this.Mu.parentNode,j)}};a.uy=function(b){hc(b,fc('<a href="/question/23261456" class="zg-link-gray-normal"><i class="icon-info" style="vertical-align: -3px; margin-right: 6px"></i>如何参与知乎话题的公共编辑？</a>'))};
t.Kz=function(b){this.Ky?this.cb.P()?this.cb.C(m):(this.cb.C(j),b.stopPropagation(),b.preventDefault(),this.Rk()):(b.stopPropagation(),b.preventDefault(),this.vj(),this.Rk());this.Ky=j};t.Rk=function(){oe(this.m(),document,"click",function(){this.cb.C(m)})};
t.vj=function(){var b=K("zh-topic-side-head"),c=this.Zf.getAttribute("data-auth");this.cb=new Xt;this.hx=j;"f-topic-manage"===c&&this.cb.Ga(this.JQ=new Ut("管理话题"));this.cb.Ga(this.KQ=new Ut("组织话题"));this.cb.Ga(this.IQ=new Ut("话题日志"));this.hx&&(this.cb.W(b),this.m().e(this.cb,"action",this.nj))};t.nj=function(b){var c="";b.target===this.JQ?c="admin":b.target===this.KQ?c="organize":b.target===this.IQ&&(c="log");window.location.href=["/topic",this.oA[1],c].join("/")};
t.qQ=function(){var b=Je(this.fz);if(b&&!b.r){var c=[];B.forEach(b,function(b){c.push(Kk(b,l,j))});this.CR.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&S(K("zh-topic-side-related-topics-wrap"),j)}};
t.aQ=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.XN=c,this.EE||(this.EE=j,this.sx=new W(j),this.m().e(this.sx,"success",this.bQ),b="token="+this.XN.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.sx.ajax("/topic/"+jh[0][1]+"/information/manage",b,"POST")))};t.bQ=function(){this.EE=m;var b=Je(this.sx);b&&(b.r?V(b.msg):b.msg&&(b=b.msg,L("zm-topic-info-content-main",this.g).innerHTML=$(b).html()))};
t.cQ=function(b){b.preventDefault();this.GE||(this.GE=j,this.tx=new W(j),this.m().e(this.tx,"success",this.$P),b=oc(this.$r),this.tx.ajax("/topic/"+jh[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.$P=function(){this.GE=m;var b=Je(this.tx);b&&(b.r?V(b.msg):b.msg&&(b=b.msg,L("zm-topic-info-content-main",this.g).innerHTML=$(b).html(),b=oc(this.$r),B.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.Iz=Km(function(){if(!tr()){var b=yp.N();b.show();var c=L("zm-topic-search-input-new");c.value&&Bp(b,c.value);b.Ma.data.length||b.Ma.kk(jh[0])}},j);a.wy=function(b){U.call(this,b)};A(wy,U);wy.prototype.v=function(){this.g=this.J().v("FORM",{method:"POST",style:"display:none"})};wy.prototype.post=function(b,c,d){var e=this.h();e||(this.W(),e=this.h());e.action=c||"";e.target=d||"";var c=e,g,h=new Tr;for(g in b)d=b[g],ma(d)?B.forEach(d,y(this.zB,this,h,g)):this.zB(h,g,d);c.innerHTML=h.toString();e.submit()};wy.prototype.zB=function(b,c,d){b.append('<input type="hidden" name="',Wa(c),'" value="',Wa(d),'">')};a.yy=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"day"})})},a.zy=function(b){return $.get("/node/ExploreHotFavlistsInnerV2",{params:JSON.stringify({offset:b})})},a.Ay=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"month"})})};a.By=function(){O.call(this)};A(By,Lm);By.prototype.init=function(){var b=$r(new wf(window.location.href),"group_id");b&&(this.Pj=new W(m),oe(this.m(),this.Pj,"success",this.Ry),b&&this.Pj.ajax("/noti7/read","group_id="+b,"POST"))};By.prototype.Ry=function(){var b=Je(this.Pj);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.xP=b.msg;this.dispatchEvent("change")}(b=sq)&&tq(b)};a.Cy=function(){U.call(this);var b=lh||[0,0];this.us=b[0];this.visible=!!b[1];this.Yg="collection"};A(Cy,U);t=Cy.prototype;t.init=function(){yr.H(this);this.o(document.body)};
t.z=function(){Cy.n.z.call(this);var b=K("zh-list-side-head");if(b){var c=L("zu-entry-focus-button",b);(this.UL=c)&&this.m().e(c,"click",function(){Qp(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.Zf=K("zh-list-operation-menu"))&&this.m().e(this.Zf,"click",this.Kz)}(b=K("zh-single-answer-author-info"))&&(new oy(b)).init();(b=K("zh-list-create-new-list"))&&this.m().e(b,"click",this.yS);(b=K("zh-fav-list-side-bar-creator"))&&(new oy(b)).init();(b=K("zh-fav-list-side-bar-report"))&&mu(new ju("favlist",
this.us),b);(this.yk=K("zh-favlist-webshare-container"))&&this.m().e(this.yk,"click",this.Nz);if(this.Hc=K("zh-list-meta-wrap"))this.m().e(this.Hc,"click",this.Ko),this.IW=K("zh-list-comment-num"),$r(new wf(location.href),"fc")&&Dy(this);(b=K("zh-favlists-wrap"))&&(new ny(b,l,"favlist",l,j)).init();if(b=K("zh-list-answer-wrap")){$(b).on("click","a[name=unfavo]",$.proxy(this.DN,this));var d=new Mt({kh:m});this.H(d);d.fa("childConstructor",{Qi:yw}).fa("expandLimit");d.o(b);this.m().e(d,"click!",function(b){"comment"===
b.namespace&&b.vc.fill("category",this.Yg).fill("label","collection_answer")})}(b=K("zh-favlist-log-list-wrap"))&&(new ny(b,l,"favlist",l,j)).init();(b=K("zh-favlist-following-wrap"))&&(new ny(b,l,"favlist",l,j)).init();if(b=K("zh-favlist-followers-wrap"))b=new ny(b,l,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.ni("zm-profile-section-item"),b.BA(j),b.init();this.m().e(window,"hashchange",this.dY);this.yx();this.Bo=new By;this.Bo.init()};
t.DN=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new W(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Ic(b,"div","zm-item"))b=Vb("zm-item-answer",c),1===b.length?N(c):(b=B.find(b,function(b){return b.getAttribute("data-aid")===d}))&&N(b.parentNode)};t.Nz=function(b){var b=Wk(this.yk,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);b&&(b.name&&c)&&Du(["分享收藏夹","collection",c[1],{fid:lh[0]}],"tb-webshare-"+b.name)};t.yS=Km(function(){Nw.N().show(j)},j);
t.Kz=function(b){this.Ky?this.cb.P()?this.cb.C(m):(this.cb.C(j),b.stopPropagation(),b.preventDefault(),this.Rk()):(b.stopPropagation(),b.preventDefault(),this.vj(),this.Rk());this.Ky=j};t.Rk=function(){oe(this.m(),document,"click",function(){this.cb.C(m)})};t.vj=function(){var b=K("zh-list-side-head");this.cb=new Xt;this.hx=j;this.visible||this.cb.Ga(this.MQ=new Ut("设置为公开"));this.cb.Ga(this.HQ=new Ut("删除此收藏夹"));this.hx&&(this.cb.W(b),this.m().e(this.cb,"action",this.nj))};
t.Ko=function(b){b=b.target;switch(b&&b.name){case "edit":Vw(Nw.N());break;case "addcomment":Dy(this);this.ma.yf();this.ma.Gc()&&this.ma.ti("view_comments",parseInt(Fc(b),10)||0);break;case "remove":Ey(this)}};
t.nj=function(b){b.target===this.MQ?Ei("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.RX=!this.visible,this.kI=new W(j),this.m().e(this.kI,"complete",function(){window.location.reload()}),this.kI.ajax("/collection/update","favlist_id="+this.us+"&is_public=1"))},this):b.target===this.HQ&&Ey(this)};a.Ey=function(b){Ei("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Xk,b.add("favlist_id",this.us),b.add("_xsrf",(new Lf(document)).get("_xsrf")),(new wy).post(bs(b),"/collection/delete"))},b)};
t.yx=function(){var b=1,c=$("ul.hot-favlists"),d=l;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=zy(b).done(function(b){c.html(b)}))})};a.Dy=function(b){b.ma||(b.ma=new bw(b.us,"favlist"),b.H(b.ma),b.m().e(b.ma,"click!",function(b){"comment"===b.namespace&&(b.vc.fill("category",this.Yg).fill("label","collection"),b.vc.action=b.vc.action.replace("favlist","collection"))}),gw(b.ma,b.Hc,$(".toggle-comment",b.Hc)[0]))};a.Gy=function(b){Fy||(this.Bn=b,this.uh=$(this.Bn.h()),setTimeout(y(this.hf,this)))},a.Hy=$("#is-topstory2").length?"topstory2":"homefeed",a.Fy=C&&!G(9),a.Iy={ac:"actioncard",q:"question",a:"answer",p:"article",c:"column",r:"roundtable"},a.Jy={question:"question",answer:"question",article:"column",column:"column",roundtable:"roundtable"},a.Ky={question:"question",answer:"question",article:"article",column:"column",roundtable:"roundtable"};
Gy.prototype.hf=function(){this.MA=$('meta[itemprop="ZReactor"]',this.uh);if(this.MA.length){var b=this,c=Iy[this.uh.data("type")];Kt(this.uh[0],function(){Ly(b,"display")},this.Bn);this.Bn.m().e(this.Bn,"expand",function(d){d.target instanceof qw&&Ly(b,"expand_"+c)}).e(this.Bn,"collapse",function(d){d.target instanceof qw&&Ly(b,"collapse_"+c)});this.uh.on("click",'a[name="nohelp"]',function(){var c=!!$(this).data("revert");Ly(b,c?"unhelpful":"revert_unhelpful");$(this).data("revert",!c)});$.each({".actioncard-body .more":"view_all",
".actioncard-body .next:not(.disabled)":"next_page",".actioncard-body .prev:not(.disabled)":"prev_page",".actioncard-body .items a":"open_topic",'.zg-follow[data-follow^="t:"], .zg-btn-follow[data-follow^="t:"]':"follow_topic",'.zg-unfollow[data-follow^="t:"], .zg-btn-unfollow[data-follow^="t:"]':"unfollow_topic",'a.zg-follow:not([data-follow^="t:"]):not([data-follow^="m:"])':"follow_"+Jy[c],'a.zg-unfollow:not([data-follow^="t:"]):not([data-follow^="m:"])':"unfollow_"+Jy[c],"a.toggle-comment":"expand_comments",
'a[name="addnew"]':"comment",".content h2 a":"open_"+Ky[c],"a.ignore:not(.close)":"uninterest","a.revert":"revert_uninterest","a.ignore.close":"confirm_uninterest","button.up.pressed":"vote_up_"+c,"button.down.pressed":"vote_down_"+c,"button.up:not(.pressed)":"revert_vote_up_"+c,"button.down:not(.pressed)":"revert_vote_down_"+c,'a[name="favo"]':"collect_answer",'a[name="thanks"]':"thanks",'a[name="share"]':"share",'a[name="report"], .js-report':"report","a.answer-date-link":"open_answer"},function(c,
e){b.uh.on("click",c,function(){Ly(b,e)})});this.bO()}};a.My=function(b){setTimeout(function(){$.ajax({type:"POST",url:"/zreactor/deliver",data:JSON.stringify(b),contentType:"application/json",processData:m})},50)},a.Ly=function(b,c){var d=$.extend({},Ny(b),{action_type:c,time:Aa()});d.object_id&&("display"===c?b.iR(d):My(d))},a.Oy=[],a.Py=il(550,function(){Oy.length&&(My(Oy),Oy=[])});Gy.prototype.iR=function(b){Oy.push(b);Py()};
a.Ny=function(b){var c=b.MA,d=$.extend({},c.data("meta"),{create:b.uh.find(".source .time").data("timestamp"),offset:$(".feed-item").index(b.uh)+1});return{mid:th.ga_vars.user_hash,object_type:Iy[b.uh.data("type")],object_id:c.data("id"),object_meta:d,context:Hy,others:""}};
Gy.prototype.bO=zi(function(){P(X,"click_feed_fresh",function(b){My({mid:th.ga_vars.user_hash,object_type:"btn",object_id:2,object_meta:{load_items:b.data.count},action_type:"click",context:Hy,others:""})});P(X,"topstory_feed_more",function(){My({mid:th.ga_vars.user_hash,object_type:"btn",object_id:1,object_meta:{next:$("#js-home-feed-list .feed-item").length+1},action_type:"click",context:Hy,others:""})})});a.Ry=function(b,c,d){pu.call(this,b,c,d);this.ry=m;this.Cj=!!$("#is-topstory2").length;this.OA=$("#zh-topstory2-nomore");this.IA=Qy(this);this.qu=$("#zh-topstory2-newblock");this.NA=$("#zh-topstory2-loading-newblock")};A(Ry,pu);a.Sy={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
t=Ry.prototype;t.z=function(){Ry.n.z.call(this);this.Cj&&(this.qu.click($.proxy(this.ZO,this)),Ty(this))};
a.Ty=function(b){var c=Uy(b);c.each(function(d){var e=$(this),d=c.eq(d+1);if(d.length&&e.data("block")!==d.data("block"))return Qy(b).insertBefore(d),m})},a.Uy=function(b){return $(b.wb()).filter("[data-block]")},a.Qy=function(b){var c;b.IA?(c=b.IA.detach(),!b.ry&&Vy(b)&&Kt(c[0],function(){Wy(this)},b)):c=$('<div class="feed-separator"><span>上次读到这里</span></div>');return c},a.Vy=function(b){var c=Uy(b).eq(0).data("block");return 0<$("."+b.Uf+"[data-block="+c+"]").length},a.Wy=function(b){b.dispatchEvent("shownewblockbtn");
b.qu.show()};
t.ZO=function(){this.dispatchEvent("hidenewblockbtn");this.qu.hide();var b=Uy(this),c=$("html, body").animate({scrollTop:0},"slow").promise();1800<$.now()/1E3-parseInt(b.eq(0).data("block"),10)?window.location.reload():(this.Le="more",this.NA.show(),this.Ij(j,l,function(b){this.NA.hide();b&&b.msg.length?(this.Rm(b.msg,"prepend"),160<Uy(this).length?window.location.reload():c.then($.proxy(function(){Ty(this)},this))):(this.ry=j,c.then(function(){Ei({title:"提示信息",Mj:j,content:'<p>暂时没有更多动态</p><p><a href="/topics">关注更多话题，丰富动态中的内容</a></p>',X:j,
Re:["确定"]})}))}))};t.Vg=function(b){b&&!b.r&&(b=b.msg,b.length?(S(this.Yb,0<b.length),this.OA.hide(),this.Rm(b),this.Cj&&Ty(this),su(this,m),uu(this)):(this.Fk.hide(),this.OA.show(),this.Cj&&(!this.ry&&Vy(this))&&Wy(this)))};t.CN=function(b){var c=b.currentTarget.g.getAttribute("data-feedtype"),c=Sy[c];"comment"===b.namespace&&c&&b.vc.fill("category","feed").fill("label",c)};t.Rj=function(b){var c=Lw(b);this.H(c);this.m().e(c,"click!",this.CN);c.o(b);new Gy(c);return c};
t.Ij=function(b,c,d){if(this.Cj&&"live"!==this.Le&&"more"!==this.Le){X.ha({type:"topstory_feed_more"});var e=Uy(this),e=e.eq(e.length-1),g=e.data("block");this.params.block_id=g;this.offset=e.data("offset")}Ry.n.Ij.call(this,b,c,d)};t.MG=function(b){if(this.Cj){var c={};"live"===b.start?(c.action="live",c.limit=b.offset):"more"===b.start?c.action="more":(c.action="next",c.block_id=b.block_id,c.offset=b.offset);b=c}return{params:b,method:"next"}};a.Xy=function(){this.interval=3E4};ia(Xy);a.Zy=function(b,c){if(!b.ad||c)c&&clearInterval(b.ad),b.ad=setInterval(y(function(){Yy(this)},b),b.interval)},a.Yy=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(ht($(this).data("timestamp")))});c&&Zy(b,c)};a.$y=function(){U.call(this);this.Mx={};this.Ls=[];this.AO="old"===$("#feed-ver").val();this.$E=!!$("#is-topstory").length;this.Cj=!!$("#is-topstory2").length;this.hD=this.AO?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.$E?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",m,3])};A($y,U);t=$y.prototype;
t.z=function(){$y.n.z.call(this);this.G=$(this.g);if(this.re=K("zh-main-feed-fresh-button"))this.Ek=$(this.re),this.Cj?(this.m().e(this.re,"click",this.zR),this.m().e(X,"topstory2",this.kE)):this.$E?(this.m().e(this.re,"click",this.yR),this.m().e(X,"topstory",this.kE)):(this.m().e(this.re,"click",this.DS),this.m().e(X,"homefeed",this.hN));this.Ra=new Ry(this.g,l,j);this.getParent()&&this.getParent().H(this.Ra);var b="/node/"+$(this.g).data("init").nodename;this.Ra.url=b;this.Ra.ni("feed-item-hook");
this.m().e(this.Ra,"itemcreated",function(b){az(this,b.data.NO)}).e(this.Ra,"afterload",function(b){X.ha({type:"ga_click_feed_more",data:b.data})}).e(this.Ra,"ignore",function(b){var c=b.key,g=b.value;J.forEach(this.Mx,function(b){b.hr[c]===g&&$(b.g).fadeOut(150)})}).e(this.Ra,"shownewblockbtn",function(){this.Ek.addClass("force-hide")}).e(this.Ra,"hidenewblockbtn",function(){this.Ek.removeClass("force-hide").hide();this.lh=0});this.Ra.init();this.G.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});
var c=this;this.G.on("click",".js-change-some",function(){$k("feed","intrests-change");var b=$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.Ra.Rj(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};
t.yR=function(){this.Ek.text("加载中…");this.lh=0;var b=this;this.Ra.offset=0;this.Ra.Le=0;this.Ra.Ij(j,function(){Ph(b.Ra,function(b){$(b.h()).remove()})}).done(function(){b.Ek.hide();ru(b.Ra)})};t.zR=function(){this.Ek.text("加载中…");var b=this.lh;this.lh=0;var c=this;this.Ra.offset=b;this.Ra.Le="live";this.Ra.Ij(j,l,function(b){b&&b.msg.length&&(c.Ra.Rm(b.msg,"prepend"),c.Ek.hide())});X.ha({type:"click_feed_fresh",data:{count:b}})};
t.DS=function(){var b=L("zm-home-question-list-devider",this.g);b&&H.remove(b,"zm-home-question-list-devider");var b=this.Ls.length,c=$("."+this.hD,this.g)[0];c&&5<=b&&($(".feed-separator-hook",this.g).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));B.forEach(this.Ls,function(b){var c=$("."+this.hD,this.g)[0];c?jc(b,c):this.g.appendChild(b)},
this);this.Ls=[];S(this.re,m);c=Xy.N();Yy(c,j);X.ha({type:"ga_click_feed_fresh",data:{count:b}})};
t.hN=function(b){var c=Ma(b.Kc),b=this.Ls,d=b.length;if(c&&!(500<d)){var e=fc(c),c=this.Mx;if(!J.pr(c,function(b){return b.h().id===e.id})){var g=this.Ra.Rj(e);if(g.ga){if(J.pr(c,function(b){return b.ga===g.ga}))return}else if(g.ia){if(J.pr(c,function(b){return b.ia===g.ia}))return}else if(g.hb&&J.pr(c,function(b){return b.hb===g.hb}))return;az(this,g);b.push(e);d+=1;this.re&&(this.re.innerHTML=(99<d?"99+":d)+" 条新动态",S(this.re,j))}}};
t.kE=function(b){this.lh=this.lh||0;this.lh+=+b.Kc;this.re&&(this.re.innerHTML=(99<this.lh?"99+":this.lh)+" 条新动态",S(this.re,j))};a.az=function(b,c){var d=Jh(Ih.N());b.Mx[d]=c;$(c.g).attr("data-fid",d)};a.bz=function(){};A(bz,U);t=bz.prototype;t.z=function(){bz.n.z.call(this);var b=K("zh-invite-select");b&&this.m().e(b,"change",this.Dy);(b=L("zm-invite-list"))&&this.m().e(b,"click",this.ta);(this.mx=K("zh-invite-ignore-all-btn"))&&this.m().e(this.mx,"click",this.TN)};
t.ta=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.vX=b;this.wX=j;H.add(b,"zg-btn-disabled");this.UN=new W(m);var c="qid="+b.getAttribute("data-qid")+"&uid="+T.Fe+"&op=pass";this.UN.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&Jk(c,j)}"recover"===b.name&&!this.WG&&(this.UG=b,this.WG=j,H.add(b,"zg-btn-disabled"),b.innerHTML="...",this.VG=new W(m),this.m().e(this.VG,"success",this.FJ),b="qid="+b.getAttribute("data-qid")+"&uid="+T.Fe+"&op=recover",this.VG.ajax("/question/askpeople",
b,"POST"))}};t.Dy=function(b){var c=$r(new wf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.FJ=function(){this.WG=m;this.Zb(this.UG,"ignore");this.UG.name="ignore"};
t.Zb=function(b,c){var d=b.parentNode,e=L("zm-invite-item-info-label",d);"ignore"===c?(H.remove(b,"zg-btn-disabled"),H.remove(b,"recover"),H.add(b,"ignore"),H.add(d,"invite"),H.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(H.remove(b,"zg-btn-disabled"),H.remove(b,"ignore"),H.add(b,"recover"),H.remove(d,"invite"),H.remove(d,"draft"),H.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.TN=function(){this.nx||(this.nx=j,this.zE=new W(m),this.m().e(this.zE,"success",this.DJ),this.zE.ajax("/question/askpeople","uid="+T.Fe+"&op=ignore_all","POST"))};t.DJ=function(){this.nx=m;S(this.mx);this.nx=m;B.forEach(Vb("zm-invite-item-control"),y(function(b){this.Zb(b,"recover")},this))};a.cz=function(){U.call(this)};A(cz,U);cz.prototype.z=function(){cz.n.z.call(this);this.zl();this.m().e(this.g,"click",this.ta)};cz.prototype.ta=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
cz.prototype.zl=function(){this.so||(this.so=j,this.Kj=new W(m),this.m().e(this.Kj,"success",this.Ay),this.Kj.ajax("/noti7/calendar","","GET"))};cz.prototype.Ay=function(){this.so=m;var b=Ie(this.Kj);if(b){var c=K("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new pu(c,"/noti7/calendar",j),b.Rm=function(b){var c=M("div","zm-item-more-wrap");c.innerHTML=b;jc(c,this.Yb)},b.Lr=function(b){this.Le=this.Yb.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.init())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.dz=function(){O.call(this);this.kx=[];this.FC=[]};A(dz,Lm);dz.prototype.init=function(){var b=K("home-suggest-block");b&&(this.g=b,b=K("home-suggest-close-button"),oe(this.m(),b,"click",function(){(new W(j)).ajax("/option","key=no_show_lookup&value=1");S(this.g,m)}),b=K("home-suggest-refresh-button"),this.m().e(b,"click",this.pQ),this.zs=K("home-suggest-list"),ez(this))};dz.prototype.pQ=function(){fz(this);return j};
a.fz=function(b){for(var c=[],d=0;3>d;d++){var e=b.FC.shift();e&&c.push(e)}3===c.length?(b.zs.innerHTML=c.join(""),c=Vb("suggest-item",b.zs),B.forEach(c,function(b){this.kx.push(b.id.split("-")[1])},b)):ez(b)},a.ez=function(b){b.zs.innerHTML='<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.kx.join(",")}).done(y(b.OP,b))};
dz.prototype.OP=function(b){b.r||((b=b.msg)&&la(b)&&b.length?(this.kx=[],this.FC=b,fz(this)):this.zs.innerHTML="")};a.gz=function(){U.call(this)};A(gz,U);gz.prototype.init=function(){yr.H(this);this.o(document.body)};
gz.prototype.z=function(){gz.n.z.call(this);var b=K("js-home-feed-list");if(b){var c=new $y;this.H(c);c.o(b)}(b=L("zm-invite-container"))&&(new bz).o(b);K("home-settings-page-wrap")&&(b=K("zh-topic-block-editor"))&&(new Xs(mh)).o(b);(b=K("zh-noti7"))&&(new cz).o(b);if(c=K("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new Kj(c,K("zm-home-sidebar-domain-entry-nav"),b),b&&wd(c,"toggle",function(){Hi("/notifeature?feature=4",l,"GET");return j});$(".zm-side-pinned-topics").on("click",
".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Mt,this.H(c),c.fa("nodeSource").fa("childConstructor",{Qi:yw}),c.o(b),this.m().e(c,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category","debuts").fill("label","debuts")});(new dz).init();var b=T[1],d=K("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(S(d,j),Of.set("reg_noti_",
b,86400)):b===Of.get("reg_noti_")&&S(d,j),P(L("x-m",d),"click",function(){location.hash="";N(d);Of.remove("reg_noti_")}));var e=$(".user-guiding-box");if(0!==e.length){var b=$(".view-avatar",e),c=$(".view-headline",e),g=$(".view-email",e),h=[];c.length&&h.push(c);b.length&&h.push(b);g.length&&h.push(g);var k=function(){var b=h.shift();if(0===h.length)Rk()?Sk(e,"fadeOut",function(){e.remove()}):e.remove();else{var c=h[0];Rk()?Sk(b,"fadeOutRight10",function(){b.remove();c.show();Sk(c,"fadeInLeft10")}):
(b.remove(),c.show())}},n=this;$(".js-noavatar",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"avatar"}});k();hz("close_avatar")});$(".js-noheadline",e).on("click",function(){$.post("/node/HomeGuideV2",{method:"ignore",params:{ignored_entry:"headline"}});k();hz("close_headline")});var q=new Fx(Ex);q.o($(".js-uploadavatar",e));q.on("success",function(b){b.src&&($.post("/node/ProfileHeaderV2",{method:"save",params:{data:{avatar_path:q.getData().id}}},function(b){b&&
!b.r&&$(".avatar-edit-preview-loading").remove()}),$(".zu-top-nav-userinfo img.avatar").attr({src:b.src.url}),k(),hz("upload_avatar"))},m,this);var r=$("form",c);r.validate({submitHandler:function(b){$.post("/node/HomeGuideV2",{method:"add_headline",params:{headline:$('input[name="headline"]',b).val()}},function(b){b&&b.r?263===b.errcode?n.showErrors({headline:"介绍过长"}):n.showErrors({headline:"保存失败"}):(k(),hz("add_headline"))})},messages:{headline:{required:"不能为空",maxlength:"介绍过长"}},rules:{headline:{maxlength:40}},
errorPlacement:function(b){b.appendTo($(".button-wrapper",r))},focusCleanup:j,focusInvalid:m})}var v=$("#js-global-notify");if(v.length){var x=new Yo;x.o(v[0]);Yr(x);$(".zu-global-notify-close",v).click(function(){var b=$(this).data("id");$.post("/notice/read",{nid:b});x.F();v.remove()})}b=Xy.N();Zy(b);var F=$("#js-debuts-entry .tour");F.length&&$(".close-button",F).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});F.fadeOut(100,function(){F.remove()})})};
a.hz=function(b){Bm({t:"event",tid:"zhihu.web.register",action:b})};a.iz=function(){Xh.call(this,l,m);this.NB="zh-lightbox-showing";this.iT="zh-lightbox-thumb";this.hf()};A(iz,Xh);ia(iz);t=iz.prototype;t.hf=function(){this.m().e(document,"click",this.Cr)};
t.Cr=function(b){b=b.target;if("IMG"===b.tagName&&H.has(b,this.iT)){var c=b.getAttribute("data-original");if(c)if(sb)window.open(c);else if(!Ic(b,l,"editable")){this.Aa('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.C(j);H.add(this.h(),"zm-light-box-fullscreen-image");
var c=Yb(),d=K("zm-light-box-x1"),e=K("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";X.ha({type:"ga_click_enlarge_image",target:b})}}};t.X=w;t.focus=w;t.UM=function(){this.C(m);H.remove(document.body,this.NB)};t.gi=function(){iz.n.gi.call(this);H.add(document.body,this.NB);oe(this.m(),document,"click",this.UM)};
t.v=function(){iz.n.v.call(this);H.add(this.h(),"zm-light-box")};t.dy=function(){this.Qc=this.J().v("div",this.yc+"-bg zm-light-box-background");S(this.Qc,m)};iz.N();a.jz=function(b,c,d){Ut.call(this,b,c,d);this.qi(j)};A(jz,Ut);jz.prototype.Xd=function(){return this.dispatchEvent("action")};pj("goog-option",function(){return new jz(l)});a.kz=function(){};A(kz,Tm);ia(kz);kz.prototype.v=function(b){return b.J().v("div",this.L()+" goog-inline-block"," ")};kz.prototype.o=function(b,c){c=kz.n.o.call(this,b,c);H.add(c,"goog-inline-block");return c};kz.prototype.L=s("goog-toolbar-separator");a.lz=function(){};A(lz,Vm);ia(lz);lz.prototype.qc=function(){return Vc.lJ};lz.prototype.Hn=function(b){return"HR"==b.tagName?new Um(kz.N()):lz.n.Hn.call(this,b)};lz.prototype.L=s("goog-toolbar");lz.prototype.zw=function(){return Xm};a.mz=function(){};A(mz,Zt);ia(mz);mz.prototype.L=s("goog-toolbar-button");a.nz=function(b,c,d){yj.call(this,b,c||mz.N(),d)};A(nz,yj);pj("goog-toolbar-button",function(){return new nz(l)});a.oz=function(){};A(oz,au);ia(oz);oz.prototype.createCaption=function(b,c){return oz.n.createCaption.call(this,pz(b,c),c)};a.pz=function(b,c){return c.v("div","goog-color-menu-button-indicator",b)};oz.prototype.Ba=function(b,c){b&&qz(this.R(b),c)};a.qz=function(b,c){if(b&&b.firstChild){var d;d=c&&(ms.test("#"==c.charAt(0)?c:"#"+c)||Ks(c).length||Ms&&Ms[c.toLowerCase()])?tt(c).Or:l;b.firstChild.style.borderBottomColor=d||(C?"":"transparent")}};
oz.prototype.ye=function(b){this.Ba(b.h(),b.S());H.add(b.h(),"goog-color-menu-button");oz.n.ye.call(this,b)};a.rz=function(){};A(rz,cj);ia(rz);a.sz=0;t=rz.prototype;t.v=function(b){var c=this.df(b);return b.J().v("div",c?c.join(" "):l,tz(this,b.bb(),b.Cl(),b.J()))};a.tz=function(b,c,d,e){for(var g=[],h=0,k=0;h<d.height;h++){for(var n=[],q=0;q<d.width;q++){var r=c&&c[k++];n.push(uz(b,r,e))}g.push(e.v("tr",b.L()+"-row",n))}return b.xv(g,e)};t.xv=function(b,c){var d=c.v("table",this.L()+"-table",c.v("tbody",this.L()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Mc(d,"grid");return d};
a.uz=function(b,c,d){b=d.v("td",{"class":b.L()+"-cell",id:b.L()+"-cell-"+sz++},c);Mc(b,"gridcell");return b};t.dc=s(m);t.o=s(l);
t.Aa=function(b,c){if(b){var d=Ub("tbody",this.L()+"-body",b)[0];if(d){var e=0;B.forEach(d.rows,function(b){B.forEach(b.cells,function(b){ic(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Sb(b),k=d.rows[0].cells.length;e<c.length;){var n=c[e++];g.push(uz(this,n,h));g.length==k&&(n=h.v("tr",this.L()+"-row",g),d.appendChild(n),g.length=0)}if(0<g.length){for(;g.length<k;)g.push(uz(this,"",h));n=h.v("tr",this.L()+"-row",g);d.appendChild(n)}}}ug(b,j,D)}};
a.vz=function(b,c,d){for(c=c.h();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&H.has(d,b.L()+"-cell"))return d.firstChild;d=d.parentNode}return l},a.wz=function(b,c,d,e){d&&(d=d.parentNode,H.enable(d,b.L()+"-cell-hover",e),Nc(c.h().firstChild,"activedescendent",d.id))};t.L=s("goog-palette");a.yz=function(b){O.call(this);this.Ad=[];xz(this,b)};A(yz,Gd);t=yz.prototype;t.eg=l;t.pf=l;t.yl=function(){return this.Ad.length};t.Th=function(b){return this.Ad[b]||l};a.xz=function(b,c){c&&(B.forEach(c,function(b){this.qm(b,m)},b),B.extend(b.Ad,c))};t.Ga=function(b){this.Ii(b,this.yl())};t.Ii=function(b,c){b&&(this.qm(b,m),B.$n(this.Ad,b,c))};t.removeItem=function(b){b&&B.remove(this.Ad,b)&&b==this.eg&&(this.eg=l,this.dispatchEvent("select"))};t.Hg=p("eg");t.wb=function(){return B.clone(this.Ad)};
t.qf=function(b){b!=this.eg&&(this.qm(this.eg,m),this.eg=b,this.qm(b,j));this.dispatchEvent("select")};t.Bl=function(){return this.eg?B.indexOf(this.Ad,this.eg):-1};t.ip=function(b){this.qf(this.Th(b))};t.clear=function(){B.clear(this.Ad);this.eg=l};t.w=function(){yz.n.w.call(this);delete this.Ad;this.eg=l};t.qm=function(b,c){b&&("function"==typeof this.pf?this.pf(b,c):"function"==typeof b.vm&&b.vm(c))};a.zz=function(b,c,d){rj.call(this,b,c||rz.N(),d);this.Ki&=-89};A(zz,rj);t=zz.prototype;t.kc=l;t.Eb=-1;t.la=l;t.w=function(){zz.n.w.call(this);this.la&&(this.la.F(),this.la=l);this.kc=l};t.tm=function(b){zz.n.tm.call(this,b);Az(this);this.la?(this.la.clear(),xz(this.la,b)):(this.la=new yz(b),b=y(this.qm,this),this.la.pf=b,this.m().e(this.la,"select",this.oj));this.Eb=-1};t.Fg=s("");t.sm=ca();
t.kd=function(b){zz.n.kd.call(this,b);var c=vz(this.K,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c!=Bz(this)&&Cz(this,c)};t.Wh=function(b){zz.n.Wh.call(this,b);var c=vz(this.K,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c==Bz(this)&&wz(this.K,this,c,m)};t.ve=function(b){zz.n.ve.call(this,b);this.Fb()&&(b=vz(this.K,this,b.target),b!=Bz(this)&&Cz(this,b))};t.Xd=function(b){var c=Bz(this);return c?(this.qf(c),zz.n.Xd.call(this,b)):m};
t.Wb=function(b){var c=this.bb(),c=c?c.length:0,d=this.kc.width;if(0==c||!this.isEnabled())return m;if(13==b.keyCode||32==b.keyCode)return this.Xd(b);if(36==b.keyCode)return this.Ob(0),j;if(35==b.keyCode)return this.Ob(c-1),j;var e=0>this.Eb?this.Bl():this.Eb;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Ob(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Ob(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Ob(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Ob(e+d),b.preventDefault(),j}return m};t.oj=ca();t.Cl=p("kc");a.Dz=function(b,c){b.h()&&f(Error("Component already rendered"));b.kc=oa(c)?new Ob(c,i):c;Az(b)},a.Bz=function(b){var c=b.bb();return c&&c[b.Eb]};t.Ob=function(b){b!=this.Eb&&(Ez(this,this.Eb,m),this.Eb=b,Ez(this,b,j))};a.Cz=function(b,c){var d=b.bb();b.Ob(d?B.indexOf(d,c):-1)};t.Bl=function(){return this.la?this.la.Bl():-1};t.Hg=function(){return this.la?this.la.Hg():l};t.ip=function(b){this.la&&this.la.ip(b)};
t.qf=function(b){this.la&&this.la.qf(b)};a.Ez=function(b,c,d){if(b.h()){var e=b.bb();e&&(0<=c&&c<e.length)&&wz(b.K,b,e[c],d)}};t.qm=function(b,c){this.h()&&b&&H.enable(b.parentNode,this.K.L()+"-cell-selected",c)};a.Az=function(b){var c=b.bb();if(c)if(b.kc&&b.kc.width){if(c=Math.ceil(c.length/b.kc.width),!oa(b.kc.height)||b.kc.height<c)b.kc.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.kc=new Ob(c,c);else b.kc=new Ob(0,0)};a.Fz=function(b,c,d){this.Jq=b||[];zz.call(this,l,c||rz.N(),d);this.Jq=this.Jq;this.Ns=l;this.Aa(B.map(this.Jq,function(b){var c=this.J().v("div",{"class":this.K.L()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=Ls(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};A(Fz,zz);Fz.prototype.Ns=l;Fz.prototype.Iw=function(){var b=this.Hg();return b?(b=wt(b,"background-color"),Gz(b)):l};
Fz.prototype.hp=function(b){b=Gz(b);this.Ns||(this.Ns=B.map(this.Jq,function(b){return Gz(b)}));this.ip(b?B.indexOf(this.Ns,b):-1)};a.Gz=function(b){if(b)try{return tt(b).Or}catch(c){}return l};a.Hz=function(b,c,d,e){cu.call(this,b,c,d||oz.N(),e)};A(Hz,cu);
a.Iz={JU:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),UV:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),xV:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.Jz=
function(b){var c=new Xt(b);J.forEach(Iz,function(d){d=new Fz(d,l,b);Dz(d,8);c.H(d,j)});return c};t=Hz.prototype;t.Iw=function(){return this.S()};t.hp=function(b){this.Ba(b)};t.Ba=function(b){for(var c=0,d;d=this.Th(c);c++)"function"==typeof d.hp&&d.hp(b);Hz.n.Ba.call(this,b)};t.On=function(b){"function"==typeof b.target.Iw?this.Ba(b.target.Iw()):"none"==b.target.S()&&this.Ba(l);Hz.n.On.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.tb=function(b,c){b&&0==this.yl()&&(this.ih(Jz(this.J())),this.Ba(this.S()));Hz.n.tb.call(this,b,c)};pj("goog-color-menu-button",function(){return new Hz(l)});a.Kz=function(){};A(Kz,au);ia(Kz);Kz.prototype.L=s("goog-toolbar-menu-button");a.Lz=function(){};A(Lz,Kz);ia(Lz);Lz.prototype.createCaption=function(b,c){return bu(pz(b,c),this.L(),c)};Lz.prototype.Ba=function(b,c){b&&qz(this.R(b),c)};Lz.prototype.ye=function(b){this.Ba(b.h(),b.S());H.add(b.h(),"goog-toolbar-color-menu-button");Lz.n.ye.call(this,b)};a.Mz=function(b,c,d,e){Hz.call(this,b,c,d||Lz.N(),e)};A(Mz,Hz);pj("goog-toolbar-color-menu-button",function(){return new Mz(l)});a.Nz=function(b,c,d,e){cu.call(this,b,c,d||Kz.N(),e)};A(Nz,cu);pj("goog-toolbar-menu-button",function(){return new Nz(l)});a.Pz=function(b,c,d,e){cu.call(this,b,c,d,e);Oz(this,b);this.fp(Vc.YA)};A(Pz,cu);t=Pz.prototype;t.la=l;t.Iv=l;t.z=function(){Pz.n.z.call(this);Qz(this);Rz(this);Nc(this.h(),Uc.Hk,"false")};t.Z=function(b){Pz.n.Z.call(this,b);(b=this.Fg())?Oz(this,b):this.ip(0)};t.w=function(){Pz.n.w.call(this);this.la&&(this.la.F(),this.la=l);this.Iv=l};t.On=function(b){this.qf(b.target);Pz.n.On.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.oj=function(){var b=this.Hg();Pz.n.Ba.call(this,b&&b.S());Qz(this)};t.ih=function(b){var c=Pz.n.ih.call(this,b);b!=c&&(this.la&&this.la.clear(),b&&(this.la?Ph(b,function(b){Sz(b);this.la.Ga(b)},this):Tz(this,b)));return c};a.Oz=function(b,c){b.Iv=c;Qz(b)};t.Ga=function(b){Sz(b);Pz.n.Ga.call(this,b);this.la?this.la.Ga(b):Tz(this,this.Ua())};t.Ii=function(b,c){Sz(b);Pz.n.Ii.call(this,b,c);this.la?this.la.Ii(b,c):Tz(this,this.Ua())};t.removeItem=function(b){Pz.n.removeItem.call(this,b);this.la&&this.la.removeItem(b)};
t.qf=function(b){if(this.la){var c=this.Hg();this.la.qf(b);b!=c&&this.dispatchEvent("change")}};t.ip=function(b){this.la&&this.qf(this.la.Th(b))};t.Ba=function(b){if(b!=l&&this.la)for(var c=0,d;d=this.la.Th(c);c++)if(d&&"function"==typeof d.S&&d.S()==b){this.qf(d);return}this.qf(l)};t.Hg=function(){return this.la?this.la.Hg():l};t.Bl=function(){return this.la?this.la.Bl():-1};
a.Tz=function(b,c){b.la=new yz;c&&Ph(c,function(b){Sz(b);this.la.Ga(b)},b);Rz(b)},a.Rz=function(b){b.la&&b.m().e(b.la,"select",b.oj)},a.Qz=function(b){var c=b.Hg();b.Aa(c?c.Fg():b.Iv)},a.Sz=function(b){b.fp(b instanceof Ut?Vc.aB:Vc.eJ)};t.tb=function(b,c){Pz.n.tb.call(this,b,c);this.rb()&&this.Ua().Ob(this.Bl())};pj("goog-select",function(){return new Pz(l)});a.Uz=function(b,c,d,e){Pz.call(this,b,c,d||Kz.N(),e)};A(Uz,Pz);pj("goog-toolbar-select",function(){return new Uz(l)});a.Vz=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.Wz=function(b,c){B.forEach(c,function(c){var e=c.caption,c=c.value,g=Vz(c),e=new jz(e,c,b.J());Mh(e,g);b.Ga(e);e.R().style.fontFamily=c})},a.Xz=[10,10,13,16,18,24,32,48],a.Zz=function(b,c,d,e,g,h){d=new nz(Yz(d,e,h),g,h);Mh(d,b);d.Oc(c);return d},a.$z=function(b,c,d,e,g,h){b=Zz(b,c,d,
e,g,h);uj(b,16,j);return b},a.aA=function(b,c,d,e,g,h){g=new Uz(l,l,g,h);e&&B.forEach(e.split(/\s+/),g.yh,g);g.yh("goog-toolbar-select");Oz(g,d);Mh(g,b);g.Oc(c);return g},a.bA=function(b,c,d,e,g,h){d=new Mz(Yz(d,e,h),l,g,h);Mh(d,b);d.Oc(c);return d},a.Yz=function(b,c,d){if((!b||""==b)&&D&&!G("1.9a"))b=" ";return(d||Sb()).v("DIV",c?{"class":c}:l,b)};a.cA=z("Link");z("Edit Link");z("Text to display:");a.dA=z("Link to:");z("Web address");z("Link to a page or file somewhere else on the web");z("Test this link");
z("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});z("To what URL should this link go?");z("Email address");z("Link to an email address");z("Invalid email address");
z("To what email address should this link?");z("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});z("Open this link in a new window");z("Image");a.eA={},a.fA=z("Normal"),a.gA=z("Normal / serif"),a.hA=[{caption:fA,value:"arial,sans-serif"},{caption:gA,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.iA={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.jA=z("Small"),a.kA=z("Normal"),a.lA=z("Large"),a.mA=z("Huge"),a.nA=[{caption:jA,value:1},{caption:kA,value:2},{caption:lA,value:4},{caption:mA,value:6}],a.oA=z("Heading"),
a.pA=z("Subheading"),a.qA=z("Minor heading"),a.rA=z("Normal"),a.sA=[{caption:oA,ua:"H2"},{caption:pA,ua:"H3"},{caption:qA,ua:"H4"},{caption:rA,ua:"P"}],a.tA=function(b,c,d,e,g,h){var k=Zz(b,c,d,e,g,h);k.wi=function(b){k.Za(b)};return k},a.uA=function(b,c){var d=c;try{if(C)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.S()&&b.Ba(d)}catch(h){}},a.vA=z("Format"),a.wA=z("Format"),a.xA=z("Undo"),a.yA=z("Redo"),a.zA=z("Font"),a.AA=z("Font size"),
a.BA=z("Text color"),a.CA=z("Bold"),a.DA=z("Italic"),a.EA=z("Underline"),a.FA=z("Text background color"),a.GA=z("Add or remove link"),a.HA=z("Numbered list"),a.IA=z("Bullet list"),a.JA=z("Decrease indent"),a.KA=z("Increase indent"),a.LA=z("Align left"),a.MA=z("Align center"),a.NA=z("Align right"),a.OA=z("Justify"),a.PA=z("Remove formatting"),a.QA=z("Insert image"),a.RA=z("Strikethrough"),a.SA=z("Left-to-right"),a.TA=z("Right-to-left"),a.UA=z("Quote"),a.VA=z("Edit HTML source"),a.WA=z("Subscript"),
a.XA=z("Superscript"),a.YA=z("Edit HTML"),a.ZA={};
eA.WA=[{ua:"+undo",Q:xA,Ka:"tr-icon tr-undo",factory:tA,eb:j},{ua:"+redo",Q:yA,Ka:"tr-icon tr-redo",factory:tA,eb:j},{ua:"+fontName",Q:zA,Ka:"tr-fontName",factory:function(b,c,d,e,g,h){var k=aA(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in iA&&(c=iA[b]);c.length&&Wz(k,c);Wz(k,hA);Oz(k,fA);H.add(k.Ua().R(),"goog-menu-noaccel");k.wi=function(b){var c=l;b&&0<b.length&&(c=Nh(k.Ua(),Vz(b)));c!=k.Hg()&&k.qf(c)};return k},eb:j},{ua:"+fontSize",Q:AA,Ka:"tr-fontSize",factory:function(b,c,
d,e,g,h){var k=aA(b,c,d,e,g,h);B.forEach(nA,function(b){var c=b.value,b=new jz(b.caption,c,k.J());k.Ga(b);b=b.R();b.style.fontSize=(Xz[c]||10)+"px";b.firstChild.style.height="1.1em"});Oz(k,kA);H.add(k.Ua().R(),"goog-menu-noaccel");k.wi=function(b){var c;if(c=na(b))c=b.match(Ns),c="px"==(c&&c[0]||l);c&&(b=B.lastIndexOf(Xz,parseInt(b,10)));b=0<b?b:l;b!=k.S()&&k.Ba(b)};return k},eb:j},{ua:"+bold",Q:CA,Ka:"tr-icon tr-bold",eb:j},{ua:"+italic",Q:DA,Ka:"tr-icon tr-italic",eb:j},{ua:"+underline",Q:EA,Ka:"tr-icon tr-underline",
eb:j},{ua:"+foreColor",Q:BA,Ka:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=bA(b,c,d,e,g,h);b.hp("#000");b.wi=xa(uA,b);return b},eb:j},{ua:"+backColor",Q:FA,Ka:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=bA(b,c,d,e,g,h);b.hp("#FFF");b.wi=xa(uA,b);return b},eb:j},{ua:"+link",Q:GA,caption:cA,Ka:"tr-link",eb:j},{ua:"+insertOrderedList",Q:HA,Ka:"tr-icon tr-insertOrderedList",eb:j},{ua:"+insertUnorderedList",Q:IA,Ka:"tr-icon tr-insertUnorderedList",eb:j},{ua:"+outdent",Q:JA,Ka:"tr-icon tr-outdent",
factory:Zz},{ua:"+indent",Q:KA,Ka:"tr-icon tr-indent",factory:Zz},{ua:"+justifyLeft",Q:LA,Ka:"tr-icon tr-justifyLeft",eb:j},{ua:"+justifyCenter",Q:MA,Ka:"tr-icon tr-justifyCenter",eb:j},{ua:"+justifyRight",Q:NA,Ka:"tr-icon tr-justifyRight",eb:j},{ua:"+justifyFull",Q:OA,Ka:"tr-icon tr-justifyFull",eb:j},{ua:"+removeFormat",Q:PA,Ka:"tr-icon tr-removeFormat",factory:Zz},{ua:"image",Q:QA,Ka:"tr-icon tr-image",factory:Zz},{ua:"+strikeThrough",Q:RA,Ka:"tr-icon tr-strikeThrough",eb:j},{ua:"+subscript",Q:WA,
Ka:"tr-icon tr-subscript",eb:j},{ua:"+superscript",Q:XA,Ka:"tr-icon tr-superscript",eb:j},{ua:"ltr",Q:SA,Ka:"tr-icon tr-ltr",eb:j},{ua:"rtl",Q:TA,Ka:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var k=$z(b,c,d,e,g,h);k.wi=function(b){b=!!b;H.enable(k.getParent().h(),"tr-rtl-mode",b);k.$c(b)};return k},eb:j},{ua:"+BLOCKQUOTE",Q:UA,Ka:"tr-icon tr-BLOCKQUOTE",eb:j},{ua:"+formatBlock",Q:vA,caption:wA,Ka:"tr-formatBlock",factory:function(b,c,d,e,g,h){var k=aA(b,c,d,e,g,h);B.forEach(sA,function(b){var c=
b.caption,b=b.ua,d=k.J(),c=new jz(d.v("DIV",l,c),b,d);Mh(c,b);k.Ga(c)});Oz(k,rA);H.add(k.Ua().R(),"goog-menu-noaccel");k.wi=function(b){b=b&&0<b.length?b:l;b!=k.S()&&k.Ba(b)};return k},eb:j},{ua:"editHtml",Q:VA,caption:YA,Ka:"tr-editHtml",factory:Zz}];for(var $A=0,aB;aB=eA.WA[$A];$A++)ZA[aB.ua]=aB;delete eA.WA;a.bB={};bB.tT=$k;a.cB=function(b){$u.call(this);this.ca=new me(this);this.uE=M("div",{style:"display:none"});this.g=this.pc=l;this.D={};J.extend(this.D,this.defaults,b||{})};A(cB,$u);ya(cB.prototype,bB);cB.prototype.defaults={uk:l,title:"Distraction Free Mode",eK:"back",aS:"publish",uw:"zu-editing-distraction-free",TS:"sticky-goog-scrollfloater",qT:"zm-editable-toolbar-container"};cB.prototype.jd=mf("FullScreenPlugin");ZA.toggleFullScreen={ua:"toggleFullScreen",Q:"写作模式",Ka:"tr-icon tr-max",factory:Zz};t=cB.prototype;
t.Be=xa(J.yg,{eW:"toggleFullScreen",zU:"enterFullScreen",AU:"exitFullScreen"});t.w=function(){this.ca.F();N(this.g);this.D=this.Ap=this.pc=this.ub=this.g=l;cB.n.w.call(this)};
t.ev=function(){var b=this.D,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.eK+'" name="return">返回</a><a href="#" class="'+b.aS+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.ca.e(L("back",c),"click",function(b){b.preventDefault();dB(this)},m,this);this.ca.e(L("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&dB(this)},m,this);this.g=c;this.pc=L("content",c);this.Ap=M("div",{className:"toolbar-info"});this.D.uk||(this.D.uk=this.B.field)};a.eB=function(b){if(b.Ap){var c=$(b.Ap);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}};t.$e=function(b){this.g||this.ev();switch(b){case "enterFullScreen":fB(this);break;case "exitFullScreen":dB(this);break;case "toggleFullScreen":this.Gx()?dB(this):fB(this)}};
t.Gx=function(){return H.has(document.body,this.D.uw)};
a.fB=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.aD||(b.ON=history.length);b.aD=j;gB(b,"writing");b.yI=Lc(Sb((ga||window).document));mc(b.uE,b.D.uk);b.pc.appendChild(b.D.uk);H.add(document.body,b.D.uw);b.ub=L(b.D.qT,b.g);b.ub.appendChild(b.Ap);var c=b.g;c.scrollTop=0;var d=b.ub.getBoundingClientRect().top;c.onscroll=qf(y(b.xH,b),function(){return c.scrollTop>d});b.ca.e(document,"keydown",b.Ho,m,b);Ma(Fc(b.B.field))||b.B.Qf();b.dispatchEvent("enterFullScreen")}},a.dB=function(b){!Pg&&
b.aD&&b.ON!==history.length?history.back():gB(b,"");b.ub.removeChild(b.Ap);b.xH(m);b.g.onscroll=l;b.ca.Fa(document,"keydown",b.Ho,m,b);mc(b.D.uk,b.uE);H.remove(document.body,b.D.uw);window.scrollTo(b.yI.x,b.yI.y);b.dispatchEvent("exitFullScreen")},a.gB=function(b,c){xd(window,"hashchange",b.eG,m,b);location.hash=c||"";setTimeout(y(function(){this.ca.e(window,"hashchange",this.eG,m,this)},b))};t.eG=function(){this.Gx()?dB(this):"writing"===location.hash.slice(1)&&fB(this)};
t.Ho=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&dB(this)};t.xH=function(b){H[b?"add":"remove"](this.ub,this.D.TS)};a.iB=function(b,c){O.call(this);this.Yf=b;this.Gz=c||hB;b.ob||(this.show=w)};A(iB,Lm);a.hB="加载中...";t=iB.prototype;
t.show=function(){kc(this.g=M("div","zg-mt10",[M("h3",{style:"margin:0 0 5px;"},"分享到微博"),M("div","zm-tab-content",[this.yW=M("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> '}),M("div","zg-section",M("div","zg-form-text-input",this.jp=M("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),M("div","zm-command",[M("div",["zm-item-meta","zg-left"],this.rS=
M("span")),this.VS=M("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),K("zh-question-answer-form-wrap"));this.m().e(X,"sina_callback",function(b){this.Cz(b.Kc.id,b.Kc.name)});this.Wu();this.Tj();Pm.N().refresh();var b=this;this.Gz===hB?Hi("/answer/"+b.Yf.ob+"/sharetext",function(c){if((c=Je(c.target))&&c.sina)b.Gz=c.sina,b.pb()},"GET"):this.pb()};t.Cz=function(b,c){sh.name=c;this.GS=sh.id=b;this.uc.checked=j;this.Tj()};
t.Tj=function(){var b=L("weibo-share-button",this.g),c=this.uc.checked;H.enable(b,"zg-btn-blue",c);H.enable(b,"zg-btn-disabled",!c)};t.pb=function(){this.jp.value=this.Gz;this.Rz=new Sm(this.jp);this.EH=new Au(this.jp,this.rS,140,yu);this.m().e(this.VS,"click",this.ta)};t.Wu=function(){this.uc=L("sina-checkbox",this.g);this.m().e(this.uc,"change",this.Hy)};t.Hy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.uc&&!this.GS?(window.open(c),b.checked=m):this.Tj()};
t.ta=function(b){if((b=b.target)&&H.has(b,"zg-btn-blue")&&this.jp.value){b=new Xk(j);b.add("content",this.jp.value);var c=[];this.uc.checked&&c.push("sina");b.add("via",c.join(","));this.Yj(b);$k("share",this.yX?"answer_weibo":"question_weibo")}else V("请您选择或绑定微博后再进行分享！")};t.Yj=function(b){b.add("aid",this.Yf.ga);this.xhr=new W(j);oe(this.m(),this.xhr,"complete",this.Ku);this.xhr.ajax("/answer/share",b.hd())};t.Ku=function(){var b=Je(this.xhr);b&&b.r?V(b.msg):(V("分享发送完毕"),S(this.g,m))};a.jB=function(b,c,d){Ut.call(this,b,c,d);this.ap(j)};A(jB,Ut);pj("goog-checkbox-menuitem",function(){return new jB(l)});a.kB=function(b,c){O.call(this);this.ia=b;this.Jb=c;this.data=gh};A(kB,Lm);t=kB.prototype;
t.init=function(){this.hm=K("zh-question-redirect-info");this.hm.innerHTML&&(this.lo=j);this.m().e(this.hm,"click",function(b){"cancel"===b.target.name&&lB(this)});var b=K("zh-question-side-header-wrap");if(eh.tc&&!eh.aF&&b){var c=K("zh-question-filter-wrap");c?jc(b,c):b.style[C?"styleFloat":"cssFloat"]="none"}(this.Zf=K("zh-question-operation-menu"))&&this.vj();this.m().e(Ni,"anon_change",function(b){var c=K("zh-question-side-invitation-anon");c&&S(c,b.jb);(c=K("zh-question-side-invitation-notanon"))&&
S(c,!b.jb);this.$l&&this.$l.Za(mt(this.data.bh)||!b.jb)});(this.yk=K("zh-question-webshare-container"))&&this.m().e(this.yk,"click",this.Nz)};
t.vj=function(){this.cb=new Xt;var b=this.data.Sm,c=this.Zf.getAttribute("data-auth"),c=c?c.split(","):[];if(b==l||0===b){this.cb.Ga(this.Ts=mB("使用匿名身份",j));this.Ts.$c(this.data.jb);if((!nh||!B.contains(nh,"question_op_redirect"))&&"close"!==gh.status)this.cb.Ga(this.$l=mB(this.lo?"撤消重定向":"问题重定向")),this.$l.Za(mt(this.data.bh)||!this.data.jb);B.contains(c,"auth-f-manage")&&this.cb.Ga(this.LQ=mB("更新话题页显示",m));this.m().e(this.cb,"action",this.nj);this.Ts&&this.m().e(Ni,"anon_change",function(b){this.Ts.$c(!!b.jb)});
this.Jb&&B.contains(c,"auth-pu-mark")&&(this.cb.Ga(this.Jy=mB("优质回答",j)),this.Jy.$c(this.Jb.CO));b=new cu("Settings",this.cb);b.ek=j;fu(b);b.o(this.Zf)}};a.mB=function(b,c){return!b?new Wt:c?new jB(b):new Ut(b)};
t.nj=function(b){var c=this.Ts;if(b.target===c)ds(c.Ae()?1:0,function(b){b||c.$c(!c.Ae())});else if(b.target===this.$l){if(ry({fm:j})()===m)return m;this.Po||(this.Po=new $x(this.ia),this.m().e(this.Po,"change",this.eP));this.cb.C(m);this.lo?lB(this):this.Po.show()}else b.target===this.GQ?Hi("/question/"+this.data.ob+(this.GQ.Ae()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+gh.ob:window.location.reload()},"POST"):b.target===this.LQ?$.post("/refresh_topic_feeds",
{q:gh.ob}).done(function(b){b.r||V("操作成功！")}):b.target===this.Jy&&$.post("/answer/"+this.Jb.ob+(this.Jy.Ae()?"/good_mark":"/good_unmark")).done(function(b){b.r||V("操作成功！")})};t.eP=function(){this.hm.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.Po.st+'">'+this.Po.OG+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';S(this.hm,j);this.lo=j;this.$l.sm("撤消重定向")};
a.lB=function(b){b.hm.innerHTML="";S(b.hm,m);b.lo=m;b.$l.sm("问题重定向");Hi("/question/unredirect",l,"POST","qid="+b.ia+"&rqid="+b.st)};t.Nz=function(b){var c=Wk(this.yk,b.target);c&&c.name&&Km(function(){var b=$("#zh-question-webshare-container").data();Du([b.title,b.type,b.urlToken,{answer:{aid:b.id},question:{qid:b.id}}[b.type]],"tb-webshare-"+c.name);X.ha({type:"ga_click_share_question_box",target:c,data:{type:c.name}})},function(){return{ed:"letter"===c.name}})()};a.nB=function(b){tp.call(this,j,"/topic/bio/update","bio");this.Cp=b[0];this.params=["tid="+this.Cp[3]];this.content=b[1];this.Ib='<a href="javascript:;" name="edit">描述你关于 '+this.Cp[0]+" 的经验</a>";this.du=j};A(nB,tp);nB.prototype.Hh=function(){nB.n.Hh.call(this);this.Yk.innerHTML="更新"};nB.prototype.Z=function(b){nB.n.Z.call(this,b);var b=this.J(),c=b.v("strong",l,M("a",{href:"/topic/"+this.Cp[1],title:this.Cp[0],"class":""},this.Cp[0]));b.ao(c,this.Rb)};a.oB=function(b,c){O.call(this);this.gO=c;this.dl=b;this.items=[];this.BY="/url_to_fetch_question_related_topic_bio_items";this.Xx=m};A(oB,Lm);
a.pB=l,a.qB=function(){pB||(pB=new oB(ih,m));return pB},a.rB=function(b){if(!b.locked)if(!b.mP&&b.Xx){b.locked=j;var c=new W(j);b.m().e(c,"success",function(b){this.mP=j;this.locked=m;b=Je(b.target);b.r||(this.dl=b.msg,rB(this))});c.ajax("/question/"+b.YG+"/bios",l,"GET")}else b.ba||(b.ba=new Ai,b.ba.Ta("修改话题经验"),ii(b.ba,l),ci(b.ba,m),c=b.ba.R(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.W(c)),b.ba.C(j)};
oB.prototype.W=function(b){this.g=M("div","zu-bio-editor-wrap",[this.jO=M("div","zu-bio-editor-inner-wrap"),this.zc=M("div","zm-command",[this.Yk=M("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);B.forEach(this.dl,function(b){b=new nB(b);b.W(this.jO);this.items.push(b)},this);this.gO&&S(this.zc,m);b.appendChild(this.g);this.m().e(this.zc,"click",this.ta)};
oB.prototype.ww=function(){var b=this.items.length,c;if(!b&&this.dl.length)for(c=0;c<this.dl.length;c++)if(this.dl[c][1])return this.dl[c][1];var d=l;for(c=0;c<b;c++)if(d=this.items[c].bb())return d};oB.prototype.ta=function(b){if((b=this.cf(b.target))&&"save"===b.name)this.ba&&this.ba.C(m),this.dispatchEvent("change")};a.sB=function(b,c){U.call(this);this.mb=b;this.aX=this.mb.tr();this.nr=Xr(this.mb);this.isContentEditable=this.mb.isContentEditable();this.kT=30;this.ad=new Id(1E3*this.kT);this.ia=gh?gh.ia:0;this.SE=c||m};A(sB,U);t=sB.prototype;t.w=function(){tB(this);this.ad.F();sB.n.w.call(this)};
t.o=function(b){this.g=b;this.Zr=L("draft-saved-info",b);S(this.Zr,m);this.FE=L("draft-saved-time",b);this.JK=L("draft-clear-button",b);this.NW=this.isContentEditable?iv:["change","input"];b=this.m().e(this.ad,Jd,this.tt).e(this.JK,"click",this.KK).e(this.nr,"keydown",this.OO);"oninput"in this.nr&&!C?b.e(this.nr,"input",this.lO):b.e(this.nr,"keydown",this.mO);var c=dh.Gd&&1E3*dh.Gd[1];c&&(uB(this,c),this.kA=setInterval(y(function(){uB(this,c)},this),22E3))};
t.OO=function(b){if((b.metaKey||b.ctrlKey)&&"s"===tk[b.keyCode])this.bP(),this.isContentEditable||b.preventDefault()};a.wB=function(b){vB(b,"保存中…");b.zn();b.kO()};t.zn=function(){$(window).on("beforeunload.DraftSaver",y(s("你的修改还未成功保存，确认离开该页面吗？"),this))};t.fl=function(){$(window).off("beforeunload.DraftSaver")};t.lO=function(){xB(this);wB(this)};t.mO=function(b){uh(b.keyCode)&&(xB(this),wB(this))};a.xB=function(b){b.ad.stop()};t.Aa=function(b){this.mb.Aa(b);this.mb.cp()};t.bb=function(){return this.mb.ef()};
t.jH=function(){if(!this.If){var b=this.bb();if(b){vB(this,"保存中…");var b=(new Ul).add("qid",this.ia).add("content",b),c=new W;c.ajax("/answer/draft/save",b.toString(),"POST");this.m().e(c,"success",y(this.Xg,this));this.iF=c}}};t.NT=150;t.tt=il(sB.prototype.NT,sB.prototype.jH);t.cP=350;t.bP=il(sB.prototype.cP,sB.prototype.jH);t.nO=3E3;t.kO=il(sB.prototype.nO,function(){this.If||(this.bb()?this.tt():yB(this))});a.tB=function(b){b.kA&&(clearInterval(b.kA),b.kA=l)};
t.Xg=function(b){var b=Je(b.target),c="",d=m;0===b.r?c="已保存":(c=b.msg||"保存失败！请稍后再试。",d=j);tB(this);S(this.Zr,j);vB(this,c,d);this.fl();"保存成功"===b.msg&&this.dispatchEvent("saveContent");this.ad.start()};a.uB=function(b,c){var d=ht(c||Aa());/^\d/.test(d)&&(d=" "+d);vB(b,"已存于"+d)},a.vB=function(b,c,d){var e=$(b.FE);d?e.addClass("warning"):e.removeClass("warning");S(b.Zr,j);xc(b.FE,c)};
t.KK=function(b){b.preventDefault();Ei("清除草稿",this.SE?"你确定要清除保存的草稿并取消编辑吗？":"你确定要清除保存的草稿吗？",function(b){b&&(this.SE?(yB(this),this.mb.dispatchEvent("cancel_edit"),this.mb.ri()):(this.Aa(""),yB(this),this.mb.ready(function(){var b=this.Ja;this.Od?as(b,b.value.length):b.field.lastChild?Zr(b.field.lastChild):b.Qf();this.kl&&(this.kl.scrollTop=this.kl.scrollHeight)})))},this)};a.yB=function(b){Hi("/draft/delete",l,"POST","qid="+b.ia);b.iF&&(b.iF.abort(),b.fl());tB(b);S(b.Zr,m);b.dispatchEvent("clearContent")};a.zB=function(b,c,d){vp.call(this,m);this.jb=!!b;this.mg=c;this.Ib="&nbsp;";this.uq=d;this.cu=this.Uv=this.sD=this.enabled=j;if(T.Hi||!T.oa())this.by='<span style="font-style: normal;color: #999;">写回答…</span>'};A(zB,vp);t=zB.prototype;t.GD=function(){var b=Ub("h2","zm-editable-content",K("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Fc(b):b.firstChild.nodeValue)||"",uk:this.$i}};t.ww=p("uq");t.yt=da("jb");
a.AB=function(b,c){b.uq=c?c:T[4];if(b.fs&&$.trim(c)){var d=c;20<d.length&&(d=d.substring(0,17)+"...");b.mK.innerHTML="，"+Wa(d)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>'}};t.Za=function(b,c){this.enabled=b;this.fs?(this.ri(),this.Ib=c,this.Rb.innerHTML=this.Ib):c&&(this.Ib=c)};t.Z=function(b){zB.n.Z.call(this,b);this.fs=j;H.add(this.Rb,"zu-answer-form-disabled-wrap")};t.w=function(){this.bs&&(N(this.bs),this.pI=this.bs=l);zB.n.w.call(this)};
t.jj=function(b){this.yt(b.jb);this.hq&&(this.hq.checked=b.jb)};t.z=function(){zB.n.z.call(this);this.m().e(Ni,"anon_change",this.jj)};
t.Ag=function(){zB.n.Ag.call(this);var b=this.J(),c=T.oa();this.bs=b.v("div","zh-answer-form clearfix",[c?lt(this.mg):"",this.pI=b.v("div",l,[b.v("div","zu-answer-form-title",[c?kt(this.mg):"我来回答这个问题",this.mK=b.v("span")])])]);AB(this,this.uq);b.ao(this.bs,this.$i);this.m().e(this.pI,"click",this.ta);T.oa()?T.Hi||BB(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>'):BB(this,
'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>')};a.BB=function(b,c,d){c=$(c).css("top",0).css("z-index",9);$(b.zc).hide();d=$(d);$(b.$i).append(c).after(d);b=Km(w,{oa:"question_answer_add_start",ed:j},"#draft");c.on("click",b);d.on("click",b)};
t.Ar=function(b){switch(b){case "edit_bio":b=qB();if(!this.Xu){var c=gh.ob;b.Xx=j;b.YG=c;this.m().e(b,"change",this.wy)}this.Xu=j;rB(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.Ck?this.Ck.show():(d.Ck=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
d.Ck.on("click",'[name="cancel"]',function(){d.Ck.hide()}).on("click",'[name="confirm"]',function(){d.Ck.hide();$(d.Rb).hide();d.Za(j);d.sf()}),$(d.Rb).after(d.Ck))}return j};t.me=function(){"editing"===this.status?this.Bb&&S(this.Bb,j):this.Bb&&S(this.Bb,m);S(this.fd,m);this.Rb&&S(this.Rb,!this.enabled)};t.SK='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.Hh=function(){var b=cl(this.SK);this.zc=fc(b({questionStatus:gh.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[gh.status]}));this.Yk=$(".submit-button",this.zc)[0];var b=$("input[name=anno-checkbox]",this.zc)[0],c=$("label",this.zc)[0];this.hq=b;gh.jb&&(this.hq.checked=j);ug(c,j);this.Bb.appendChild(this.zc);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.xx,m,this)})};
t.xx=function(){var b=new sB(this);Rc(this,b);this.m().e(b,"saveContent",function(){var b=!this.Od&&this.Ja.Uh("FullScreenPlugin");b&&eB(b)},m,this);var c=Xr(this);this.m().e(c,"focus",function(){b.ad.start()}).e(c,"blur",function(){xB(b);b.tt()}).e(this,"saveSuccess",function(){xB(b);yB(b)});b.o(this.zc);this.UC=b};t.wy=function(){var b=qB().ww();b&&AB(this,b)};a.CB=function(b,c,d,e,g,h){vp.call(this,e,c,d,h);this.ia=b;this.jo=this.To=m;this.SQ=g};A(CB,vp);a.DB=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=CB.prototype;t.o=function(b){CB.n.o.call(this,b);this.m().e(Ni,"anon_change",this.jj)};t.jj=function(b){this.jo||H.enable(this.g,"zm-editable-disabled",b.jb)};
t.Hh=function(){CB.n.Hh.call(this);var b=M("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=M("select",{style:"1px solid #999 "}),d=M("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);B.forEach(DB,function(b,d){var e=M("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.cz=M("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.jY=c,this.GF=M("span"),this.vR=
M("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.uR=M("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);jc(this.cz,this.zc);this.To&&this.oi(" * 必选","zg-gray-normal");var e=Ub("select",l,this.cz)[0];this.m().e(e,"change",function(){S(this.vR,"other"===e.value);this.oi(" * 必选","zg-gray-normal")})};
t.Xg=function(b){var c=Ub("select",l,this.cz)[0],d=c.value;if(this.To){if("none"===d){this.oi("请选择一个修改理由");return}if("other"===c.value&&(d=Lk(this.uR.value),!d)){this.oi("请填写修改理由");return}}"title"===this.Uq&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.oi("还没有输入问号"):("none"===d&&(d=""),this.params=["id="+this.ia+"&reason="+encodeURIComponent(d)+"&question_id="+this.ia],this.dispatchEvent("change"),CB.n.Xg.call(this,b),this.oi("* 必选","zg-gray-normal"),this.To=j)};
t.oi=function(b,c){this.GF.innerHTML=b;H.set(this.GF,c||"zg-error-text")};t.ef=function(){return this.Od&&this.SQ?Mk(Ja(this.Ja.value)):CB.n.ef.call(this)};t.Ze=function(){$(window).on("beforeunload.EditorWithReason",y(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Hf=function(){$(window).off("beforeunload.EditorWithReason")};t.ri=function(){CB.n.ri.call(this);this.Hf()};t.sf=function(){CB.n.sf.call(this);this.Ze()};a.EB=function(b,c){Xt.call(this,b,c);this.Qm=j;this.Ke(j);this.C(m,j);this.uf=new Od};A(EB,Xt);t=EB.prototype;t.nT=m;t.eF=0;t.Ve=l;t.Z=function(b){EB.n.Z.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.J().h(b),1)};t.z=function(){EB.n.z.call(this);Md.forEach(this.uf,this.CB,this);var b=this.m();b.e(this,"action",this.BP);b.e(this.J().Da(),"mousedown",this.aG,j);E&&b.e(this.J().Da(),"contextmenu",this.aG,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.uf.Id(ua(b)))b?(c={g:b,NH:c,kP:d,dD:e?"contextmenu":"mousedown",ey:g},this.uf.set(ua(b),c),b=c):b=l,this.ya&&this.CB(b)};t.CB=function(b){this.m().e(b.g,b.dD,this.rG)};t.detach=function(b){(!b||!this.uf.Id(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.ya){var c=this.uf.get(b);this.m().Fa(c.g,c.dD,this.rG)}this.uf.remove(b)};
a.FB=function(b,c,d,e,g){var h=b.P();b.Kx()&&b.nT?b.hide():(b.Ve=g||l,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.h().style.visibility="hidden"),S(b.h(),j),c.X(b.h(),d,e),h||(b.h().style.visibility="visible"),b.Ob(-1),b.C(j)))};t.CH=function(b,c,d){c=ka(b.NH)?new Ps(b.g,b.NH,j):new Os(c,d);c.um&&c.um(5);FB(this,c,b.kP,b.ey,b.g)};t.hide=function(){this.P()&&(this.C(m),this.P()||(this.eF=Aa(),this.Ve=l))};t.Kx=function(){return this.P()||150>Aa()-this.eF};t.BP=function(){this.hide()};
t.rG=function(b){for(var c=this.uf.Db(),d=0;d<c.length;d++){var e=this.uf.get(c[d]);if(e.g==b.currentTarget){this.CH(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.aG=function(b){this.P()&&!this.Ef(b.target)&&this.hide()};t.Vc=function(b){EB.n.Vc.call(this,b);this.hide()};t.w=function(){EB.n.w.call(this);this.uf&&(this.uf.clear(),delete this.uf)};a.GB=function(){U.call(this)};A(GB,U);GB.prototype.H=function(b,c){GB.n.H.call(this,b,c);this.m().e(b,"beforeexpand",this.AN)};GB.prototype.AN=function(b){var c=b.target;Ph(this,function(b){c!==b&&b.Gc()&&b.Na(m)})};GB.prototype.F=function(){this.m().F();GB.n.F.call(this)};a.HB=function(){Ai.call(this);this.Cg=j;this.C(j)};A(HB,Ai);HB.prototype.z=function(){HB.n.z.call(this);Ci(this,490);$(this.h()).addClass("user-guiding-dialog")};HB.prototype.Dd=function(b){$('[class^="view"]',this.g).hide();$(".view-"+b,this.g).show()};a.IB=function(b,c){U.call(this);this.sR=b;this.et=c;this.tO=this.Y=l;this.af=m;this.bo=l;this.Nl=[];this.KH=[];this.Zg=j;this.$O="loading";this.OE="zg-btn-white";this.uO="invite-button"};A(IB,U);t=IB.prototype;t.v=function(){this.g=M("div",{style:"display:none",className:"question-invite-panel"})};
t.z=function(){IB.n.z.call(this);var b=this.g,c=this.m();if(!this.Zg){c.e(Ni,"anon_change",this.reload);var d=L("cancel-anon",b);d&&c.e(d,"click",this.uM);if(!L("error-message")){var d=L("search-input",b),e=L("invite-title",b);this.Cx=L("invite-status",b);c.e(this.Cx,"click",this.vM);var g=L("suggest-persons",b);g&&(c.e(g,"click",this.Zw),this.JH=g);$(".invite-status",b).on("mouseenter mouseleave",".invited-shortlist",function(b){$(".invited-hovercard",this).toggleClass("in","mouseenter"===b.type)});
this.ux(d,e);this.KH=$(this.JH).children().map(this.DG).get();this.Nl=$(".invited-fulllist",this.Cx).children().map(this.DG).get();var h=function(b){0>b||b>n-1||(v.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?q.addClass("link-disabled"):q.removeClass("link-disabled"),b===n-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),k=b)},b=this.g,k=0,n,q,r,v;v=$(".suggest-persons",b);n=v.find("li").length/4;q=$(".js-prev",b).on("click",function(){h(k-1)});r=$(".js-next",b).on("click",function(){h(k+
1)});h(0);S(this.g,this.af)}}};t.ib=function(){IB.n.ib.call(this);this.m().F()};t.Pi=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.Gc()?this.ck():this.Zg=j};t.ck=function(){var b=this,c=this.$O;this.ib();H.add(this.g,c);this.g.innerHTML=this.Pi();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.sR}}).done(function(d){b.Zg=m;H.remove(b.g,c);d=fc(Ma(d));S(d,b.Gc());mc(d,b.g);b.g=d;b.z()})};
t.w=function(){IB.n.w.call(this);this.tO=l;this.Y.F()};t.Gc=p("af");t.expand=function(){this.Na(j)};t.collapse=function(){this.Na(m)};t.Na=function(b){if(b!==this.af){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=y(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.Zg?this.ck().done(c):c();this.af=b;S(this.g,b)}};t.yf=function(){this.Na(!this.af)};
t.ux=function(b){var c=this,d=cl('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.Y=new um(b,{Vd:8,source:"/people/autocomplete?type=invite",ji:b.offsetParent,placeholder:"搜索你想邀请的人",Zc:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return B.filter(b,function(b){var d=b.id;return!B.find(c.Nl,function(b){return b.id===
d})})},select:function(b){JB(c,"ask_to_answer_search");ot(c.et,b.id,"search").done(function(d){if(d.r)return V(d.msg);KB(c,b);LB(c,b.id,j)});return""}})};a.MB=function(b,c,d){b=b.OE;d?(H.add(c,b),xc(c,"收回邀请")):(H.remove(c,b),xc(c,"邀请回答"))};t.uM=function(){ds(0)};a.JB=function(b,c){var d=gh;b.dispatchEvent(new Pv("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.XE?l:d.ke}))};
t.Zw=function(b){var c=b.target;if("BUTTON"===c.tagName||H.has(c,this.uO)){this.bo&&"pending"===this.bo.state()&&this.bo.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";JB(this,b);var d=c.getAttribute("data-uid"),e=this.OE,g=y(function(b){b?(MB(this,c,j),b=B.find(this.KH,function(b){return b.id===d}),KB(this,b),this.BK()):(MB(this,c,m),NB(this,d))},this);H.has(c,e)?(this.bo=nt(this.et,d),g(m)):(this.bo=ot(this.et,d,b).done(function(b){b.r&&
(V(b.msg),g(m))}),g(j))}};t.vM=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),nt(this.et,b),LB(this,b,m),NB(this,b))};a.LB=function(b,c,d){var e=$(".invite-button",b.JH).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&MB(b,e,d)};t.DG=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.KB=function(b,c){b.Nl.unshift(c);OB(b);$(".ignore-invite-hint").css("display","none")},a.NB=function(b,c){b.Nl&&B.GR(b.Nl,function(b){return b.id===c})&&(OB(b),$(".ignore-invite-hint").css("display","none"))};t.sS='你已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.cM='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.OB=function(b){var c=b.Nl,d={each:B.forEach,fullList:function(){return cl(b.cM,{persons:c,helper:d})}};b.Cx.innerHTML=c.length?cl(b.sS,{persons:c,helper:d}):""};t.BK=zi(function(){T.bh&&$.post("/question/popup",{action:"invite",question_token:gh.ob},function(b){if(b){var c=new HB;c.Ta("邀请回答小窍门");c.Aa(b);c.X();$(".js-close",c.g).on("click",function(){c.C(m)})}})});a.PB=function(b){this.data=b;this.ma=l};A(PB,U);t=PB.prototype;
t.z=function(){PB.n.z.call(this);this.m().e(this.g,"click",this.Ko);var b=L("panel-container",this.g);b&&(this.Ul=new GB,this.H(this.Ul),this.Ul.o(b),this.ma=new bw(this.data.ia,"question"),this.Ul.H(this.ma),gw(this.ma,this.Ul.h(),$(".toggle-comment",this.g)[0]),this.wj(),"normal"===gh.status&&(b=new IB(this.data.ia,this.data.ob),b.W(this.Ul.h()),this.Ul.H(b),gh.BS&&(b.expand(),this.dispatchEvent(new Pv("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))),this.NE=b));
this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.vc.fill("label","question")})};t.wj=function(){var b=$("a[name=report-question]",this.h());b.length&&mu(new ju("question",this.data.ia),b[0])};
t.Ko=function(b){var c=(b=Wk(this.g,b.target))&&b.name;if(c)switch(c){case "addcomment":"添加评论"===$.trim($(b).text())?Km(this.xr,{oa:"question_add_comment_start"}).call(this,b):this.xr(b);break;case "remove":Ei("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new W(j);P(c,"complete",function(){var b=Je(c);b&&!b.r?window.location.href="/":V(b.msg)});c.ajax("/question/delete/"+this.data.ia)}},this);break;case "admin":c=this.yJ;c||(c=new EB,c.o(K("zh-question-admin-menu")),Ph(c,function(b){b.Ba(b.h().getAttribute("data-action"))}),
this.m().e(c,"action",function(b){b=this.jB=b.target;(new Qv).open(b.h(),{id:this.data.ia,type:"question"},y(this.XK,this))}),this.yJ=c);c.P()?c.C(m):FB(c,new Ps(b,1,j),0,new Pf(5,0,5,0));break;case "share":X.ha({type:"ga_click_share_question_box",target:b});this.sc();break;case "invite":this.Zw()}};t.xr=function(b){this.ma.yf();this.ma.Gc()&&this.ma.ti("view_comments",parseInt(Fc(b),10)||0)};
t.Zw=function(){this.NE.yf();var b=this.NE.Gc();this.dispatchEvent(new Pv("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.ke}))};t.sc=Km(function(){Du(["分享问题","question",this.data.ob,{qid:this.data.ia}],"tb-webshare-sina")},{oa:"question_question_share"});t.XK=function(b){this.jB.S(b.msg.action);this.jB.sm(b.msg.caption)};a.Jw=function(b,c){this.hb=b;this.entryType=c;this.em=l;this.vg="post"===c?Dw:pt};A(Jw,U);t=Jw.prototype;t.Oa=function(){return this.Jm.data("votecount")};t.Ic=function(){this.dispatchEvent("change")};t.ck=function(){this.em&&"pending"===this.em.state()||(this.em=this.vg.MD(this.hb).done(y(this.nt,this)))};t.nt=function(b){if(b=Ma(b))b=$(b),this.Jm.replaceWith(b),this.Jm=b,this.pb(),this.Ic()};
t.pb=function(){var b=this;$("a.more",this.Jm).click(function(){var c,d={Mj:j,title:b.Oa()+" 人赞同",className:"zm-voters-dialog",lC:$.Deferred(function(d){setTimeout(function(){var e=c.R(),g=c,h=M("div","zm-voters");e.appendChild(h);e=M("div","listview");h.appendChild(e);var v=("post"===b.entryType?"/post/":"/answer/")+b.hb+"/voters_profile",x=new Mt({fa:[],source:function(){return $.get(v).then(function(c){var d=c.paging;d&&(d.total&&(b.Jm.data("votecount",d.total),b.Ic()),v=d.next);return{results:c.payload,
next:!!v}})}});x.o(e);x.Cc().setAttribute("hidden","true");Rc(g,x);oe(x.m(),x,"next",function(){x.wb().length?(x.Cc().removeAttribute("hidden"),x.fa("autoload",{EB:m,viewport:h})):(x.F(),h.innerHTML='<div class="empty-results">还没有人赞同</div>')});x.Cs().then(function(){d.resolve(l)})})}).promise()},e=$.extend({},{title:"信息",LS:"加载中",Re:[],onload:w},d),g=M("div",{className:"modal-dialog-async-loading",innerHTML:(e.LS||"加载中")+'<i class="spinner-gray"></i>'}),h=Ei(e);h.R().appendChild(g);e.lC&&e.lC.then(function(b){N(g);
h.If||(b&&h.Aa(b),h.X(),e.onload(h.R(),h))});c=h;c.m().e(b,"change",function(){c.Ta(b.Oa()+" 人赞同")})})};t.z=function(){this.Jm=$(this.g);this.pb()};a.QB=function(b){this.G=$(b);this.hf()};QB.prototype.hf=function(){var b=[this.G.get(0)].concat(this.G.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.QX=c;this.vP=d};QB.prototype.getItem=p("vP");a.RB=function(b,c,d,e){vp.call(this,b,c,d,e)};A(RB,vp);t=RB.prototype;t.z=function(){RB.n.z.call(this);this.ready(function(){if(this.Ja&&this.Ja.on)this.Ja.on("load",this.xx,m,this)})};
t.xx=function(){var b=new sB(this,j);Rc(this,b);this.m().e(b,"saveContent",function(){var b=!this.Od&&this.Ja.Uh("FullScreenPlugin");b&&eB(b);$(this.Cq).text("保存草稿并离开");$(this.g).find(".zu-edit-button span").text("修改（有未发布的编辑草稿）")}).e(b,"clearContent",function(){$(this.Cq).text("取消");$(this.g).find(".zu-edit-button span").text("修改")});var c=Xr(this);this.m().e(c,"focus",function(){b.ad.start()}).e(c,"blur",function(){xB(b);this.$K!==this.ef()&&b.tt()}).e(this,"saveSuccess",function(){delete dh.Gd;
xB(b);yB(b)}).e(this,"save_unchanged",function(){delete dh.Gd;xB(b);yB(b)});b.o(this.zc);dh.Gd&&dh.Gd[0]&&$(this.Cq).text("保存草稿并离开")};
t.Hh=function(){this.zc=M("div","zm-command",[this.VW=$('<div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$取消编辑并删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div>')[0],this.Cq=M("a",{"class":"zm-command-cancel",name:"cancel",href:"#"},"取消"),this.Yk=M("a",{"class":"zg-r3px zg-btn-blue",name:"save",href:"#"},"发布")]);this.Bb.appendChild(this.zc)};
t.iw=function(){var b=this;$.get("/draft/get",{qid:this.Uo},function(c){c.r||(b.At(c.msg),b.$K=c.msg)})};t.ED=function(){var b=[];if(!this.disabled){var c="修改";dh.Gd&&dh.Gd[0]&&(c="修改（有未发布的编辑草稿）");b.push('<a href="javascript:;" class="zu-edit-button" name="edit"><i class="zu-edit-button-icon"></i><span>'+c+"</span></a>")}return b.join("")};a.SB=function(){this.kv=[]};A(SB,Pt);ia(SB);SB.prototype.v=function(b){var c=SB.n.v.call(this,b);H.add(c,"goog-submenu");TB(this,b,c);return c};SB.prototype.o=function(b,c){c=SB.n.o.call(this,b,c);H.add(c,"goog-submenu");TB(this,b,c);var d=Ub("div","goog-menu",c);if(d.length){var e=new Xt(b.J()),d=d[0];S(d,m);b.J().Da().body.appendChild(d);e.o(d);b.ih(e,j)}return c};
SB.prototype.Aa=function(b,c){var d=this.R(b),e=d&&d.lastChild;SB.n.Aa.call(this,b,c);e&&(d.lastChild!=e&&H.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};SB.prototype.ye=function(b){SB.n.ye.call(this,b);var c=b.R(),d=b.J(),d=Tb(d.Ha,"span","goog-submenu-arrow",c)[0];UB(b,d);d!=c.lastChild&&c.appendChild(d);Nc(b.h(),Uc.Hk,"true")};
a.TB=function(b,c,d){var e=c.J().v("span");e.className="goog-submenu-arrow";UB(c,e);b.R(d).appendChild(e)},a.UB=function(b,c){b.zd()?(H.add(c,"goog-submenu-arrow-rtl"),xc(c,b.fq?"◄":"►")):(H.remove(c,"goog-submenu-arrow-rtl"),xc(c,b.fq?"►":"◄"))};a.VB=function(b,c,d,e){Ut.call(this,b,c,d,e||SB.N())};A(VB,Ut);a.WB=218;t=VB.prototype;t.Jd=l;t.Mz=l;t.rE=m;t.lc=l;t.kr=m;t.fq=j;t.EO=m;t.z=function(){VB.n.z.call(this);this.m().e(this.getParent(),"hide",this.lG);this.lc&&XB(this,this.lc,j)};t.ib=function(){this.m().Fa(this.getParent(),"hide",this.lG);this.lc&&(XB(this,this.lc,m),this.kr||(this.lc.ib(),N(this.lc.h())));VB.n.ib.call(this)};t.w=function(){this.lc&&!this.kr&&this.lc.F();this.lc=l;VB.n.w.call(this)};
t.pd=function(b,c){VB.n.pd.call(this,b);c&&(this.Ua().Xf=j);b||(this.Jd&&Ld(this.Jd),this.Jd=Kd(this.Bg,WB,this))};t.It=function(){var b=this.getParent();b&&bt(b)==this&&(YB(this,j),ZB(this),this.GX=m)};t.Bg=function(){var b=this.lc;b&&b.getParent()==this&&(YB(this,m),Ph(b,function(b){"function"==typeof b.Bg&&b.Bg()}))};a.$B=function(b){b.Jd&&Ld(b.Jd);b.Mz&&Ld(b.Mz)};t.C=function(b,c){var d=VB.n.C.call(this,b,c);d&&!this.P()&&this.Bg();return d};
a.ZB=function(b){Ph(b.getParent(),function(b){b!=this&&"function"==typeof b.Bg&&(b.Bg(),$B(b))},b)};t.Wb=function(b){var c=b.keyCode,d=this.zd()?37:39,e=this.zd()?39:37;if(this.rE){if(!this.Ua().Wb(b))if(c==e)this.Bg();else return m}else if(this.isEnabled()&&(c==d||c==this.ky))this.It(),ct(this.Ua()),$B(this);else return m;b.preventDefault();return j};t.MP=function(){this.lc.getParent()==this&&($B(this),this.bm.pd(this),ZB(this))};t.lG=function(b){b.target==this.bm&&(this.Bg(),$B(this))};
t.kd=function(b){this.isEnabled()&&($B(this),this.Mz=Kd(this.It,WB,this));VB.n.kd.call(this,b)};t.Xd=function(b){$B(this);if(this.Pb&8)return VB.n.Xd.call(this,b);this.It();return j};
a.YB=function(b,c){b.dispatchEvent(Lh(64,c));var d=b.Ua();if(c!=d.P()&&(c&&(d.ya||d.W(),d.Ob(-1)),b.rE=c,H.enable(b.h(),"goog-submenu-open",c),d.C(c),c)){var d=new Ps(b.h(),b.fq?6:4,b.EO),e=b.Ua(),g=e.h();e.P()||(g.style.visibility="hidden",S(g,j));d.X(g,b.fq?4:6);e.P()||(S(g,m),g.style.visibility="visible")}},a.XB=function(b,c,d){var e=b.m();(d?e.e:e.Fa).call(e,c,"highlight",b.MP)};t.Ga=function(b){this.Ua().H(b,j)};t.Ii=function(b,c){this.Ua().Kk(b,c,j)};
t.removeItem=function(b){(b=this.Ua().removeChild(b,j))&&b.F()};t.Th=function(b){return Rh(this.Ua(),b)};t.yl=function(){return Qh(this.Ua())};t.wb=function(){return this.Ua().wb()};t.Ua=function(){this.lc?this.kr&&this.lc.getParent()!=this&&Oh(this.lc,this):this.ih(new Xt(this.J()),j);this.lc.h()||this.lc.v();return this.lc};t.ih=function(b,c){var d=this.lc;b!=d&&(d&&(this.Bg(),this.ya&&XB(this,d,m)),this.lc=b,this.kr=!c,b&&(Oh(b,this),b.C(m,j),b.Qm=m,b.Ke(m),this.ya&&XB(this,b,j)))};t.Ef=function(b){return this.Ua().Ef(b)};
pj("goog-submenu",function(){return new VB(l)});a.aC=function(b,c,d,e){VB.call(this,b,c,d,e)};A(aC,VB);aC.prototype.Wb=function(b){var c=aC.n.Wb.call(this,b),b=parseInt(tk[b.keyCode],10);isNaN(b)||this.Ua().Ob(b-1);return c};a.Bw=function(b,c,d){U.call(this);this.ia=b;this.ga=d;this.jL=c||gh;this.sv=l};A(Bw,U);a.bC={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"},a.cC=function(b,c){return Km(b,c,function(){return this.Gn()})};t=Bw.prototype;t.Gn=function(){return"#answer-"+this.ga};t.wj=function(){var b=$("a[name=report]",this.Hc);if(b.length){var c=new ju("answer",this.ga);mu(c,b[0]);Rc(c,this)}};t.fy=function(){Hu("answer",this.ob,"read")};
t.Lj=function(){Hu("answer",this.ob,/^\/question\//.test(location.pathname)?"read":"touch")};
t.z=function(){function b(){c();var b=q.cq.Th(0);b.Ua&&b.Ua()&&(b.It(),b.Ua().Ob(0))}function c(){dC(q);q.cq.Ob(0)}Bw.n.z.call(this);var d=L("zm-item-answer",this.g)||this.g;this.ga=d.getAttribute("data-aid");this.Ge="1"===d.getAttribute("data-isowner");this.ob=d.getAttribute("data-atoken");this.Ng="1"===d.getAttribute("data-deleted");this.yv=+d.getAttribute("data-created");this.KN=+d.getAttribute("data-helpful");this.CO="1"===d.getAttribute("data-good");this.Aj="1"===d.getAttribute("data-collapsed");
this.jb=l;this.Cf=L("zm-item-answer-author-info",this.g);d=m;!T.oa()&&0<$(this.g).parents('div[data-fixed-summary="1"]').length&&(d=j);var e={};e.qr=!!d;d=this.Ot=new Lt(e);this.H(d);d.o(this.g);d.Cc()&&oe(this.m(),d,"expand",this.fy);Kt(this.g,this.Lj,this);this.Hc=this.Hc||L("zm-item-meta",this.g);(this.ci=L("zm-meta-panel",this.Hc))&&this.m().e(this.ci,"click",this.Ko);if(this.Ge){d=$('[name="comment_opt"]',this.Hc);if(d.length){var e=d.data(),g=new Xt,h=new jB("禁止转载");h.$c(!e.copyable);g.Ga(h);
g.Ga(new Wt);this.tv=[];J.forEach(bC,function(b,c){var d=new jB(b);d.Ba(c);d.$c(c===this.sv);this.tv.push(d);g.Ga(d)},this);g.Ga(new Wt);g.Ga(new Ut("删除"));this.m().e(g,"action",this.zM);eC(this,g);H.add(g.h(),"zg-gray-normal");e=new cu("comment",g);e.ek=j;fu(e);eu(e);e.dc=of;e.o(d[0]);this.KW=g}this.Cf&&(this.xG=(this.jb=Xa(this.Cf.innerHTML,"匿名用户"))?l:this.Cf.innerHTML.replace(/src=".+?"/g,'src="'+T[2]+'"'),this.m().e(this.Cf,"click",function(b){"cancel-anon"===b.target.name&&ds(m)}))}else this.zx();
if(d=L("zm-item-vote-info",this.g)){this.wk=new Jw(this.ga);this.H(this.wk);this.wk.o(d);d=$(".zm-item-vote-count",this.g);d[0]||(d=$(".zm-item-vote-count",this.Hc));var k=[d[0],$(".zm-votebar .count",this.g)[0]];if(k.length){var n=this.wk;this.wk.on("change",function(){B.forEach(k,function(b){Ik(b,n.Oa())})})}}this.xj();$(this.g).on("contentchange",$.proxy(this.xj,this));this.vx();this.pb();d=new QB(this.g);d=Hk.zI(d.getItem()||this.g);Gk(Gk(Gk(Gk(Gk(Gk(Gk(d.register("v",function(){this.lb&&this.lb.Zt()},
this),{group:"操作",name:"赞同"}).register("d",function(){this.lb&&this.lb.Yt()},this),{group:"操作",name:"反对"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("s c",this.kj,this),{group:"操作",name:"收藏"}).register("t",this.Ir,this),{group:"操作",name:"感谢"}).register("c",this.Sw,this),{group:"操作",name:"打开评论"}).register("shift+c",this.xr,this),{group:"操作",name:"定位到评论框"});var e=kb?"⌘":"ctrl",q=this;eh.QE&&$("a[name=admin]",this.ci)[0]&&Gk(Gk(d.register("meta+.",c),{group:"管理",name:"展开菜单",key:e+
"+."}).register("meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});this.wj();if(sb&&!Pg&&(d=L("more-actions",this.Hc))){var r={share:{label:"分享",action:this.sc},fav:{label:"收藏",action:this.kj},report:{label:"举报",action:this.pN},nohelp:{label:this.KN?"没有帮助":"撤销没有帮助",action:this.YD}},v=new Xt,e=function(b){Qh(v)&&v.Ga(new Wt);var c=new Ut(r[b].label);c.Ba(b);v.Ga(c)};e("share");e("fav");this.Ge||(e("nohelp"),T.oa()&&e("report"));e=new cu("operation",v);e.ek=j;fu(e);eu(e);e.Zl=ca();e.dc=of;e.o(d);
H.add(v.h(),"zh-answer-more-actions");this.m().e(v,"action",function(b){var c=b.target.S();(c=r[c])&&c.action&&c.action.call(this,b)})}};t.Ez=function(b){var c=this.xj();c&&cp(c,b)};
t.zx=function(){var b=L("zm-votebar",this.g)||L("zm-votebar",this.ci);if(b){var c=new Ew(this.ga);c.o(b);this.lb=c;this.m().e(c,"change",this.DR).e(c,"action",function(b){b.data.state===Fw.ge?X.ha({type:"ga_click_vote_up",target:this}):b.data.state===Fw.sg&&X.ha({type:"ga_click_vote_down",target:this})});(b=L("votenum-mobile",this.ci))&&(new Hw(c)).o(b)}};
t.xj=function(){if(this.th)return this.th;var b=L("zm-editable-content",this.g),c=this.lb&&this.lb.h();!this.Ge&&!sb&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.th=new fp(l,b),this.H(b),b.hg="votebar",b.Py=50,b.o(c))};t.DR=function(){this.wk&&this.wk.ck()};
a.fC=function(b){if(!b.je&&b.Ge&&gh&&b.ga){b.je=new RB(m,"/answer/content","content");Rc(b,b.je);b.je.cu=j;b.je.Uv=j;b.je.GD=zB.prototype.GD;var c=L("zm-item-rich-text",b.g);b.je.params=["id="+b.ia];b.je.o(c);b.m().e(b.je,"shouldUpdateContent",function(b){if(la(b.data))return m});b.m().e(b.g,"click",function(b){"suggest_edit"===b.target.name&&(this.je.sf(),$(".zh-question-censor-tip",this.g).hide());return j})}};
t.pb=function(){this.Cf&&this.m().e(this.Cf,"click",this.ta);this.Ge&&(this.ZJ=T);this.m().e(Ni,"anon_change",function(b){this.Ge?this.yt(b.jb):this.lb.Rd()===Fw.ge&&this.wk.ck()});fC(this);$(this.g).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.cf=function(b){return Wk(this.g,b)};
t.ta=function(b){if(b=(b=this.cf(b.target))&&b.name)if("edit"===b){b=qB();if(!this.Xu){var c=gh.ob;b.Xx=j;b.YG=c;this.m().e(b,"change",this.wy)}this.Xu=j;rB(b)}else"complex"===b&&(b=L("zm-item-answer-summary",this.g),c=L("zm-item-rich-text",this.g),S(b,m),S(c,j))};t.wy=function(){var b=qB().ww()||T[4]||"";if(b){var c=L("zu-question-my-bio",this.Cf);c.title=b;c.innerHTML=b}};t.vx=function(){var b=L("zm-item-answer-author-wrap",this.g),b=L("zm-list-avatar",b);ok.add(b)};
t.yt=function(b){b?this.Cf.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.Ge&&(this.xG?this.Cf.innerHTML=this.xG.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(it()),b.push(jt(T,"zm-item-answer-creator")),b.push("</h3>"),this.Cf.innerHTML=
b.join("")))};
a.gC=function(b,c){if(!b.ma){b.ma=new bw(b.ga,"answer",c);b.H(b.ma);gw(b.ma,b.Hc,$(".toggle-comment",b.Hc)[0]);pw(b.ma);b.ma.zt(b.Gn());var d=location.hash.slice(1).split("-"),e=location.pathname.split("/"),e="answer"===e[3]&&e[4];"comment"===d[0]&&d[1]&&e===b.ob&&(b.ma.Na(j),b.m().e(b.ma,"expand",function(){ew(this.ma)}))}},a.dC=function(b){if(b.cq)b.cq.C(j);else{var c;var d=$("a[name=admin]",b.ci)[0];if(d){b.zJ=d;WB=0;c=new EB;b.H(c);c.attach(d,5);var e=b.Aj?new Ut("取消折叠"):new aC("折叠");e.Ba("collapse");
var g=function(b,c){var d=new Ut(c+1+" "+b.label);d.Ba(b.value);e.Ga(d)};b.Aj||Sv("answer","collapse").then(function(b){B.forEach(b,g);H.add(e.Ua().h(),"manage-menu")});d=new Ut("删除");d.Ba("delete");c.Ga(e);c.Ga(d);c.W(b.g);H.add(c.h(),"manage-menu")}else c=i;c&&(FB(c,new Ps(b.zJ,1,j),0,new Pf(5,0,5,0)),b.m().e(c,"action",function(b){var c=b.target,b=c.S(),c=c.h(),d=new Ul;"collapse"===b?(d.add("answer_id",this.ga).add("action","collapse2").add("collapse",this.Aj?"cancel":"done"),c.setAttribute("data-op",
this.Aj?"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),hC(this,c)):"delete"===b?(d.add("answer_id",this.ga).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),hC(this,c)):oa(b)&&(c=new Ul,c.add("answer_id",this.ga).add("action","collapse2").add("collapse",this.Aj?"cancel":"done").add("reason",b),Rv("/manage",c.toString(),y(this.oG,this)))}),eC(b,c),b.cq=c)}};
t.oG=function(){var b=$(this.g);b.hide("fast",function(){b.remove()});this.F()};a.hC=function(b,c){(new Qv).open(c,{id:b.ga,type:"answer"},y(b.oG,b))};
t.Ko=function(b){var c=this.cf(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":this.Sw();this.ma&&this.ma.Gc()&&this.ma.ti("view_comments",parseInt(Fc(c),10)||0);break;case "remove":this.Br();break;case "thanks":X.ha({type:"ga_click_thank_answer",target:c});this.Ir();break;case "comment_opt":if(!this.sv&&(!this.dC||!this.dC.Fb()))b=new W(j),oe(this.m(),b,"success",function(b){if((b=Je(b.target))&&!b.r){var c=b.msg;B.forEach(this.tv,function(b){b.S()===c&&b.$c(j)});this.sv=c}else V(b.msg)}),
b.ajax("/answer/comment_permission?answer_id="+this.ga,l,"GET"),this.dC=b;break;case "admin":dC(this);break;case "share":X.ha({type:"ga_click_share_answer_box",target:c});this.sc();break;case "nohelp":this.YD(b);break;case "favo":X.ha({type:"ga_click_collect_answer_box",target:c}),this.kj()}};t.pN=function(){(new ju("answer",this.ga)).AH()};
t.YD=cC(function(b){var b=b.target,c=!!b.h;X.ha({type:"ga_click_answer_not_helpful",target:c?b.h():b});this.Lv&&"pending"===this.Lv.state()&&this.Lv.abort();var d,e;e=c?b.Fg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.sm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||Qk(b);this.Lv=$.post(d,{aid:this.ga})},{oa:"question_answer_not_helpful",ed:j});t.sc=cC(function(){Du(["分享回答","answer",this.ob,{aid:this.ga}],"tb-webshare-sina")},{oa:"question_answer_share"});
t.kj=cC(function(){var b=Nw.N();Sw(b,this.ga);b.show()},{oa:"question_answer_collect",ed:j});t.VK=function(){this.ma||gC(this);this.ma.yf();$(this.ci).toggleClass("focusin",this.ma.Gc())};t.Sw=cC(Bw.prototype.VK,function(){return{oa:"添加评论"===$.trim($(L("toggle-comment",this.g)).text())?"question_answer_add_comment_start":m}});t.xr=cC(function(b){this.ma&&this.ma.Gc()?this.ma.field.focus():this.Sw();b.preventDefault()},{oa:"question_answer_add_comment_start"});
t.Ir=cC(function(){var b=$("a[name=thanks]",this.ci)[0];b&&!H.has(b,"disabled")&&($.parseJSON(b.getAttribute("data-thanked"))===j?(Ik(b,"感谢"),b.setAttribute("data-thanked",m),$.post("/answer/cancel_thanks",{aid:this.ga})):(Ik(b,"取消感谢"),b.setAttribute("data-thanked",j),$.post("/answer/thanks",{aid:this.ga})),Qk(b))},{oa:"question_answer_thank"});
a.eC=function(b,c){b.m().e(c,"show",function(){H.add(this.Hc,"zm-item-meta-has-menu")}).e(c,"hide",function(b){b.currentTarget===b.target&&H.remove(this.Hc,"zm-item-meta-has-menu")})};t.wz=function(b){pt.wz(this.ga,b);$(".copyright",this.Hc).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')};
t.zM=function(b){var c=b.target,b=c.S();"禁止转载"===b?this.wz(!c.Ae()):"删除"===b?this.Br():b in bC&&$.post("/answer/comment_permission",{answer_id:this.ga,permission:b}).done(y(function(b){b&&!b.r&&B.forEach(this.tv,function(b){b.$c(b===c)})},this))};t.Br=function(){Ei("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.Ng=j,this.status=-1,iC(this))},this)};
a.iC=function(b){var c=new W(j);oe(b.m(),c,"success",function(){S(this.g,!this.Ng);this.Ng?this.zu="set_delete":(fC(this),this.zu="cancel_delete");this.dispatchEvent("change");$(this.g).parent(".zm-item").hide()});c.ajax("/answer/"+(b.Ng?"remove":"unremove"),"aid="+b.ga)};t.h=p("g");a.jC=function(b,c,d){Bw.call(this,b,c,d)};A(jC,Bw);jC.prototype.o=function(b){jC.n.o.call(this,b);this.Ge&&this.yt(this.jL.jb)};jC.prototype.P=function(){return $(this.g).is(":visible")};a.kC=function(){U.call(this);this.data=gh||{};this.ia=this.data.ia;this.lo=m;this.Ji={};this.Su=[];this.iq=[];this.ei=0;this.Yf=hh&&hh.url_token?hh:l};A(kC,U);t=kC.prototype;t.init=function(){yr.H(this);this.o(document.body)};
t.z=function(){kC.n.z.call(this);var b=K("zh-question-meta-wrap");b&&(this.QG=new PB(this.data),this.H(this.QG),this.QG.o(b));this.Yn();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.ob,uid:T.Fe,op:"pass"})});this.Bo=new By;this.m().e(this.Bo,"change",this.Ry);this.Bo.init();this.yH();T.bh&&$.post("/question/popup",{action:"no_answer",question_token:this.data.ob},function(b){if(b){var c=new HB;c.Ta("提问无人问津？");c.Aa(b);c.X();
$(".js-gonext",c.g).on("click",function(){var b=$(this).parents('[class^="view"]').attr("class");"view-starting"===b?(c.Ta("第一条"),c.Dd("firsttip")):"view-firsttip"===b?(c.Ta("第二条"),c.Dd("secondtip")):"view-secondtip"===b?(c.Ta("第三条"),c.Dd("thirdtip")):"view-thirdtip"===b&&c.C(m)})}});(b=th.topic_errors_info)&&Om(b)};
t.yH=function(){this.data.ob=gh.ob;lC(this,j);if(T.oa()){"close"!==gh.status&&(this.Ma=new sn(this.data.pA,this.data.ia),this.Ma.Es=5,this.Ma.Hs=1,this.Ma.mB=j,this.Ma.Ms=j,this.Ma.o(L("zm-tag-editor",this.g)),this.m().e(this.Ma,["remove_tag","add_tag"],function(){X.ha("ga_edit_question_topic_changed")}),this.m().e(this.Ma,"start_editing",function(){X.ha("ga_question_topic_edit_finish_changed")}),this.Ma.addEventListener("beforeedit",ry({fm:j})));"close"===gh.status&&$('.question-status [name="appeal"]').click($.proxy(function(){var b=
this.ia,c=new Ai;ci(c,j);c.Cg=j;ii(c,ki);c.Ta("请填写你的申诉理由");c.Aa('<textarea class="textarea" name="reason" placeholder="简洁的申诉理由会让管理员更快处理"></textarea>');c.C(j);c.X();c.m().e(c,gi,function(){$.post("/question/appeal",{qid:b,reason:$('[name="reason"]',c.g).val()},function(){Ei({title:"申诉提交",Mj:j,content:"<p>您的申诉正在等待人工处理，我们会在 24 小时内处理完成。</p><p>处理完成后会私信通知您。</p>",className:"report-success-dialog",X:j,Re:["知道啦"]})})})},this));var b=K("zh-question-title");if("false"!==b.getAttribute("data-editable")){this.bd=
new CB(this.data.ia,"/question/title","content",m,j);this.bd.LC=j;this.bd.Od=j;this.bd.To=j;var c=mt(this.data.bh);this.bd.jo=c;this.bd.o(b);this.m().e(this.bd,"change",function(){Ni.dispatchEvent("question_title_change");document.title=this.bd.bb()+" - 知乎"});this.m().e(this.bd,"click_edit",function(){X.ha("ga_question_title_edit_start")});this.m().e(this.bd,"cancel_edit",function(){X.ha("ga_question_title_edit_cancel")});this.m().e(this.bd,"save_changed",function(){X.ha("ga_question_title_edit_save_changed")});
this.m().e(this.bd,"save_unchanged",function(){X.ha("ga_question_title_edit_save_unchanged")});this.bd.addEventListener("beforeedit",ry({fm:j}))}}this.jq=K("zh-question-answer-num");this.kq=K("zh-question-answer-wrap");this.Eh=K("zh-question-collapsed-link");this.jn=K("zh-question-collapsed-wrap");this.PK=K("zh-question-collapsed-num");this.RJ=K("zh-question-answer-form-wrap");this.rk=K("zh-question-notification-summary");this.Dm=K("zh-answers-filter");this.gt=K("zh-add-question-sug");this.jq&&(this.data.ke=
+this.jq.getAttribute("data-num"));this.kq&&(this.data.YQ=+this.kq.getAttribute("data-pagesize"));this.Eh&&this.m().e(this.Eh,"click",this.$S);this.gt&&this.m().e(this.gt,"click",this.SD);this.Dm&&Ug&&this.m().e(this.Dm,"click",function(b){b.stopPropagation();H.add(this.Dm,"activated");oe(this.m(),document,"click",function(){H.remove(this.Dm,"activated")})});(this.qv=K("zg-question-suggested-topics"))&&this.m().e(this.qv,"click",this.DP);this.Xn();this.m().e(window,"hashchange",function(b){b=b.Vb;
b.oldURL&&"writing"===b.oldURL.split("#")[1]||mC(this)});if(b=K("zh-question-answer-wrap")){var d=new Mt({fa:["expandLimit","nodeSource"],kh:this.data.ke>this.data.YQ&&!L("question-page-pager")});this.H(d);this.m().e(d,"itemcreated",function(b){d.H(nC(this,b.item));$("img.lazy",b.item).lazyload({data_attribute:"actualsrc",threshold:400})});d.o(b)}b=T[4];ih&&ih.length&&(b=ih[0][1]);this.mb=new zB(this.data.jb,T,b);this.H(this.mb);this.mb.o(this.RJ);dh.Gd&&dh.Gd.length?this.mb.Aa(dh.Gd[0]):!eh.tc&&
D&&this.mb.Aa("<p></p>");if(!this.data.Jx&&!this.ei&&(!this.Yf||!this.Yf.url_token))if(this.data.Sm&&this.data.Sm.length&&this.data.Sm[3]!==T.Fe)this.mb.Za(m,"只有 "+jt(this.data.Sm)+" 能回答此问题");else if("normal"===gh.status||dh.Gd)T.bh||this.mb.sf();this.m().e(this.mb,"change",this.EP);this.m().e(this.mb,"cancel_delete_answer",this.LP);this.mb.ready(function(){var b=this.tr();b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});oC(this);mC(this,l);pC(this);this.m().e(Ni,"anon_change",
function(b){this.data.jb=b.jb});fh&&setTimeout(function(){location.href=fh},5E3)};t.Yn=function(){Hu("question",this.data.ob,"read");this.m().e(this,["click!","show!"],function(b){"comment"===b.namespace&&b.vc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.vc.fill("label","question_page")})};
t.Ry=function(){this.IN=j;this.rk=$(this.Bo.xP)[0];kc(this.rk,K("zh-question-redirect-info"));S(this.rk,j);eh.tc||(this.dj=new Yo,this.dj.o(this.rk),Yr(this.dj));this.m().e(this.rk,"click",this.SD);mC(this)};a.lC=function(b,c){!T.oa()||!c?(qC(b,"zh-question-detail",w),qC(b,"zh-question-answer-summary",w)):(qC(b,"zh-question-detail",b.$N),qC(b,"zh-question-answer-summary",b.cO))},a.qC=function(b,c,d){if(c=K(c)){var e=new Lt;b.m().e(e,"expand",d).e(e,"invalid",d);e.o(c)}};
t.$N=function(b){if("close"!==gh.status){b=b.target.h();this.yb=new CB(this.data.ia,"/question/detail","content",j,l,600);var c=mt(this.data.bh);this.yb.jo=c;this.yb.GW=Yk;L("zm-editable-content",b).innerHTML&&(this.yb.To=j);this.yb.o(b);this.m().e(this.yb,"click_edit",function(){X.ha("ga_question_supplement_edit_start")});this.m().e(this.yb,"cancel_edit",function(){X.ha("ga_question_supplement_edit_cancel")});this.m().e(this.yb,"save_changed",function(){X.ha("ga_question_supplement_edit_save_changed")});
this.m().e(this.yb,"save_unchanged",function(){X.ha("ga_question_supplement_edit_save_unchanged")});this.yb.addEventListener("beforeedit",ry({fm:j}))}};
t.cO=function(b){var b=b.target.h(),c=K("zh-question-answer-summary-link"),d;if(b&&(eh.QE||!this.data.YS))d=new vp(j,"/question/summary","content"),d.params=["id="+this.data.ia],d.Bq=m,d.o(b);if(c){var e=K("zh-question-answer-summary-wrap");this.m().e(c,"click",function(){d&&(S(e,j),d.sf())}).e(e,"click",function(b){"cancel"===b.target.name&&(b=!d.ef(),S(e,!b))})}this.XS=d;this.XS.addEventListener("beforeedit",ry({fm:j}))};
t.SD=function(b){if("close"===b.target.name){if(this.dj&&(dp(this.dj),cp(this.dj,m),history.replaceState)){var b=new wf(location.href),c=b.hd();c.remove("q");c.remove("psq");history.replaceState({},"",b.bg+"?"+c.toString())}S(this.rk,m);S(this.gt,m)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(S(this.gt,m),yp.N().show()),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.cf(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?l:b.substr(c+1),mC(this,b&&decodeURIComponent(b))};
a.pC=function(b){b.data.Hq=+b.PK.innerHTML;T.oa()||(b.data.Hq=0);S(b.Eh,0<b.data.Hq);b.jq&&xc(b.jq,b.data.ke?b.data.ke+" 个回答":"还没有回答");b.Dm&&S(b.Dm,1<b.data.ke);S(b.Eh,0<b.data.Hq)},a.nC=function(b,c,d,e){e=new jC(b.ia,l,e);e.o(c);b.Ji[e.ga]=e;b.iq.push(e.ga);b.m().e(e,"change",b.vy);e.Ge&&(b.ei=e.ga,e.ZJ=T,b.m().e(e.je,"change",b.gN),b.ug=e);e.Aj?e.Ge&&b.jn.appendChild(e.h()):b.Su.push({added_time:e.yv,vote:d,aid:e.ga});e.Ng&&S(e.h(),m);return e};
t.gN=function(){var b=this.ug,c=b.h(),d=b.je.bb()[0];S(c,m);d=fc(Ma(d));jc(d,c);this.Ji[b.ga]=l;this.iq=B.filter(this.iq,function(c){return c!==b.ga},this);var e=999;this.Su=B.filter(this.Su,function(c){c.aid===b.ga&&(e=c.vote);return c.aid!==b.ga},this);N(c);b.F();nC(this,d,e,m)};
t.vy=function(b){b=b.target;if(b instanceof jC){var c=b.h();switch(b.zu){case "collap":this.jn.appendChild(c);H.add(c,"zm-item-collapsed");this.data.ke--;pC(this);break;case "cancel_collap":this.kq.appendChild(c);H.remove(c,"zm-item-collapsed");rC(this,c);this.data.ke++;pC(this);break;case "set_delete":oC(this);this.data.ke--;pC(this);break;case "cancel_delete":rC(this,this.Ji[this.ei].h()),oC(this),this.data.ke++,pC(this)}}};
a.oC=function(b){var c=l,d=l,e,g={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!dh.Gd&&"normal"!==gh.status&&(d="被"+g[gh.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.ei?(e=b.Ji[b.ei],c="#answer-"+e.ga,e=e.Ng):b.Yf&&(c="/question/"+gh.ob+"/answer/"+b.Yf.url_token,e=b.Yf.is_delete);c&&(d=e?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="'+
c+'">现有的回答</a> 进行修改');T.bh&&(!b.ei&&!b.Yf)&&(d='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');b.data.Jx&&(d='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');d&&b.mb.Za(m,d)};t.yD=function(b){return this.Ji[b]};a.sC=function(b,c){var d=K("zh-question-collapsed-switcher");c?(d.name="collap",b.eC=j,S(b.jn,j),H.add(b.Eh,"zu-question-collap-title-active")):(b.eC=m,d.name="expand",S(b.jn,m),H.remove(b.Eh,"zu-question-collap-title-active"))};
t.$S=function(b){if((b=Wk(this.Eh,b.target))&&b.name)if("expand"===b.name){if(!this.RK){this.RK=j;var c=this,d=this.jn,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.ia}});b.done(function(b){b=fc(b);sC(c,j);H.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);B.forEach(oc(d),function(b){b!==e&&nC(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=oc(d)[0];e&&(S(e,m),b.done(function(){S(e,j)}));S(d,j);H.add(d,"zm-question-collapsed-list-loading")}sC(this,
j)}else sC(this,m)};t.LP=function(){var b=this.Ji[this.ei],c;b?(b.Ng=m,b.status=0,iC(b),rC(this,b.h())):(c=this.Yf,b=new W(j),oe(this.m(),b,"success",function(){window.location.href="/question/"+gh.ob+"/answer/"+c.url_token}),b.ajax("/answer/unremove","aid="+c.id))};
t.EP=function(){var b=this.mb.hq.checked,c={Mj:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=y(function(){if(!this.xhr||!this.xhr.Fb()){var c=this.mb.ef();if(c){var d=new W(j),h=new Ul,k=b?1:0;h.add("id",this.ia).add("content",c).add("anon",k);d.on("success",function(){gh.jb!==k&&Ni.dispatchEvent(new Ur(k));var b=Je(this.xhr);b&&!b.r?(b=fc(Ma(b.msg[0])),this.kq.appendChild(b),nC(this,b,this.iq.length,j),oC(this),xB(this.mb.UC),yB(this.mb.UC),this.mb.F(),gh.jb||(this.tP=new iB(this.Ji[this.ei]),
this.tP.show()),T.SL&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),this.data.ke++,pC(this)):Fi("提示信息",b.msg)},m,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);gh.jb&&!b?Ei(c,function(b){b&&d()}):d()};t.cf=ca();t.DP=function(b){if((b=this.cf(b.target))&&b.name){var c=b.name;"close"===c?S(this.qv,m):"addtag"===c&&(this.Ma.Pe(b.id.split("-")[1],b.innerHTML),S(b,m))}};t.Xn=function(){this.Pz=new kB(this.ia);this.Pz.init()};
a.mC=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.yD(e))&&(d.Aj&&!b.eC?rC(b,b.Eh):rC(b,d.h()))}},a.rC=function(b,c){if(c){var d=yg(document.body).top,e=b.IN?og(b.rk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.tI=Is;Hs(c,d);Qk(c);b.dj&&b.dj.Gp()}};a.tC=function(){kC.call(this);this.data=gh;this.ia=this.data.ia};A(tC,kC);t=tC.prototype;
t.yH=function(){(this.Zq=K("zh-single-answer-disable-wrap"))&&this.m().e(this.Zq,"click",this.XR);this.Ml();this.Xn();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){Qp(this,"favlist")});lC(this,m);if(b=$("#zh-question-answer-collections > .zh-general-list").get(0)){var c=new Mt({fa:["autoload","nodeSource"]});this.H(c);c.o(b)}if(b=$(".awesome-answer-list").get(0)){var d=new Mt({fa:["expandLimit"],kh:m});this.H(d);this.m().e(d,"itemcreated",function(b){var c=
new yw;c.o(b.item);d.H(c)});d.o(b)}};t.Yn=function(){this.m().e(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.vc.fill("label","answer_page")});tC.n.Yn.call(this)};t.XR=function(b){b.target&&b.target.name&&(b=this.Jb,b.Ng=m,b.status=0,iC(b))};
t.Ml=function(){var b=L("zm-item-answer",K("zh-question-answer-wrap"));if(b){this.Jb=new jC(this.ia);this.H(this.Jb);this.Jb.o(b);b=this.m();b.e(this.Jb,"change",this.vy);if(this.Jb.Ge){b.e(Ni,"anon_change",function(b){var c=b.jb,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=B.reduce(T,function(b,c,d){b[g[d]]=c;return b},{}),c=cl(this.$J,{author:!c&&h});b.html(c)}});var c=this.Jb.je;c&&b.e(c,"change",function(){var b=
Ma(c.bb()[0]),b=fc(b);mc(b,this.Jb.g);this.Jb.F();this.Ml(b)})}uC(this);gC(this.Jb,{autofocus:m,pF:j})}};t.yD=function(b){if(this.Jb.ga===b)return this.Jb};t.$J='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.Xn=function(){this.Pz=new kB(this.ia,this.Jb);this.Pz.init();var b=K("js-sidebar-author-info");b&&(new oy(b)).init()};t.vy=function(b){b=b.target;if(b instanceof jC)switch(b.zu){case "collap":H.add(b.h(),"zm-item-collapsed");break;case "cancel_collap":H.remove(b.h(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":uC(this),location.reload()}};
a.uC=function(b){b.Jb?b.Jb.Ng?(b.Zq.innerHTML=b.Jb.Ge?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",S(b.Jb.h(),m)):S(b.Jb.h(),j):b.Zq.innerHTML="此答案已经被作者删除"};a.vC=function(){U.call(this);this.page=1};A(vC,U);t=vC.prototype;t.init=function(){var b=L("js-topic-feed-page");this.o(b)};
t.z=function(){function b(b){k.hasClass("disabled")||(n.random(b)||(k.addClass("disabled"),$(".hidden-topics-plaza").show(),Y("topic","show_hidden_enter_topics_square","topic_feed_recommend")),g.html(uw(n,n.td,n.$g)))}vC.n.z.call(this);var c=this;this.JA=$(".js-topic-feed-container",this.g);this.JA.find(".js-topic-item").each(function(){var b=new wC;c.H(b);b.o(this);c.m().e(b,"unfollow",function(){xC(c)})});this.Zs=new yC;this.Zs.o($(".js-pinned-topics",this.element)[0]);(this.Yb=K("js-load-more"))&&
this.m().e(this.Yb,"click",this.Ey);this.m().e(this.Zs,"change",function(b){$("#tf-"+b.WH).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>设为常去话题</a>')});this.nu=$(".follow-topics-count");var d=this,e=$(this.h()),g=$(".js-list",e),h=$(".js-hidden-list",e),k=$(".js-pager",e),h=$.makeArray($("<div>").html(h.html()).children().add(g.children())),n=new tw(h,3);k.on("click",function(){b(g.find(".zg-btn-follow").length)});
g.on("click","[data-follow]",function(c){var e=$(c.target),h=e.data("id"),x=$(".new-follow-topics span"),F=x.data("ids");if(e.hasClass("zg-btn-follow"))c=$(c.target).closest(".topic-item"),n.remove(c[0]),x.length?(F.push(h),x.data("ids",F),x.text(F.length)):$('<a href="#" class="new-follow-topics">新关注 <span data-ids="['+h+']">1</span> 个话题，点击查看</a>').insertBefore($(".topic-recommend")),1===$(".zg-btn-follow",g).length&&(k.hasClass("disabled")?$(".topic-recommend").fadeOut():setTimeout(function(){b(0)})),
h=parseInt(d.nu.text()),zC(d,h+1);else if(e.hasClass("zg-btn-unfollow")){var I=$(".js-topic-item[data-id="+h+"]");I.length?I.fadeOut(function(){I.remove();xC(d)}):F&&(1<F.length?(F.splice(F.indexOf(h),1),x.data("ids",F),x.text(F.length)):x.parent().remove(),xC(d))}});e.on("click",".new-follow-topics",function(b){b.preventDefault();var c=$(b.target);$.get("/topic/newest-feeds",{ids:JSON.stringify($("span",c).data("ids"))},function(b){b&&!b.r&&(AC(d,b.msg),c.remove())})}).on("click",".js-nomore-recommend",
function(){$.post("/topic/suggest-topics/close",function(b){b&&!b.r&&$(".topic-recommend").fadeOut()})});this.Yn()};a.BC=function(b,c){xc(b,c?"加载中...":"更多")};t.Ey=function(){BC(this.Yb,j);this.xhr=new W(j);oe(this.m(),this.xhr,"complete",y(this.Vg,this));var b=new Xk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.hd())};t.Vg=function(){var b=Je(this.xhr);b&&!b.r&&(0<b.msg.length?(AC(this,b.msg),BC(this.Yb,m)):$(this.Yb).hide())};
a.AC=function(b,c){$.each(c,function(c,e){var g=new wC;b.H(g);g.o($(e)[0]);b.JA.append(g.h());b.m().e(g,"unfollow",function(){xC(b)})})},a.xC=function(b){var c=parseInt(b.nu.text());zC(b,c-1)},a.zC=function(b,c){b.nu.text(c);$(".no-topics").toggle(0===c)};
t.Yn=function(){var b=$(this.h());$.each({".zu-main-sidebar .topics-plaza a":["visit_topic_square","topic_feed_sidebar"],".hidden-topics-plaza a":["visit_topic_square","topic_feed_recommend"],".js-pager.topics-pager":["click_change_recommend_topic","topic_feed_recommend"],".js-nomore-recommend":["click_nomore_recommend_topic","topic_feed_recommend"],".js-list .zg-btn-follow":["click_follow_recommend_topic","topic_feed_recommend"],".js-list .zg-btn-unfollow":["click_unfollow_recommend_topic","topic_feed_recommend"],
'.topic-recommend .topic-feed-item a[href^="/question/"]':["visit_question","topic_feed_recommend"]},function(c,d){b.on("click",c,function(){Y.apply(l,["topic"].concat(d))})})};a.wC=function(){U.call(this)};A(wC,U);wC.prototype.z=function(){wC.n.z.call(this);this.m().e(this.g,"click",y(this.ty,this))};
wC.prototype.ty=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.g).find(".topic-avatar img"),e=d.clone(),g,h=$(this.g).data("id");if("pin-topic"===b)g=this.getParent().Zs,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.g).append($(this.OR({topic:b.msg})).hide().fadeIn()),CC(this)):V(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){$(".zu-main-sidebar .side-title").show();Qk(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消常去话题</a>');
var b=d.offset(),h=$(g.g).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.g).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()});$(".no-pin-topics").hide()}});else if("unpin-topic"===b){var k=this.getParent().Zs,n=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>设为常去话题</a>')[0];Qk(b)},q=$(k.g).find("[data-topicid="+h+"]");q.fadeOut(function(){q.remove();k.Qt().done(function(){n&&n()});k.dispatchEvent({type:"change",WH:q.attr("data-topicid")});0===$(".js-pin-item").length&&$(".no-pin-topics").show()})}else if("unfollow"===
b){var r=this,v=$(r.g);(b=$(".topic-recommend .zg-btn-unfollow[data-id="+c.id.match(/-(.*)/)[1]+"]").get(0))?Qp(b,"topic",l,["zg-btn-follow","zg-btn-unfollow"]):Qp(c,"topic",l,["follow","unfollow"]);v.fadeOut(function(){v.remove();r.dispatchEvent("unfollow")})}};a.yC=function(){U.call(this)};A(yC,U);yC.prototype.OR=cl('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
yC.prototype.z=function(){yC.n.z.call(this);this.m().e(this.g,"click",y(this.ty,this));CC(this)};a.CC=function(b){b.Jf&&b.Jf.F();var c=new Cs;c.dr="pin-topic-moving";Ds(c,b.g,0);c.init();b.m().e(c,"dragend",y(b.Qt,b));b.Jf=c;$("a",b.g).each(function(){b.m().e(this,"mousedown",function(b){b.stopPropagation()})})};
yC.prototype.ty=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.g).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.g);c.Qt()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.Qt();c.dispatchEvent({type:"change",WH:g.attr("data-topicid")});0===$(".js-pin-item").length&&
$(".no-pin-topics").show()})}else b.stopPropagation()};yC.prototype.Qt=function(){var b=[];$(this.g).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ca())};a.DC=function(){U.call(this);this.cD="even";this.qn="current"};A(DC,U);t=DC.prototype;t.init=function(){yr.H(this);this.o(document.body)};
t.z=function(){DC.n.z.call(this);this.mu=$("ul.zm-topic-cat-main").children();var b=this.rd=$("div.zh-general-list"),c=new Mt({fa:["autoload","nodeSource"]});this.H(c);c.o(b.get(0));this.m().e(c,"next",this.dq);this.kF=c;b.on("click","a.follow",function(){Qp(this,"topic",xa(Qk,this),l,{follow_text:"关注"})});P(window,"hashchange",this.fG,m,this);this.fG()||(b.show(),this.dq())};
t.dq=function(){var b=this.rd.show().children();if(!b.length)return this.rd.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.cD);b.filter(":odd").addClass(this.cD);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.wr(),c=b.params&&b.params.topic_id,b=this.mu.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.qn).siblings().removeClass(this.qn)};
t.wr=function(){return this.rd.data("init")};t.fG=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.mu.filter(function(){return $(this).text()===c}),b.length&&this.mu.filter("."+this.qn).text()!==c)){b.addClass(this.qn).siblings().removeClass(this.qn);b={params:{topic_id:b.data("id")}};var d=this.wr();$.extend(j,d,b);this.rd.attr("data-init",JSON.stringify(d));this.rd.empty();this.kF.Oi();this.kF.Cs();b=j;break a}b=i}return b};a.EC=function(){U.call(this)};A(EC,U);
EC.prototype.init=function(){$(".report-table .report-appeal").click(function(b){b.preventDefault();var c=$(this).closest("tr"),d=new Ai;ci(d,j);d.Cg=j;ii(d,ki);d.Ta("请填写你的申诉理由");d.Aa('<textarea class="textarea" name="reason" placeholder="简洁的申诉理由会让管理员更快处理"></textarea>');d.C(j);d.X();d.m().e(d,gi,function(){$.post("/report/appeal",{report_id:c.data("id"),reason:$('[name="reason"]',d.g).val()},function(){Ei({title:"申诉提交",Mj:j,content:"<p>您的申诉正在等待人工处理，我们会在 24 小时内处理完成。</p><p>处理完成后会私信通知您。</p>",className:"report-success-dialog",
X:j,Re:["知道啦"]})})})});$(".report-table .report-show-deleted").click(function(b){b.preventDefault();$(this).next(".report-deleted").toggleClass("hidden")})};a.FC=function(){U.call(this)};A(FC,U);FC.prototype.init=function(){yr.H(this);this.o(document.body)};FC.prototype.z=function(){FC.n.z.call(this);GC(this,"zh-global-logs-wrap");GC(this,"zh-global-logs-questions-wrap");GC(this,"zh-question-log-list-wrap")};
a.GC=function(b,c){var d=K(c);if(d){var e=new Mt;b.H(e);e.fa("locationSource",{Xs:j});e.o(d);$(d).on("click",'a[name="revert"]',function(){if(ry({fm:j})()===m)return m;ey(this);return m}).on("click",'.zm-item-meta a[name="report"]',function(){(new ju("activity",$(this).data("id"))).submit();return m})}};a.HC=function(){U.call(this)};A(HC,U);HC.prototype.init=function(){yr.H(this);this.o(document.body)};HC.prototype.z=function(){HC.n.z.call(this);this.Wn("zh-question-followers-list-wrap")};HC.prototype.Wn=function(b){if(b=K(b)){var c=new Mt;this.H(c);c.fa("locationSource");c.o(b)}};a.IC=function(b,c){var d;if(b&&c){d=d||"text-highlight";var e=RegExp(c,"i");$(b).find("*").andSelf().contents().each(function(){if(3===this.nodeType){var b=this,h=b.parentNode;if(!H.has(h,d))for(var k,n;-1!==(k=b.data.search(e));)k=0<k?b.splitText(k):b,b=k.splitText(c.length),n=document.createElement("em"),n.className=d,n.appendChild(k.cloneNode()),h.replaceChild(n,k)}})}};a.JC=function(){Dt.call(this,{fa:["autoload","dataPagingSource"]})};A(JC,Mt);JC.prototype.yq=function(){return fc('<button class="feeds-loading"><span>更多</span></button>')};JC.prototype.Lz=function(b){this.Hd&&(xc(this.Hd.firstChild,b?"努力加载中...":"更多"),H.enable(this.Hd,"loading",b))};a.KC=function(){U.call(this);this.Yg="roundtable";this.Wo=th.roundtable};A(KC,U);KC.prototype.Ei=function(){qw.call(this,"answer");this.ew="entry-expaneded";this.Gs="item-footer";this.Lp="votebar"};A(KC.prototype.Ei,qw);t=KC.prototype.Ei.prototype;
t.Xm=function(){KC.prototype.Ei.n.Xm.call(this,{".js-expand":this.Na,".js-thank":this.Ir});this.zx();var b=$(".phone-actions",this.h());if(b.length){var c=new Xt;c.o($(".menu",b)[0]);c=new cu("operation",c);c.ek=j;fu(c);eu(c);c.dc=of;c.o($(".menubutton",b)[0])}var d=new Lt({uv:"content",OH:"script.content"});this.H(d);d.o(this.h());this.m().e(this,["expand","collapse"],function(b){b.target===this&&d.Na("expand"===b.type,j)}).e(d,["expand","collapse"],function(b){this.Na("expand"===b.type)});this.xj()};
t.xj=function(){var b=y(function(){if(!this.th){var b=L("entry-content",this.g),d=this.lb&&this.lb.h();!sb&&(d&&$(d).is(":visible")&&b&&230<$(b).height())&&(b=this.th=new fp(l,b),this.H(b),b.hg="votebar",b.o(d))}},this);this.m().e(this,["expand","collapse"],function(c){(c="expand"===c.type)&&b();this.th&&cp(this.th,c)})};
t.zx=function(){var b,c,d=$("."+this.Lp,this.h())[0];d&&(b=this.lb=new Ew(this.hb,this.entryType),this.H(b),Rc(this,b),b.o(d),(d=$(".js-mobi-vote",this.h())[0])&&(new Hw(b)).o(d));if(d=$(".zm-item-vote-info",this.h())[0])c=new Jw(this.hb,this.entryType),this.H(c),Rc(this,c),c.o(d);b&&c&&this.m().e(b,"change",function(){c.ck()}).e(c,"change",function(){$("[data-bind-votecount]",this.h()).text(c.Oa())})};
t.Ir=rw(function(b){if((b=b.target)&&!H.has(b,"thanked"))$.parseJSON(b.getAttribute("data-thanked"))===j?(Ik(b,"感谢"),b.setAttribute("data-thanked",m),$.post("/answer/cancel_thanks",{aid:this.hb})):(Ik(b,"取消感谢"),b.setAttribute("data-thanked",j),$.post("/answer/thanks",{aid:this.hb}))},{oa:"question_answer_thank"});t.sc=function(){KC.prototype.Ei.n.sc.call(this,"分享回答","answer",this.Nh,{aid:this.hb})};t.kj=rw(function(){var b=Nw.N();Sw(b,this.hb);b.show()},{oa:"question_answer_collect",ed:j});
t.ie=function(){KC.prototype.Ei.n.ie.call(this);Gk(this.fg.register("v",function(){this.lb&&this.lb.Zt()},this),{group:"操作",name:"赞同"});Gk(this.fg.register("d",function(){this.lb&&this.lb.Yt()},this),{group:"操作",name:"反对"});Gk(Gk(Gk(Gk(Gk(this.fg.register("o",this.yf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.zp,this),{group:"操作",name:"打开评论"}).register("f x",this.sc,this),{group:"操作",name:"分享"}).register("s c",this.kj,this),{group:"操作",name:"收藏"}).register("shift+c",this.Xw,this),{group:"操作",
name:"定位到评论框"})};KC.prototype.cB=function(){qw.call(this,"question");this.Gs="item-footer"};A(KC.prototype.cB,qw);KC.prototype.init=function(){yr.H(this);this.o(document.body);this.Zn();this.cs();LC();var b=$(".rt-comment-box")[0];if(b){var c=new bw(this.Wo.id,"roundtable");this.H(c);c.o(b)}};KC.prototype.Zn=function(){this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.vc.fill("label","roundtable").fill("category",this.Yg)})};
KC.prototype.cs=function(){function b(b){b=b.getAttribute("data-type");return(b={answer:KC.prototype.Ei,question:KC.prototype.cB}[b])?new b:new U}var c=this;$("[data-paging]").each(function(){var d=new JC;d.fa("childConstructor",{factory:b});this.getAttribute("data-navigable")!==l&&d.fa("shortcut",{items:">.item"});c.H(d);d.o(this)})};
a.LC=function(){var b=$(".roundtable-profile");$(".share",b).click(Km(function(){var b=$(this).data();Du(["分享活动","roundtable",b.token,{roundtable_id:b.id}],"tb-webshare-sina");X.ha({type:"ga_click_share_roundtable_box",target:this,data:{type:"sina"}})}));$(".follow",b).click(Km(function(){var c=this;Qp(c,"roundtable",function(d){$(".label",c).text(d?"取消关注":"关注");var e=$(".followers .count",b),d=Number(e.data("count"))+(d?1:-1);e.length&&(d=Math.max(d,0),e.text(d).data("count",d))},["button-success",
"button-cancel"])}))};a.MC=function(){U.call(this);this.sz=th.searchKeyword};A(MC,U);
MC.prototype.init=function(){function b(b,d){var g=$(b);$.each(d(),function(b,d){g.on("click",b,function(b){e.apply(l,c(d,b))})})}function c(b,c){return g(b,function(b){return pa(b)?b(c):b})}yr.H(this);this.o(document.body);this.cs();var d=encodeURIComponent(this.sz);$("ul.list[data-paging]").on("click",".item a[href!=#]",function(b){b=b.currentTarget;b.host&&(b=$(b).closest(".item").index()+1,Of.set("s-q",d),Of.set("s-i",b),Of.set("sid",jl()))});var e=xa(Y,"search"),g=B.map;b(".related-topics",function(){return{"a.avatar-link":["visit_topic",
"search_result_card_topic_avatar"],"a.name-link":["visit_topic","search_result_card_topic"],"a[href$=questions]":["visit_topic_questions","search_result_card_topic"],"a[href$=top-answers]":["visit_topic_topanswers","search_result_card_topic"],"a[href$=followers]":["visit_topic_followers","search_result_card_topic"],"button.zg-btn-follow":["click_follow_topic","search_result_card_topic"],"button.zg-btn-unfollow":["click_unfollow_topic","search_result_card_topic"],'a[href^="/search?"]':["click_search_result_more",
"search_result_card_topic"]}});b(".related-users",function(){return{"a.avatar-link":["visit_people_profile","search_result_card_people_avatar"],"a.name-link":["visit_people_profile","search_result_card_people"],"a[href$=answers]":["visit_people_answers","search_result_card_people"],"a[href$=followers]":["visit_people_followers","search_result_card_people"],"a[href$=posts]":["visit_people_posts","search_result_card_people"],"button.zg-btn-follow":["click_follow_people","search_result_card_people"],
"button.zg-btn-unfollow":["click_unfollow_people","search_result_card_people"],'a[href^="/search?"]':["click_search_result_more","search_result_card_people"]}});b(document.body,function(){var b=xa(Ha,"search_result_%s_more_button");return{"ul.list.questions + .zu-button-more":["click_search_result_more",b("all")],"ul.list.users + .zu-button-more":["click_search_result_more",b("user")],"ul.list.topics + .zu-button-more":["click_search_result_more",b("topic")]}});b(".search-tabs",function(){var b=xa(Ha,
"search_result_tab_%s");return{'a[href^="/search?type=question"]':["click_search_result_tab",b("all")],'a[href^="/search?type=people"]':["click_search_result_tab",b("user")],'a[href^="/search?type=topic"]':["click_search_result_tab",b("topic")]}});b(".range-selector",function(){var b=xa(Ha,"search_result_range_%s");return{'a[href*="range=1d"]':["click_search_result_range",b("1d")],'a[href*="range=1w"]':["click_search_result_range",b("1w")],'a[href*="range=3m"]':["click_search_result_range",b("3m")]}});
b("ul.list.questions",function(){function b(){return function(b){return"search_result_all_list_"+($(b.target).closest(".item").index()+1)+""}}return{"a.question-link":["visit_question",b()],".js-expand, .summary":["click_expand",b()],'a[name="collapse"]':["click_collapse_answer",b()],"a.zg-follow":["click_follow_question",b()],"a.zg-unfollow":["click_unfollow_question",b()]}});b("ul.list.users",function(){function b(c){return function(b){return"search_result_user_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_people_profile",b("_avatar")],"a.name-link":["visit_people_profile",b()],"a[href$=answers]":["visit_people_answers",b()],"a[href$=followers]":["visit_people_followers",b()],"a[href$=posts]":["visit_people_posts",b()],"button.zg-btn-follow":["click_follow_people",b()],"button.zg-btn-unfollow":["click_unfollow_people",b()]}});b("ul.list.topics",function(){function b(c){return function(b){return"search_result_topic_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_topic",b("_avatar")],"a.name-link":["visit_topic",b()],"a[href$=questions]":["visit_topic_questions",b()],"a[href$=followers]":["visit_topic_followers",b()],"button.zg-btn-follow":["click_follow_topic",b()],"button.zg-btn-unfollow":["click_unfollow_topic",b()]}});this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category","search").fill("label","search_result_answer")});var h=$("#js-search-question-form");h.length&&h.submit(function(b){b.preventDefault();
b=yp.N();b.show();Bp(b,$(".title-input",h).val())});IC("[data-highlight]",this.sz)};
MC.prototype.cs=function(){function b(b){var c=new U;$("li.answer-item",b).each(function(){var b=new KC.prototype.Ei;b.Gs="actions";b.Lp="zm-votebar";c.H(b);b.o(this)});return c}var c=this;$("[data-paging]").each(function(){var d=new Mt({fa:["autoload","dataPagingSource"]});d.fa("childConstructor",{factory:b});var e=$(this).data("navigable");e&&d.fa("shortcut",e);c.H(d);d.o(this);Et(d,function(b){IC($("[data-highlight]",b),c.sz)})})};a.NC=function(b,c){var d=this.D={};J.extend(d,this.defaults,c||{});this.input=b;this.Ub=d.Ub;this.oh=this.cR();this.fv=[];this.fv.push({action:"remove",method:this.removeTag,Av:d.ER,Q:"删除"});setTimeout(y(this.tg,this))};A(NC,Gd);
ya(NC.prototype,{defaults:{source:"/topic/autocomplete",Ub:l,oL:"",jv:m,FT:"/topic/%s",template:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{ot:j,id:c.data("id"),url:b.href,name:c.text()}},xS:of,FL:"canedit",Tv:"empty",bn:"button",ER:"remove-button"},cT:function(b){return Ht(this.D.FT,b.url_token)},has:function(b){return!!B.find(this.oh,function(c){return c.name===b.name||c.id===b.id})},QL:function(b){return B.find(this.oh,function(c){return c.name===
b})},bX:function(b){return B.find(this.oh,function(c){return c.id===b})},Ic:function(){var b=!!oc(this.Ub).length;H.enable(this.Ub,this.D.Tv,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.oh.push(b),b.ot=m,c||this.D.xS.call(this,b)))this.MR(b),b.ot=j,this.dispatchEvent("add"),this.Ic()},remove:function(b){this.oh=B.filter(this.oh,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Ic()},mM:function(){return B.filter(this.oh,function(b){return b.ot!==
m})},lM:function(){return B.map(this.mM(),function(b){return b.id})},MR:function(b){b=fc(this.bH(b));this.Ub.appendChild(b);this.De(b)},bH:function(b){return cl(this.D.template,b)},W:function(){this.Ub.innerHTML=B.map(this.oh,this.bH,this).join("")},cR:function(){return B.map(this.KD(),this.D.parse)},KD:function(){return oc(this.Ub)},tg:function(){var b=this,c=b.D,d=this.input,e={source:c.source,ji:Hc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.cT(d),avatar:d.avatar,url_token:d.url_token});return c.oL},filter:function(d){return B.filter(d,function(d){return c.jv&&!d.id?m:!B.find(b.oh,function(b){return b.ot&&b.id===d.id})})}},g={Zc:function(b,c,d){d.innerHTML=k(b.data)}};J.extend(g,e||{});var h=new um(d,g);P(h,"show",function(){1<h.Ya.length&&!h.Ya[0].id&&xl(h)});var k=cl('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.Y=h;B.forEach(this.KD(),this.De,this);P(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.jv&&(e=Ma(this.value))&&!b.Y.rb())b.add(b.QL(e)||{id:l,name:e,url:"/topic/"+e})});this.Ic()},removeTag:function(b){this.remove($(b).remove().data("id"))},dR:function(b,c){var d=B.find(this.fv,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},De:function(b){var c=this.D;H.add(b,c.FL);B.forEach(this.fv,function(d){var e=new yj(" ",Hj.N());e.yh([c.bn,d.Av].join(" "));
e.W(b);e.Za(j);e.Oc(d.Q);e.addEventListener("action",function(){this.dR(d.action,b)},m,this)},this)}});a.OC=function(){this.LA=this.PA=l};
OC.prototype.init=function(){function b(b,c){var g=M("li"),h=M("span","item-label",b);g.appendChild(h);var k=new yj("",Hj.N());k.yh("zm-profile-tag-btn zm-profile-tag-btn-del");k.Za(j);k.Oc("移除动作");k.Ba(c);k.addEventListener("action",function(){var b=k.S();e(b,m);N(g);aa.lt(j);d()});k.W(g);Nb.appendChild(g)}function c(){ta.C(aa.yl()!==B.filter(aa.wb(),function(b){return!!(b.V&8)}).length)}function d(){B.forEach(R,function(b){b.selected||(b=new jz(b.text,b.value),aa.Ga(b))});c()}function e(b,c){var d=
B.find(R,function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(n.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){q=F.lM();I.val(q.join(","))}var k=$("#rq-settings-ui"),n=$("select.select",k);$(".topics-num",k);$(".actions-num",k);var q=[];this.LA=$("#rq-info-block");k.on("click",".beginedit-button",function(b){b.preventDefault();k.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();k.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();k.get(0).submit()});var r=$(".topic-editor",k),v=$("input.topic-input",r).get(0),x=$("ul.tag-list",r).get(0),F=new NC(v,{jv:j,Ub:x}),I=$('input[name="topics"]',r);F.on("change",h);n.on("change",g);h();g();r=n.get(0);S(r,m);var R=r.options,aa=new Xt;aa.on("action",function(d){d=d.target;b(d.Fg(),d.S());e(d.S(),j);aa.removeItem(d);c()});var ta=new cu("添加动作",aa);ta.yh("menu-button");ta.W(r.parentNode);ta.ek=j;fu(ta);var Nb=M("ul","display-list");d();B.forEach(R,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Nb,ta.h());var Oa=this,r=$("#rq3-item-list"),Ua={gT:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},tR:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Ua.tR(c);c=ye.text()||0;0<c&&ye.text(c-1);var d=Oa.LA,e=Number(Oa.PA.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Ua.gT(c),b.addClass("thanked").text("已感谢"))});fy(r);r=new pu(r.get(0),location.href,j);r.EG=function(b){return b.getAttribute("data-id")};r.ni("rq-item");r.init();var r=$("#rq3-sidenav-link"),ye=$(".zg-num",r);this.PA=ye};a.PC=function(){};PC.prototype.init=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.QC=function(){};A(QC,U);QC.prototype.init=function(){yr.H(this);this.o(document.body)};QC.prototype.z=function(){QC.n.z.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Mt;this.H(c);c.fa("nodeSource");c.o(b.get(0))}};a.RC=function(){U.call(this)};A(RC,U);RC.prototype.z=function(){this.m().e(this.g,"click",this.Fo)};RC.prototype.Fo=function(b){var c=b.target;c&&"rmdraft"===c.name&&Ei("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Hi("/draft/delete",l,"POST","qid="+c.id.split("-")[1]),N(this.g))},this)};a.SC=function(){};A(SC,U);SC.prototype.init=function(){var b=K("zh-draft-page-wrap");b&&this.o(b)};
SC.prototype.z=function(){P(K("zh-clear-all-draft"),"click",function(){Ei("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&Hi("/draft/clear",function(){window.location.href="/draft"},"POST")});return m});this.Wn()};SC.prototype.Wn=function(){var b=K("zh-draft-item-list");if(b){var c=new Mt;c.fa("locationSource",{Xs:j}).fa("childConstructor",{Qi:RC});c.o(b)}};a.TC=void 0,a.UC=function(b,c){b.style.WebkitTransition=c;b.style.MozTransition=c;b.style.mV=c;b.style.$I=c;b.style.uT=c};a.VC=function(b,c,d,e,g){Oj.call(this);this.g=b;this.CL=c;this.fO=d;this.kD=e;this.vT=la(g)?g:[g]};A(VC,Oj);t=VC.prototype;
t.play=function(){if(1==this.V)return m;this.Ug();this.Rc("play");this.startTime=Aa();this.V=1;if(!ka(TC))if(C)TC=G("10.0");else{var b=document.createElement("div");b.innerHTML='<div style="-webkit-transition:opacity 1s linear;-moz-transition:opacity 1s linear;-o-transition:opacity 1s linear;transition:opacity 1s linear">';b=b.firstChild;TC=ka(b.style.uT)||ka(b.style.WebkitTransition)||ka(b.style.MozTransition)||ka(b.style.$I)}if(TC)return Uf(this.g,this.fO),this.SH=Kd(this.fR,i,this),j;this.$z(m);
return m};t.fR=function(){var b=this.g,c=this.vT;la(c)||(c=[c]);c=B.map(c,function(b){return na(b)?b:b.qR+" "+b.duration+"s "+b.timing+" "+b.delay+"s"});UC(b,c.join(","));Uf(this.g,this.kD);this.SH=Kd(y(this.$z,this,m),1E3*this.CL)};t.stop=function(){1==this.V&&this.$z(j)};t.$z=function(b){UC(this.g,"");Ld(this.SH);Uf(this.g,this.kD);this.ml=Aa();this.V=Nj;b?this.Rc("stop"):this.Rc("finish");this.Wg()};t.w=function(){this.stop();VC.n.w.call(this)};a.WC=function(b,c,d,e){return new VC(b,0.15,{opacity:d},{opacity:e},{qR:"opacity",duration:0.15,timing:c,delay:0})};a.XC=function(){this.Yg="explore";this.PL="explore_feed"};A(XC,U);XC.prototype.init=function(){yr.H(this);this.o(document.body)};
XC.prototype.z=function(){XC.n.z.call(this);var b=this,c=$("#js-explore-tab");if(c.length){var d=$(".tab-panel",c),e=$(".tab-nav",c),g=l;e.children().click(function(){g=$b(document)});c=function(){var c={"daily-hot":0,"monthly-hot":1}[window.location.hash.slice(1)]||0;e.removeClass("active").eq(c).addClass("active");c=d.hide().eq(c).show().children("[data-type]");if(!c.data("inited")){c.data("inited",j);var h={daily:yy,monthly:Ay}[c.data("type")],h=new YC(h);h.fa("expandLimit");b.H(h);h.o(c[0])}g&&
window.scrollTo(g.x,g.y)};this.m().e(window,"hashchange",c);c()}this.yx();if(c=$("#zh-recommend-list-full>.zh-general-list")[0]){var h=new Mt;h.fa("nodeSource");Et(h,function(b){var c=Lw(b);c&&(h.H(c),c.o(b))});this.H(h);h.o(c)}var c=$("ul.hot-roundtables"),k=$(".hot-roundtables-feature-popup");if(c.children().length&&k.length&&!(300>c.offset().left)){var n=c.children().first(),q=new xq(k[0]);q.rm(m);q.Et(WC(k[0],"ease-out",0,1),WC(k[0],"ease-in",1,0));k.on("click",".dismiss",function(){$.post("/notifeature",
{feature:"explore_roundtable"});q.C(m)});setTimeout(function(){q.C(m);yq(q,2);Wr(q,new Pf(-25,10,0,0));q.Nc(new Ps(n[0],0));q.C(j)},200)}this.m().e(this,"click!",function(b){"comment"===b.namespace&&b.vc.fill("category",this.Yg).fill("label",this.PL)})};XC.prototype.yx=function(){var b=1,c=$("ul.hot-favlists"),d=l;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=zy(b).done(function(b){c.html(b)}))})};
a.YC=function(b){Dt.call(this,{source:function(){return b($(this.wb()).last().data("offset")).then(function(b){return{results:b}})},fa:["autoload"]})};A(YC,Mt);YC.prototype.z=function(){YC.n.z.call(this);this.fa("childConstructor",{Qi:yw})};a.ZC=function(){U.call(this)};A(ZC,U);ZC.prototype.init=function(){yr.H(this);this.o(document.body)};ZC.prototype.z=function(){ZC.n.z.call(this);this.Wn()};ZC.prototype.Wn=function(){var b=K("js-suggest-people");if(b){var c=0,d=new Mt({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.H(d);d.o(b)}};a.$C=function(b){function c(b,c){var d;d=d||"slug";return{source:b,filter:function(b){return b.filter(function(b){return c.every(function(c){return c[d]!==b[d]})})},select:function(b){c.push(b);return""}}}this.vt=b;b.activityUrl="";var b=this.vt,d=b.roundtable;b.topicsSuggestOpitons=c("/r/ac/topics",d.topics);b.organizationsSuggestOpitons=c("/r/ac/topics",d.organizations);b.presentersSuggestOpitons=c("/r/ac/users",d.presenters);b.guestsSuggestOpitons=c("/r/ac/users",d.guests)};$C.$inject=["$scope"];
$C.prototype.removeTag=function(b,c){b.splice((0,B.indexOf)(b,c),1)};$C.prototype.moveupTag=function(b,c){var d=(0,B.indexOf)(b,c);0<d&&(b.splice(d,1),b.splice(d-1,0,c))};$C.prototype.onActvityUrlChange=function(){var b=this.vt,c=b.activityUrl,d=b.roundtable.activityUrls;c&&-1===(0,B.indexOf)(d,c)&&(d.push(c),b.activityUrl="")};
$C.prototype.submit=function(b,c){var d="create"===c,e={roundtable:JSON.stringify(b)};if(d&&3>b.activityUrls.length)return V("请至少添加三条动态");$.post(location.pathname+location.search,e).then(function(d){d.success?"create"===c?(V(d.message||"活动创建成功，请等待审核"),setTimeout(function(){location.href="/roundtable"},3E3)):(V(d.message||"活动修改成功"),setTimeout(function(){location.href="/roundtable/"+b.slug},3E3)):V(d.message||"提交失败")})};a.aD=function(b,c){var d={Vd:5,className:"ui-suggest",fh:"row",gD:200};J.extend(d,c||{});var e=d.W;e&&(d.Zc=w,d.W=function(b,c){e.apply(this,arguments)!==m&&(b.dg=Vb(b.fh,c))});um.call(this,b,d);var g=this.K;g.className=d.className;g.fh=d.fh;g.wo=d.gD};A(aD,um);a.bD=function(b,c){return function(d,e,g){$(e).datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"});c(function(){$(e).datetimepicker("update",new Date(b(g.ngModel)(d)))})}};bD.$inject=["$parse","$timeout"];
a.cD=function(){return{scope:{id:"@id",avatar:"=avatar"},link:function(b,c){var d=new Fx(4,b.id,"xl");d.o(c);d.addEventListener("success",function(){b.$apply(function(){b.avatar.id=d.getData().id})})}}},a.dD=function(b){return{scope:{options:"=suggestOptions"},link:function(c,d,e){var g,h,e={$R:'<div class="row"><img class="avatar" src="[[avatar | avatarUrl]]"><span class="name">[[name]]</span></div>',gD:100,source:e.source,ji:d.parent()[0],W:function(b,c,d){c.innerHTML=d.map(function(b){return h(b.data)}).join("")}};
h=b(e.$R);angular.extend(e,c.options);if(e.select){var k=e.select;e.select=function(b){return c.$apply(function(){return k(b)})}}g=new aD(d[0],e);return c.$on("destroy",function(){return g.F()})}}};dD.$inject=["$interpolate"];a.eD=function(){return function(b,c){return"string"===typeof b?b:b.template.replace("{id}",b.id).replace("{size}",c||"xs")}},a.fD=function(b){b.startSymbol("[[").endSymbol("]]")};fD.$inject=["$interpolateProvider"];a.gD=function(){KC.call(this);this.Wo=th.roundtable};A(gD,KC);
gD.prototype.init=function(){yr.H(this);this.o(document.body);var b=$(".add-pending-activities-form");if(b.length){var c=$(".url",b),d=$(".time",b);d.datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"}).datetimepicker("update",new Date);var e=this.Wo;b.submit(function(b){function g(b){b.success?(V("添加成功"),setTimeout(function(){location.reload()},3E3)):V(b.message||"提交失败")}b.preventDefault();if(!c.val())return V("回答或问题地址必须填写");if(!d.val())return V("发布时间必须填写");
var b=(b=c.val().match(/\/question\/\d+\/answer\/(\d+)/))&&b[1],h=c.val().match(/\/question\/(\d+)/),h=h&&h[1];b?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"answer",url_token:b},g):h?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"question",url_token:h},g):V("回答或问题地址不正确")})}var g=this.Wo;$(".feeds.pending-questions").on("click",".add",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+
g.slug,{action:"approve_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):V(b.message||"提交失败")})}).on("click",".remove",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+g.slug,{action:"ignore_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):V(b.message||"提交失败")})});var h=this.Wo;$(".feeds.pending-activities").on("click",".remove",function(){var b=$(this).data(),c=$(this).closest(".item");
$.post("/roundtable/"+h.slug,{action:"remove_pending_activity",type:b.type,url_token:b.token}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):V(b.message||"提交失败")})});LC();this.cs()};a.hD=function(){U.call(this)};A(hD,U);hD.prototype.init=function(){var b=location.hash.slice(1);b&&(Qk($("."+b).get(0)),$(".zh-friendliness-sidenav").find('[data-section="'+b+'"]').addClass("active"));$(".zh-friendliness-sidenav a").click(function(c){b=$(c.target).data("section");Qk($("."+b).get(0));$(".zh-friendliness-sidenav a").removeClass("active");$(c.target).addClass("active")})};a.iD=function(){U.call(this)};A(iD,U);iD.prototype.init=function(){this.G=$(".friendly-quiz-container");this.NS=parseFloat(this.G.data("star"));$(".start-btn",this.G).click($.proxy(this.OS,this))};iD.prototype.OS=function(){this.su=$(".item",this.G);if(this.az=this.su.length)this.Sq=-1,this.bC=[],this.Sp=$("h1",this.G),this.G.removeClass("welcome").addClass("answering"),jD(this),$(".choose-btn",this.G).click($.proxy(this.CK,this))};
iD.prototype.CK=function(b){var b=$(b.target).data("isfriendly"),c=this.Im.data("id");this.bC.push({id:c,isFriendly:b});this.Sq<this.az-1?jD(this):$.post("/community/friendly/quiz",{params:JSON.stringify(this.bC)},$.proxy(function(b){if(!b.r)if(b=b.msg,b.isSuccessed){this.G.removeClass("answering").addClass("successed");this.Im.hide();this.Sp.html("全部判断正确");$(".describe",this.G).html("你的友善度已经提升，每天只能判断一次");var c=$(".blue-stars",this.G).css("width","0"),g=this.NS+0.5;setTimeout(function(){c.animate({width:20*
g+"%"},1E3)},200)}else{var h=b.ids;this.G.removeClass("answering").addClass("failed");this.Im.hide();this.Sp.html("以下内容判断错误，本次判断未能提升友善度");this.su.each(function(){var b=$(this),c=b.data("id");B.contains(h,c)&&b.show()})}},this))};a.jD=function(b){b.Im&&b.Im.hide();b.Sq++;b.Im=$(b.su[b.Sq]).show();b.Sp.html(b.Sq+1+"/"+b.az)};Da("ZH.entryCommunity",function(){(new EC).init()});Da("ZH.entryQuestionLog",function(){(new FC).init()});Da("ZH.entryQuestionFollowersPage",function(){(new HC).init()});Da("ZH.entrySQ",function(){(new kC).init()});Da("ZH.entrySA",function(){(new tC).init()});Da("ZH.entryL",function(){(new Cy).init()});Da("ZH.entryT",function(){(new ty).init()});Da("ZH.entryTS",function(){(new DC).init()});Da("ZH.entryP",function(){(new gy).init()});Da("ZH.entrySearch",function(){(new MC).init()});
Da("ZH.entryPM",function(){(new nu).init()});Da("ZH.entryPMDetail",function(){(new ou).init()});Da("ZH.entrySettings",function(){(new my).init()});Da("ZH.entryTopicFeed",function(){(new vC).init()});Da("ZH.entryRQ3",function(){(new OC).init()});Da("ZH.entryTerms",function(){(new PC).init()});Da("ZH.entryHome",function(){(new gz).init()});Da("ZH.entryQuestionFollowing",function(){(new QC).init()});Da("ZH.entryDraft",function(){(new SC).init()});Da("ZH.entryExplore",function(){(new XC).init()});
Da("ZH.entryLookup",function(){(new ZC).init()});Da("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(Km(function(){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}))})});Da("ZH.entryRb",function(){(new KC).init()});
Da("ZH.entryRbEdit",function(){var b=angular.module("roundtableApp",[]);b.controller("RoundtableFormCtrl",$C);b.directive("uiAvatarEditor",cD);b.directive("uiSuggest",dD);b.directive("uiTimepicker",bD);b.filter("avatarUrl",eD);b.config(fD);angular.bootstrap(document.body,["roundtableApp"])});Da("ZH.entryRbPending",function(){(new gD).init()});Da("ZH.entryFriendlinessPage",function(){(new hD).init()});Da("ZH.entryFriendlyQuiz",function(){(new iD).init()});Jf("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js